<!DOCTYPE html>



  


<html class="theme-next pisces use-motion" lang="en">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="Louis">
<meta property="og:url" content="http:&#x2F;&#x2F;yoursite.com&#x2F;page&#x2F;2&#x2F;index.html">
<meta property="og:site_name" content="Louis">
<meta property="og:locale" content="en">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Pisces',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: 'Author'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/2/"/>





  <title>Louis</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="en">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Louis</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            Home
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            Archives
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/03/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2020/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/03/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2020/" itemprop="url">Day20: 簡易Rails實作(上)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-03T12:10:40+08:00">
                2019-10-03
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在開始之前，要先知道用Rails的慣例，並且盡量遵守才不會造成後面要接手的人的困擾。尤其是以下說明需特別注意：</p>
<blockquote>
<p>在檔案區命名：snakecase     ex: candidate_controller<br>在檔案內命名：camelcase     ex: CandidateController<br>且“檔案名稱”與“類別名稱”必須相同，才不會在執行的時候出現error</p>
</blockquote>
<h2 id="什麼是MVC-Model、View、Controller"><a href="#什麼是MVC-Model、View、Controller" class="headerlink" title="什麼是MVC(Model、View、Controller)?"></a>什麼是MVC(Model、View、Controller)?</h2><p>在開始建立Rails之前，我們需要先了解<a href="https://railsbook.tw/chapters/10-mvc.html" target="_blank" rel="noopener">什麼是MVC</a></p>
<p>MVC架構：由Route開始，到Controller結束。</p>
<ol>
<li>瀏覽器依據資源(resources)的設定，經由Route去找到Controller中，對應的action(method)。</li>
<li>視需要透過Model向資料庫取得資料後，處理完再與對應的View(.html.erb)做結合。</li>
<li>View處理完後再回傳給Controller，Controller再將結果轉交給瀏覽器。</li>
</ol>
<h2 id="建立Rails專案"><a href="#建立Rails專案" class="headerlink" title="建立Rails專案"></a>建立Rails專案</h2><p>在Terminal輸入，就會自動產生rails專案。（前提是要先安裝好Rails）</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails new 專案名稱</span><br></pre></td></tr></table></figure>
<p>在這次的例子，我們試著產生一個名叫myvote的Rails檔案。</p>
<h3 id="routes-rb"><a href="#routes-rb" class="headerlink" title="routes.rb"></a>routes.rb</h3><p>在Vscode開啟資料夾，用command+P尋找檔案“routes.rb”，並寫入：</p>
<ol>
<li>Rails 提供的 resources</li>
<li>根目錄(首頁) candidates，且裡面有個方法index</li>
</ol>
<p><img src="https://i.imgur.com/Pmy0rCh.png" alt=""></p>
<p>第2行：產生8種條路徑</p>
<p><img src="https://i.imgur.com/xuSCyik.png" alt=""></p>
<p>第3行：根目錄裡有個方法index</p>
<p>備註：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">root <span class="string">'candidates#index'</span></span><br><span class="line">get <span class="string">'/'</span>, to <span class="string">'candidates#index'</span></span><br><span class="line"><span class="comment">#因為是根目錄，以上兩種寫法都可以接受。</span></span><br></pre></td></tr></table></figure>

<p>在此時在Terminal執行Rails：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails server 或 rails s</span><br></pre></td></tr></table></figure>

<p>至網址輸入localhost:3000(Terminal會寫3000)出現以下畫面:</p>
<p><img src="https://i.imgur.com/qqJ4rG8.png" alt=""></p>
<p>找不到method，故要建立一個給它。</p>
<h2 id="建立Method"><a href="#建立Method" class="headerlink" title="建立Method"></a>建立Method</h2><p>在app &gt; controllers中新增檔案 “檔名_controller.rb” (此例檔名為candidates，需與你要連結的檔案名稱一樣)，並建立class 、繼承最原始的檔案“ApplicationController”：（其實此例的def index暫時不寫也沒關係）</p>
<p><img src="https://i.imgur.com/W6ty2NU.png" alt=""></p>
<p>但這樣還不夠，因為Rails的遊戲規則是要從views裡面找檔案，所以必須還要再 views 資料夾新增一個candidates資料夾，並建立 index.html.erb：</p>
<p><img src="https://i.imgur.com/vev7ekj.png" alt=""></p>
<p>才能印出：</p>
<p><img src="https://i.imgur.com/0rQWk3A.png" alt=""></p>
<p>基本上這樣就完成最最最基礎的第一步了(此例index裡沒寫東西只是因為要當範例而已，請原諒我沒放東西(跪)）</p>
<h2 id="讓他稍微可以動"><a href="#讓他稍微可以動" class="headerlink" title="讓他稍微可以動"></a>讓他稍微可以動</h2><p>在index.html.erb加點東西：</p>
<p><img src="https://i.imgur.com/4wcbTUc.png" alt=""></p>
<blockquote>
<p>Prefix :new_cadidates</p>
</blockquote>
<p>還記得剛剛的rails routes嗎？其中的new功能Rails已經有幫我們定義好的Prefix名字了</p>
<p><img src="https://i.imgur.com/0tz8JhD.png" alt=""></p>
<p>_path:產生相對應的路徑網址（站內路徑）-&gt; ／candidates</p>
<p>*另一種方式：</p>
<p>＿url:產生完整網址 -&gt; <a href="https://www.xxxx.com/candidates，在寄發mail的時候較常使用" target="_blank" rel="noopener">https://www.xxxx.com/candidates，在寄發mail的時候較常使用</a>)</p>
<p>套用Bootstrap，套用方式可見<a href="https://medium.com/@louiswu0327/%E5%9C%A8rails%E8%A3%9Dboostrap%E5%A5%97%E4%BB%B6-fcb742a10376" target="_blank" rel="noopener">這篇</a>。</p>
<h2 id="等等！！！views裡沒有new這個檔案啊！！？"><a href="#等等！！！views裡沒有new這個檔案啊！！？" class="headerlink" title="等等！！！views裡沒有new這個檔案啊！！？"></a>等等！！！views裡沒有new這個檔案啊！！？</h2><p>所以要記得在views &gt; candidates 裡再新增一個new.html.erb檔</p>
<p><img src="https://i.imgur.com/tFtIi8s.png" alt=""></p>
<p>這樣一來就可以有作用囉!!</p>
<p><img src="https://i.imgur.com/qhJJPAH.png" alt=""></p>
<p><img src="https://i.imgur.com/jmE6M2W.png" alt=""></p>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p>Rails這只是第一步而已，雖然現在有很多指令可以快速產出以上步驟做出的東西(scaffold)，但畢竟在使用套件之前，能夠先了解如何手刻及其背後觀念跟原理是非常重要的。</p>
<p>也許文章內容寫的不正確也缺乏系統，也或許幾年後回來看自己寫的這篇文章會覺得”WTF這什麼鬼!!?”</p>
<p>參考資料：<br><a href="https://railsbook.tw/chapters/11-routes.html#restful-routes" target="_blank" rel="noopener">為你自己學 Ruby on Rails</a></p>
<blockquote>
<p>“The pro is the person who has all the hassles, obstacles, and disappointing frustrations that everyone else has, yet continues to persist, does the job, and makes it look easy.”</p>
<p>— David Cooper, Sales Trainer</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/02/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2019/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/02/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2019/" itemprop="url">Day19: Rails中神奇的spring stop</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-02T12:10:40+08:00">
                2019-10-02
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h1 id="Day19-Rails中神奇的spring-stop"><a href="#Day19-Rails中神奇的spring-stop" class="headerlink" title="Day19: Rails中神奇的spring stop"></a>Day19: Rails中神奇的spring stop</h1><h4 id="您有遇過rails-g-migration時卡住嗎？"><a href="#您有遇過rails-g-migration時卡住嗎？" class="headerlink" title="您有遇過rails g migration時卡住嗎？"></a>您有遇過rails g migration時卡住嗎？</h4><h4 id="您有rails-sever打不開的問題嗎？"><a href="#您有rails-sever打不開的問題嗎？" class="headerlink" title="您有rails sever打不開的問題嗎？"></a>您有rails sever打不開的問題嗎？</h4><p><del>trivago</del></p>
<p>意外的查到的資料不多，所以這篇僅擷取Rails <a href="https://github.com/rails/spring/blob/master/README.md" target="_blank" rel="noopener">REARDME.md</a>來簡單翻譯一下。</p>
<h2 id="spring-stop"><a href="#spring-stop" class="headerlink" title="spring stop"></a>spring stop</h2><p>常常在跑rail時，都會遇到一些很奇怪的狀況導致migration, rails sever, rails db:seed等跑不出來這狀況，但只要下了<code>spring stop</code>通常就解了？</p>
<p>Rails在4.1版本後新增了<code>srping stop</code>功能，來看看rails guide寫什麼：</p>
<blockquote>
<p>Spring 會預加載你的 Rails 應用程式。保持應用程式在背景執行，如此一來在執行 Rails 命令時：如跑測試、rake、migrate 時，不用每次都重啟 Rails 應用程式，加速你的開發流程。</p>
</blockquote>
<p>簡單來說就是應用程式預加載器，就像加速器一樣的概念。</p>
<h2 id="spring-stop的特性"><a href="#spring-stop的特性" class="headerlink" title="spring stop的特性"></a>spring stop的特性</h2><ol>
<li>在背景自動執行，只開啟終端機並進入rails資料夾就會自動執行</li>
<li>每次執行時重新載入你的rails專案中的code</li>
<li>當config、initializer、gem dependencies有更新時重新啟動</li>
</ol>
<h2 id="spring-stop的運行"><a href="#spring-stop的運行" class="headerlink" title="spring stop的運行"></a>spring stop的運行</h2><p>建立一個新的Rails專案並執行<code>rails generate scaffold post name:string</code></p>
<p>打開終端機測試一下</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ time bin/rake <span class="built_in">test</span> <span class="built_in">test</span>/controllers/posts_controller_test.rb</span><br><span class="line">Running via Spring preloader <span class="keyword">in</span> process 2734</span><br><span class="line">Run options:</span><br><span class="line"></span><br><span class="line"><span class="comment"># Running tests:</span></span><br><span class="line"></span><br><span class="line">.......</span><br><span class="line"></span><br><span class="line">Finished tests <span class="keyword">in</span> 0.127245s, 55.0121 tests/s, 78.5887 assertions/s.</span><br><span class="line"></span><br><span class="line">7 tests, 10 assertions, 0 failures, 0 errors, 0 skips</span><br><span class="line"></span><br><span class="line">real    0m2.165s</span><br><span class="line">user    0m0.281s</span><br><span class="line">sys     0m0.066s</span><br></pre></td></tr></table></figure>

<p>跑的速度不算特別快，因為是第一次執行這個專案，所以花的時間會比較長</p>
<p>來看一下spring的狀態：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">$ bin/spring status</span><br><span class="line">Spring is running:</span><br><span class="line"></span><br><span class="line">26150 spring server | spring-demo-app | started 3 secs ago</span><br><span class="line">26155 spring app    | spring-demo-app | started 3 secs ago | <span class="built_in">test</span> mode</span><br></pre></td></tr></table></figure>

<p>再跑一次就可以發現速度快很多：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">$ time bin/rake <span class="built_in">test</span> <span class="built_in">test</span>/controllers/posts_controller_test.rb</span><br><span class="line">Running via Spring preloader <span class="keyword">in</span> process 8352</span><br><span class="line">Run options:</span><br><span class="line"></span><br><span class="line"><span class="comment"># Running tests:</span></span><br><span class="line"></span><br><span class="line">.......</span><br><span class="line"></span><br><span class="line">Finished tests <span class="keyword">in</span> 0.176896s, 39.5714 tests/s, 56.5305 assertions/s.</span><br><span class="line"></span><br><span class="line">7 tests, 10 assertions, 0 failures, 0 errors, 0 skips</span><br><span class="line"></span><br><span class="line">real    0m0.610s</span><br><span class="line">user    0m0.276s</span><br><span class="line">sys     0m0.059s</span><br></pre></td></tr></table></figure>

<p>在coding時做的變更，會根據你在更新哪個檔案去判別是否要重新啟動後台。</p>
<p>舉例來說當我們修改application file或是test file時，相關的變更會再下一次執行時變更，你只需要重新刷瀏覽器，但後台系統不必重新啟動。</p>
<p>但當如果我們修改啟動應用程式所需的檔案，例如：configs, initializers, gemfile時，則後台需要重新啟動應用程式，而且會自動執行。</p>
<p>例如編輯<code>config/application.rb</code>：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">$ touch config/application.rb</span><br><span class="line">$ bin/spring status</span><br><span class="line">Spring is running:</span><br><span class="line"></span><br><span class="line">26150 spring server | spring-demo-app | started 36 secs ago</span><br><span class="line">26556 spring app    | spring-demo-app | started 1 sec ago | <span class="built_in">test</span> mode</span><br></pre></td></tr></table></figure>

<p>spring會偵測到config底下有檔案被更新後，就會自動啟動。</p>
<hr>
<p>也許是spring的關係，所以常常會將我們不需要的東西先預載入到後台，導致我們在執行migration, rails s等會發生問題，所以才會需要下<code>spring stop</code>來終止預先載入的行為。</p>
<p>這只是我的推測…如果有錯的話歡迎指正。</p>
<p>參考資料：</p>
<p><a href="https://github.com/rails/spring/blob/master/README.md" target="_blank" rel="noopener">Rails/spring/REARDME.md</a><br><a href="https://rails.ruby.tw/4_1_release_notes.html#%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E9%A0%90%E5%8A%A0%E8%BC%89%E5%99%A8%EF%BC%9Aspring" target="_blank" rel="noopener">Ruby on Rails 4.1 發佈記</a></p>
<blockquote>
<p>“If you really want something, you have to be prepared to work very hard, take advantage of opportunity, and above all never give up.”</p>
<p>— Jane Goodall, Ethologist</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/10/01/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2018/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/10/01/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2018/" itemprop="url">Day18: 淺談Rails的表單: form_with</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-10-01T12:10:40+08:00">
                2019-10-01
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <blockquote>
<p>form內 <strong>有</strong> model實體時，用<code>form_for</code>，主要用於新增或修改。</p>
<p>form內 <strong>無</strong> model實體時，用<code>form_tag</code>，主要用於登入一筆資料。</p>
<p>Rails 5.1後，將兩者結合為<code>form_with</code></p>
</blockquote>
<p>上次提到了<code>form_tag</code>及<code>form_for</code>，在Rails 5.1之後結合為<code>form_with</code>，代表<code>form_with</code>結合了兩種form的特性，不論有無Model都可以使用。</p>
<h2 id="使用form-with製作表格"><a href="#使用form-with製作表格" class="headerlink" title="使用form_with製作表格"></a>使用form_with製作表格</h2><h3 id="製作對象有Model時："><a href="#製作對象有Model時：" class="headerlink" title="製作對象有Model時："></a>製作對象有Model時：</h3><p><img src="https://i.imgur.com/HtUBFGQ.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">model:</span> @<span class="attr">product</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p>產出的html:</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">data-remote</span>=<span class="string">"true"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"zzGYG0KNdBU0pPfzO7QDBAWUkDcPE9czey2zv21TwaXXf5T01neGV4Hp2YwZJRUJ2doDyOrnm9ZH74Ql6Ky9Mg=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"product[title]"</span> <span class="attr">id</span>=<span class="string">"product_title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Create Product"</span> <span class="attr">data-disable-with</span>=<span class="string">"Create Product"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="製作對象沒有Model時："><a href="#製作對象沒有Model時：" class="headerlink" title="製作對象沒有Model時："></a>製作對象沒有Model時：</h3><p><img src="https://i.imgur.com/hxLiPHw.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">url:</span> <span class="attr">new_product_path</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p>產出的html</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products/new"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">data-remote</span>=<span class="string">"true"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"ZlLlHMOezGqsuZrFgovtKbph3uYPFcZuZbHyi1V6YEJ+HOnzV2Q+KBn0tLqgGvskZi9NGerhiotZc8UR0IUc1Q=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"title"</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Save "</span> <span class="attr">data-disable-with</span>=<span class="string">"Save "</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>兩種方式產出的東西幾乎是相同的，因此可以得知我們只要根據專案的情況(有無Model)去設計<code>form_with</code>表單就好。</p>
<h2 id="data-remote-”true”"><a href="#data-remote-”true”" class="headerlink" title="data-remote=”true”"></a>data-remote=”true”</h2><figure class="highlight"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products/new"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">data-remote</span>=<span class="string">"true"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> </span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"><span class="attr">....</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>上面兩個例子產出的html中，有一段<code>data-remote=&quot;true&quot;</code>是在<code>form_tag</code>及<code>form_for</code>沒有的。</p>
<p>有了這個屬性之後，表單會透過 Ajax 的方式提交，而不是瀏覽器平常的提交機制，若要設定不讓Ajax的方式提交，則要另訂 local: true。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">model:</span> @<span class="attr">product</span>, <span class="attr">local:</span> <span class="attr">true</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="form-with就算沒有Model的屬性也使用"><a href="#form-with就算沒有Model的屬性也使用" class="headerlink" title="form_with就算沒有Model的屬性也使用"></a>form_with就算沒有Model的屬性也使用</h2><h4 id="form-for"><a href="#form-for" class="headerlink" title="form_for"></a>form_for</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.check_box</span> <span class="attr">:is_avalble</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/v3ceHy3.png" alt=""></p>
<h4 id="form-with"><a href="#form-with" class="headerlink" title="form_with"></a>form_with</h4><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">model:</span> @<span class="attr">product</span>, <span class="attr">local:</span> <span class="attr">true</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.check_box</span> <span class="attr">:is_avalble</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p>產出的html:</p>
<p><img src="https://i.imgur.com/tYimKH2.png" alt=""></p>
<p>可以看得出來，就算Product這個Model裡沒有<code>is_avaliable</code>的屬性，還是可以用<code>form_with</code>寫出統一性的指令，而這個資料可用prodcut[is_avalible]收集。</p>
<h2 id="form-with在設定html時不用花括號"><a href="#form-with在設定html時不用花括號" class="headerlink" title="form_with在設定html時不用花括號{}"></a>form_with在設定html時不用花括號{}</h2><p><code>form_for</code>或<code>for_tag</code>若要設定html屬性，：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span>, <span class="attr">html:</span> &#123; <span class="attr">id:</span> “<span class="attr">product-id</span>”, <span class="attr">class:</span> “<span class="attr">product-type</span> &#125; <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>form_with</code>則不需要再寫花括號：</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span>, <span class="attr">id:</span> “<span class="attr">product-id</span>”, <span class="attr">class:</span> “<span class="attr">product-type</span>  <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p>以上大概就是淺談<code>form_with</code>，其實<code>form_with</code>有很多的細節可以討論，請原諒小弟我僅提出最基本部分來討論…</p>
<p>參考資料：</p>
<p><a href="https://medium.com/@tinchorb/form-with-building-html-forms-in-rails-5-1-f30bd60ef52d" target="_blank" rel="noopener">form_with — Building HTML forms in Rails 5.1</a><br><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-hidden_field" target="_blank" rel="noopener">ActionView::Helpers::FormHelper</a></p>
<blockquote>
<p>“There’s no great loss without some small gain.”</p>
<p>– Laura Ingalls Wilder, Novelist</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/30/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2017/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/30/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2017/" itemprop="url">Day17:  淺談Rails的表單: form_for? form_tag? </a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-30T12:10:40+08:00">
                2019-09-30
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Rails中，常常會用到表單(form)將資料傳入資料庫，其中在Rails 5.1版本之前，常用的就是<code>form_tag</code>與<code>form_for</code>，我們來看看他們的分別該在何時使用：</p>
<p>先說結論：</p>
<blockquote>
<p>form內 <strong>有</strong> model實體時，用<code>form_for</code>，主要用於新增或修改。</p>
<p>form內 <strong>無</strong> model實體時，用<code>form_tag</code>，主要用於登入一筆資料。</p>
<p>Rails 5.1後，將兩者結合為<code>form_with</code></p>
</blockquote>
<p>關於<code>form_with</code>，有機會我再來對它做補充，這次先針對<code>form_for</code>及<code>form_tag</code>。</p>
<h2 id="form-for"><a href="#form-for" class="headerlink" title="form_for"></a>form_for</h2><p>form內<strong>有</strong>model實體時，用<code>form_for</code>，Rails會根據Model的屬性，自動判斷按下submit後，是要新增還是更新Model裡的資料。</p>
<p>翻譯蒟蒻：有媽豆的實體就用form_for</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/b9HI20l.png" alt=""></p>
<p>html會幫你產生</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"new_product"</span> <span class="attr">id</span>=<span class="string">"new_product"</span> <span class="attr">action</span>=<span class="string">"/products"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"**utf8**"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"**authenticity_token**"</span> <span class="attr">value</span>=<span class="string">"kxDHc4ID2xFAfBXANcrXBpqtI/</span></span></span><br><span class="line"><span class="tag"><span class="string">6rerAkMBaCh64j+O6LXsucFvkpU/UxO78XW8ELRuOwAU6O/MEM1LUdK9yEeQ=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"product[title]"</span> <span class="attr">id</span>=<span class="string">"product_title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Create Product"</span> <span class="attr">data-disable-with</span>=<span class="string">"Create Product"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>來簡單看看上面程式碼：<br>第一個 name 屬性為 utf8 的 input，強制瀏覽器正確採用表單指定的編碼。<br>第二個 name 屬性為 authenticity_token 的 input，<br>是 Rails 內建用來防止 CSRF (cross-site request forgery protection) 攻擊的安全機制。</p>
<p>為何要有這樣的保護機制: <a href="https://blog.techbridge.cc/2017/02/25/csrf-introduction/" target="_blank" rel="noopener">CSRF跨站請求偽造 Cross-site request forgery</a></p>
<p>這樣設定好整個表格，就是為了將@product這個ActiveRecord資料而設定的，所以表格送出的params會將我們在表格內填的變數，整個包在product物件下面，才會需要使用Strong Parameter那樣的機制將product變數抽出做permit(避免CSRF攻擊)：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">product_params</span></span></span><br><span class="line">  params.<span class="keyword">require</span>(<span class="symbol">:product</span>).permit(<span class="symbol">:title</span>, <span class="symbol">:password</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="form-tag"><a href="#form-tag" class="headerlink" title="form_tag"></a>form_tag</h2><p>form內<strong>無</strong>model實體時，用<code>form_tag</code>，得指定要傳入哪個連結的<code>action</code>來進行表單資料的傳送。</p>
<p>翻譯蒟蒻：沒有媽豆的時候就只能用form_tag</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_tag</span> <span class="attr">url:new_product_path</span> <span class="attr">do</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">text_field_tag</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">submit_tag</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/T7EvkLF.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products/new?url=%2Fproducts"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> </span></span><br><span class="line"><span class="tag"><span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"lfORCE9tuYA4Yuda6EziGw</span></span></span><br><span class="line"><span class="tag"><span class="string">KMQk9flV9dkM4ogaEzmUCNvZ3n25dLwo0vySXK3fQW3sLRsLphE7isDB8bJMzl1w=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"title"</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Save changes"</span> <span class="attr">data-disable-with</span>=<span class="string">"Save changes"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果是使用form_tag，變數就不會包在任何東西內，可以直接在controller當中取用：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span></span></span><br><span class="line">  @products = Product.where(<span class="symbol">product:</span> params[<span class="symbol">:search</span>])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>參考資料：</p>
<p><a href="https://apidock.com/rails/ActionView/Helpers/FormTagHelper/form_tag" target="_blank" rel="noopener">Ruby API: form_tag</a><br><a href="https://ithelp.ithome.com.tw/articles/10221234" target="_blank" rel="noopener">Ruby API: form_for</a><br><a href="https://m.patrikonrails.com/rails-5-1s-form-with-vs-old-form-helpers-3a5f72a8c78a" target="_blank" rel="noopener">Rails 5.1’s form_with vs. form_tag vs. form_for
</a><br><a href="https://motion-express.com/blog/rails-form-tag-form-for" target="_blank" rel="noopener">form_tag 是啥？跟 form_for 有什麼不一樣？</a></p>
<blockquote>
<p>“A man can get discouraged many times, but he is not a failure until he begins to blame somebody else and stops trying.”</p>
<p>— John Burroughs, Writer</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/29/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2016/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/29/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2016/" itemprop="url">Day16: 淺談Rails裡的resources</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-29T12:10:40+08:00">
                2019-09-29
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <h2 id="resources"><a href="#resources" class="headerlink" title="resources:"></a>resources:</h2><p>可以一次新8條路徑，7個方法，當然也可以一條一條自己新增(get, post)，但若剛好你要做的專案需要這8條路徑的話，用這種內建方式做可以省去不少時間且也會更有系統。</p>
<p>如果resources後面沒加s，在路徑的部分會有些action就不需要帶id，但會少一個路徑。</p>
<h4 id="resource"><a href="#resource" class="headerlink" title="resource"></a>resource</h4><p><img src="https://i.imgur.com/nPCHhiK.png" alt=""></p>
<h4 id="resources-1"><a href="#resources-1" class="headerlink" title="resources"></a>resources</h4><p><img src="https://i.imgur.com/89Y6Om2.png" alt=""></p>
<h2 id="RESTful-的網址設計："><a href="#RESTful-的網址設計：" class="headerlink" title="RESTful 的網址設計："></a>RESTful 的網址設計：</h2><p>導入 REST 的設計，可讓網址變得更直觀，而且也幫開發人員訂了一套網址設計的慣例。</p>
<p>在Terminal裡輸入：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">rails routes</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/Woqdb5V.png" alt=""></p>
<p>青藍色框：Prefix要的名稱<br>黃色框：網址後會產生的path<br>紅色框：路由</p>
<p>或是可以去網址打localhost:3000/這邊可以亂打</p>
<p>也可以看到路徑(我很懶..幾乎都用這個方式在查)</p>
<p><img src="https://i.imgur.com/QGhedW0.png" alt=""></p>
<p>可以一個指令產生這麼多東西！！！真的很方便，但如果剛好你不需要某些路由想要去除的話，可以用以下方式：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">resources :candidates, only: [:new, :show] -&gt; 只要路由new跟show</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">resources :candidates, except: [:new]      -&gt;8個都要除了路由new</span><br></pre></td></tr></table></figure>

<p>根據你要其中的幾個路由去決定要用only還是expect，若要較少的時候用only較適合，反之要多的路由就用expect。</p>
<p>抱歉這次文章品質實在很差…</p>
<p>我是在跟未來的自己抱歉</p>
<p>反正……</p>
<h1 id="又沒人會看-誤"><a href="#又沒人會看-誤" class="headerlink" title="又沒人會看(誤"></a>又沒人會看(誤</h1><blockquote>
<p>“A hero is an ordinary individual who finds the strength to persevere and endure in spite of overwhelming obstacles.”</p>
<p>— Christopher Reeve, Actor</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/28/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2015/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/28/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2015/" itemprop="url">Day15: Rails中的Gemfile</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-28T12:10:40+08:00">
                2019-09-28
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><img src="https://i.imgur.com/P3tMB5y.png" alt=""></p>
<p>在Ruby的宇宙裡，有很多用Ruby寫成的套件包或是框架可以使用，包含rails也是(第6行)。</p>
<p>Gemfile是Rails new一個新專案時附加的檔案(如上圖rails 5.2.3)，主要管理此Rails專案該會使用哪些gem檔案及版本號，在跑<code>bundle install</code>時就會安裝到這個專案，所以可以視為紀錄這個專案該使用哪些gem的檔案，讓專案被其他使用者pull下來時，都能根據Gemfile裡的gem去安裝。</p>
<h2 id="裡面怎麼那麼多東西？"><a href="#裡面怎麼那麼多東西？" class="headerlink" title="裡面怎麼那麼多東西？"></a>裡面怎麼那麼多東西？</h2><p>讓我們來稍微檢視一下，預設的Gemfile到底有哪些東西，分別是做什麼用的？(抱歉可能沒辦法一個一個檢視…)</p>
<p>告訴Rails該去哪裡抓Gem下來用，預設為 rubygems.org</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">source &quot;https://rubygems.org”</span><br></pre></td></tr></table></figure>
<p>還會再多設置一個GitHub的URL當做備用來源 </p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">git_source(:github) &#123; |repo| &quot;https://github.com/#&#123;repo&#125;.git” &#125;</span><br></pre></td></tr></table></figure>



<h3 id="版本號"><a href="#版本號" class="headerlink" title="版本號"></a>版本號</h3><p>在ruby gem常常會看到後面接”數字.數字.數字“，可以解讀為：<br>“#{major}.#{minor}.#{build}”</p>
<blockquote>
<p>主要版號(major)：功能大改，公開的 API 做了不少修正，通常沒辦法向下不相容<br>次要版號(minor)：加了某些新功能，但不影響其它功能，向下相容<br>修訂版號(build)：對現有的功能做了小幅度的修正，可向下相容</p>
<p>by Ruby 語法放大鏡</p>
</blockquote>
<p>像最近rails從5.2.3更新為6.0.0，就是很大改版，就要相對注意相容性的問題。</p>
<h3 id="gem的版本號"><a href="#gem的版本號" class="headerlink" title="gem的版本號"></a>gem的版本號</h3><p>可以看到有些gem的後面有加<code>~&gt;</code> <code>3.2.1</code> <code>&gt;=</code>或沒加等等這幾種：</p>
<ul>
<li><p>gem後沒加：安裝最新的”穩定”版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem &apos;kaminari&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>‘ ‘：指定版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem &quot;rails&quot;, &apos;5.2.3&apos;</span><br></pre></td></tr></table></figure></li>
<li><p>“&gt;=, &lt;：安裝含1.1版本以上 ~ 不包含1.1.4版本。</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">gem &apos;pg&apos;, &apos;&gt;= 1.1&apos;, &apos;&lt; 1.1.4&apos;</span><br></pre></td></tr></table></figure></li>
<li><p>~&gt;：算是縮寫，使用1.9版本以上，但2.0以下(不包括2.0)的最新版本</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">gem &apos;omniauth&apos;, &apos;~&gt; 1.9&apos;</span><br><span class="line"></span><br><span class="line">#等同於</span><br><span class="line"></span><br><span class="line">gem &apos;omniauth&apos;, &apos;&gt;= 1.9&apos;, &apos;&lt; 2.0&apos;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Gemfile的Grop"><a href="#Gemfile的Grop" class="headerlink" title="Gemfile的Grop"></a>Gemfile的Grop</h3><p>大約分為三種，Product（上線/發佈）, Development（開發）, Test（測試）。</p>
<p>Product 上線 / 發佈：</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">gem &apos;rails&apos;, &apos;~&gt; 5.2.3&apos;</span><br><span class="line"></span><br><span class="line">沒有在grop裡代表上線/發佈時才會使用到</span><br></pre></td></tr></table></figure>
<p>Development（開發）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">group :development do</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">寫在Development，這裡的 gem 會在開發時使用，上線時不會用</span><br></pre></td></tr></table></figure>

<p>Test (測試）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">group :test do</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">寫在Test裡，這裡的 gem 會在開發時使用，上線時不會用</span><br></pre></td></tr></table></figure>

<p>Development, Test（開發,測試）</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">group :development, :test do</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">寫在Development裡, Test，這裡的 gem 會在開發及測試時使用，上線時不會用</span><br></pre></td></tr></table></figure>

<p>參考資料：<br><a href="https://tosbourn.com/what-is-the-gemfile/" target="_blank" rel="noopener">What is a Gemfile?</a><br><a href="https://kaochenlong.com/2016/05/02/gemfile/" target="_blank" rel="noopener">Ruby 語法放大鏡</a></p>
<blockquote>
<p>“If you’re walking down the right path and you’re willing to keep walking, eventually you’ll make progress.”</p>
<p>— Barack Obama, the 44th U.S. President</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/27/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2014/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/27/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2014/" itemprop="url">Day14: 淺談Model資料表關聯</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-27T12:10:40+08:00">
                2019-09-27
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>不管用哪個程式語言或框架寫網站，多數會有資料庫的應用，資料與資料之間一定會有關聯性，那要如何在不同Model設立資料關係，這裏會用很簡單的例子去試著理解什麼是資料表關聯。</p>
<h2 id="Active-Record"><a href="#Active-Record" class="headerlink" title="Active Record"></a>Active Record</h2><p>根據手冊：「Active Record 是 MVC 的 M（Model），表現商業邏輯與資料的層級，負責新增與操作需要持久存在資料庫裡的資料」</p>
<p>看起來有點抽象，在我的理解大概就是這個概念：</p>
<p>Active Record ＝ 把資料做成物件（是一種ORM框架）<br>物件 = 欄位 + 基本操作 + 商業邏輯</p>
<p>這樣寫似乎還是有點抽象，但其實可以想像成：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Model = ActiveRecord.new</span><br></pre></td></tr></table></figure>

<h2 id="用店面舉例"><a href="#用店面舉例" class="headerlink" title="用店面舉例"></a>用店面舉例</h2><p>先預設我們有3個Model:</p>
<ul>
<li>Owner</li>
<li>Stroe</li>
<li>Product</li>
</ul>
<p><img src="https://i.imgur.com/DLbomd0.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">o1 = Owner.create(name: &apos;Louis&apos;)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/rNoho2g.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">s1 = Store.new(title: &apos;Louis Shop&apos;)</span><br><span class="line">此時s1的owner_id還是空的</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/80ze79M.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">o1.store = s1</span><br><span class="line">把 Store 指定給 Owner</span><br><span class="line">s1的Owner_id就有3了</span><br></pre></td></tr></table></figure>

<h3 id="可用-create-本身包含-save"><a href="#可用-create-本身包含-save" class="headerlink" title="可用 create (本身包含.save)"></a>可用 create (本身包含.save)</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">o1 = Owner.create(name: &apos;Sherly&apos;)</span><br><span class="line">o1.create_store(title: &apos;Ruby Shop&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/4e05pKT.png" alt=""></p>
<h3 id="用build-本身不包含save"><a href="#用build-本身不包含save" class="headerlink" title="用build(本身不包含save)"></a>用build(本身不包含save)</h3><p>還未.save前，可看到shop的id是空的</p>
<p><img src="https://i.imgur.com/wHv2AtF.png" alt=""></p>
<p>.save後</p>
<p><img src="https://i.imgur.com/owsFscG.png" alt=""><br><img src="https://i.imgur.com/D85OzMh.png" alt=""></p>
<h3 id="用new不會存進資料庫，必須額外-save"><a href="#用new不會存進資料庫，必須額外-save" class="headerlink" title="用new不會存進資料庫，必須額外.save"></a>用new不會存進資料庫，必須額外.save</h3><p><img src="https://i.imgur.com/GDgtmVc.png" alt=""></p>
<h3 id="用另一個角度"><a href="#用另一個角度" class="headerlink" title="用另一個角度"></a>用另一個角度</h3><p>只要有任一方有存入資料庫，就可以設定關聯性，不須雙方都存入資料庫</p>
<p><img src="https://i.imgur.com/cmkkdZf.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">.create_store =&gt; 直接寫入資料庫</span><br><span class="line">.build_store =&gt;  建立，但未寫入資料庫</span><br></pre></td></tr></table></figure>

<h3 id="has-one"><a href="#has-one" class="headerlink" title="has_one"></a>has_one</h3><figure class="highlight plain"><figcaption><span>:store，產生以下四個方法:</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">(類似 Cat = Animail.new的概念)</span><br><span class="line">•store</span><br><span class="line">•store=</span><br><span class="line">•build_store</span><br><span class="line">•create_store</span><br></pre></td></tr></table></figure>
<h3 id="belongs-to"><a href="#belongs-to" class="headerlink" title="belongs_to"></a>belongs_to</h3><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">belongs_to 也是一個類別方法</span><br><span class="line">執行belongs_to :owner，只有產生以下兩個方法:</span><br><span class="line">•owner</span><br><span class="line">•owner=</span><br></pre></td></tr></table></figure>
<h3 id="has-many"><a href="#has-many" class="headerlink" title="has_many"></a>has_many</h3><figure class="highlight plain"><figcaption><span>:products，只有產生以下四個方法:</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">products</span><br><span class="line">products=</span><br><span class="line">build</span><br><span class="line">create</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">#個別建立物件</span><br><span class="line">s1 = Store.first</span><br><span class="line">p1 = Product.new(name: &apos;iphone&apos;)</span><br><span class="line">p2 = Product.new(name: &apos;ipad&apos;)</span><br><span class="line"></span><br><span class="line">#方法一:可以一次塞入多個到s1</span><br><span class="line">s1.products = [p1, p2]</span><br><span class="line"></span><br><span class="line">#方法二:只能塞一個到s1</span><br><span class="line">s1.products.create(name: &apos;Mac&apos;)</span><br></pre></td></tr></table></figure>

<h3 id="has-many-through-多對多"><a href="#has-many-through-多對多" class="headerlink" title="has_many: through 多對多"></a>has_many: through 多對多</h3><p>跟has_many用起來差不多<br>需要第三方資料表來儲存兩邊資訊<br>第三方資料表通常只存放兩邊id，並且belong_to兩邊的Model</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">rails g WareHouse sotre:references product:references</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">rails g WareHouse sotre_id:<span class="built_in">integer</span> product_id:<span class="built_in">integer</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#store.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> &lt; ApplicationRecord</span></span><br><span class="line">  has_many <span class="symbol">:ware_houses</span></span><br><span class="line">  has_many <span class="symbol">:products</span>, <span class="symbol">through:</span> <span class="symbol">:ware_houses</span> <span class="comment">#透過第三方</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#product.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> &lt; ApplicationRecord</span></span><br><span class="line">  <span class="comment"># belongs_to :store</span></span><br><span class="line">  has_many <span class="symbol">:ware_houses</span></span><br><span class="line">  has_many <span class="symbol">:stores</span>, <span class="symbol">through:</span> <span class="symbol">:ware_houses</span> <span class="comment">#透過第三方</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">s1 = Store.first</span><br><span class="line">s2 = Store.second</span><br><span class="line">p1 = Product.first</span><br><span class="line">p2 = Product.second</span><br><span class="line">p3 = Product.third</span><br></pre></td></tr></table></figure>

<p>試著建立這樣的關係：</p>
<p><img src="https://i.imgur.com/fCOx69y.png" alt=""></p>
<p><img src="https://i.imgur.com/Nn24Kip.png" alt=""><br><img src="https://i.imgur.com/mGlKdse.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">下圖:</span><br><span class="line">p2.stores -&gt;p2商品再哪間店有貨</span><br><span class="line">s1.owner  -&gt;s1店面的店長是誰</span><br><span class="line">s2.products -&gt; s2店面有哪些商品</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/I6R7ybA.png" alt=""></p>
<p>參考資料：<br><a href="https://railsbook.tw/chapters/16-model-basic.html" target="_blank" rel="noopener">Model 基本操作</a></p>
<blockquote>
<p>“I realized early on that success was tied to not giving up. Most people in this business gave up and went on to other things. If you simply didn’t give up, you would outlast the people who came in on the bus with you.”</p>
<p>— Harrison Ford, Actor</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/26/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2013/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/26/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2013/" itemprop="url">Day13: Ruby on Rails 的 .nil? .empty? .blank? .present? </a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-26T12:10:40+08:00">
                2019-09-26
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在Ruby on Rails有很多神奇又好用的黑魔法，但有幾個類似的方法會搞不清楚到底在哪個狀況時要用哪個method…</p>
<p>我在寫rails的時候曾經踩過一個小雷：<br><img src="https://i.imgur.com/TAhp77y.png" alt=""></p>
<p>現在這個使用者的name欄位是空的，所以回傳的是<code>nil</code>，如果此時在<code>current_user.name</code>後接的是<code>.empty?</code>就會噴錯，所以要用<code>.nil?</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> current_user.name.<span class="literal">nil</span>?   <span class="comment">#原本寫的是.empty?</span></span><br><span class="line">      redirect_to edit_user_registration_path</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="comment">#下略</span></span><br></pre></td></tr></table></figure>
<h2 id="Ruby-nil-empty"><a href="#Ruby-nil-empty" class="headerlink" title="Ruby - .nil? .empty?"></a>Ruby - .nil? .empty?</h2><h3 id="nil"><a href="#nil" class="headerlink" title=".nil?"></a>.nil?</h3><p>還記得有句快說到爛的話，「在Ruby幾乎所有東西都是物件，除了block」，所以nil也是物件。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">nil</span>.<span class="keyword">class</span></span><br><span class="line">=&gt; NilClass</span><br><span class="line"></span><br><span class="line"><span class="literal">nil</span>.<span class="literal">nil</span>? </span><br><span class="line">=&gt; true </span><br><span class="line"></span><br><span class="line">a = <span class="literal">nil</span></span><br><span class="line">a.<span class="literal">nil</span>? = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="string">""</span>.<span class="literal">nil</span>? </span><br><span class="line">=&gt; false</span><br><span class="line"></span><br><span class="line"><span class="literal">false</span>.<span class="literal">nil</span>? </span><br><span class="line">=&gt; false</span><br><span class="line"></span><br><span class="line">[].<span class="literal">nil</span>? </span><br><span class="line">=&gt; false</span><br></pre></td></tr></table></figure>
<p>可以很簡單地看出結果，只要<code>.nil?</code>之前接的物件是<code>nil</code>的話會回傳<code>true</code>，其他則都會回傳<code>flase</code>。</p>
<h3 id="empty"><a href="#empty" class="headerlink" title=".empty?"></a>.empty?</h3><p><code>.empty</code>方法前面是針對<code>string</code> <code>array</code> <code>hash</code>使用，如果這三種物件的長度為0 (legth == 0)的話，就會回傳<code>true</code>否則回傳<code>flase</code>。</p>
<p>另一種情況，如果<code>.empty?</code>前接的不是這三種物件的話，則會噴<code>undefined method empty?。</code></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">""</span>.empty? </span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">[].empty? </span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">[ ].empty? </span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">" "</span>.empty?        <span class="comment">#空白字串也有長度</span></span><br><span class="line">=&gt; false</span><br><span class="line"></span><br><span class="line"><span class="literal">nil</span>.empty? </span><br><span class="line"><span class="symbol">NoMethodError:</span> undefined method <span class="string">`empty?' for nil:NilClass</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">false.empty? </span></span><br><span class="line"><span class="string">NoMethodError: undefined method `</span>empty?<span class="string">' for false:FalseClass</span></span><br></pre></td></tr></table></figure>

<h2 id="Rails-blank-present"><a href="#Rails-blank-present" class="headerlink" title="Rails - .blank? .present?"></a>Rails - .blank? .present?</h2><h3 id="blank"><a href="#blank" class="headerlink" title=".blank?"></a>.blank?</h3><p><code>.blank?</code>是一個<code>ActiveRecord method</code>，針對 <code>nil</code> <code>string</code> <code>array</code> <code>hash</code> 使用，在 <code>false</code> <code>nil</code> <code>empty</code>或<strong>空白</strong>字串(不是length == 0)時會回傳 true，否則回傳<code>false</code>。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="literal">false</span>.blank?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"><span class="literal">nil</span>.blank?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"><span class="string">""</span>.blank? </span><br><span class="line">=&gt; true </span><br><span class="line"></span><br><span class="line"><span class="string">" "</span>.blank? </span><br><span class="line">=&gt; true            <span class="comment">#(跟.empty?不同)</span></span><br><span class="line"></span><br><span class="line">[].blank? </span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">&#123;&#125;.blank?</span><br><span class="line">=&gt; true</span><br></pre></td></tr></table></figure>
<h3 id="present"><a href="#present" class="headerlink" title=".present?"></a>.present?</h3><p><code>.present?</code>來自·<code>Active Record</code>，其實就是.blank?的相反用法，換句話說就是：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!object.blank? == object.present?</span><br></pre></td></tr></table></figure>

<p>參考資料：<br><a href="https://jamestong10.github.io/blog/2016/09/01/rails-i18n-timezone/" target="_blank" rel="noopener">Rails I18n 多語系</a><br><a href="https://medium.com/le-wagon/how-to-use-nil-blank-present-exists-in-rails-5-fe03e78ab979" target="_blank" rel="noopener">How to use .nil? .empty? .blank? .present? in Rails 5</a><br><a href="https://mgleon08.github.io/blog/2015/12/16/ruby-on-rail-nil-empty-blank-present/" target="_blank" rel="noopener">.nil? .empty? .blank? .present? 傻傻分不清楚？</a><br><a href="https://ruby-doc.org/core-2.6.4/Object.html" target="_blank" rel="noopener">Ruby API</a></p>
<blockquote>
<p>“The two most powerful warriors are patience and time.”</p>
<p>— Leo Tolstoy, Novelist</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/25/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2012/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/25/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2012/" itemprop="url">Day12: Ruby的例外處理(Exceptions)：begin...rescue ...end</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-25T12:10:40+08:00">
                2019-09-25
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>幾乎每個程式語言都有例外處理的功能，當程式在執行時，不免都會遇到非工程師預期的狀況發生，我們可以針對不同例外訊息設計不同的例外處理。</p>
<p>在Ruby例外處理的基本架構：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">#程式碼正常執行的地方 (可能出現例外的程式碼)</span></span><br><span class="line"><span class="keyword">rescue</span> </span><br><span class="line">  <span class="comment">#發生錯誤時執行的地方</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>當Ruby執行程式發生錯誤時，會丟出一個Error類別產生的例外物件並停止程式，各種錯誤類型用架構的方式歸納：</p>
<p><img src="https://i.imgur.com/AcWTC5W.png" alt=""><br>圖片來源:Programming Ruby book</p>
<p>有這麼多例外訊息的類別，要舉例可能舉不完，不過用起來大概像下面這種感覺：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">begin</span> </span><br><span class="line">  <span class="comment"># 可能出現例外的程式碼</span></span><br><span class="line"><span class="keyword">rescue</span> SyntaxError</span><br><span class="line">  <span class="comment"># 出現SyntaxError時執行此行程式碼</span></span><br><span class="line"><span class="keyword">rescue</span> ArgumentError</span><br><span class="line">  <span class="comment"># 出現ArgumentError時執行此行程式碼</span></span><br><span class="line"><span class="keyword">rescue</span> RuntimeError</span><br><span class="line">  <span class="comment"># 出現RuntimeError時執行此行程式碼</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>所以可針對丟出的例外訊息，去處理該訊息的例外處理，當然最常見的還是<code>SyntaxError</code>, <code>ArgumentError</code>及<code>RuntimeError</code>。如果沒有在<code>rescue</code>後特別寫哪種類別的話，任何的錯誤類別都會被<code>rescue</code>給抓到。</p>
<p>在舉例之前，我想先說說該如何用raise來產生例外處理。</p>
<h2 id="raise"><a href="#raise" class="headerlink" title="raise"></a>raise</h2><p>一般在簡單的程式碼，比較不會有例外處理的狀況發生，但為了舉例，我們也可以透過手動產生例外處理來觸發我們想要的結果，那我們就可以用raise method來執行。</p>
<h3 id="raise是什麼？"><a href="#raise是什麼？" class="headerlink" title="raise是什麼？"></a>raise是什麼？</h3><blockquote>
<p>The raise method is from the Kernel module. By default, raise creates an exception of the RuntimeError class.</p>
</blockquote>
<p>raise是來自於Kernel這個module的method，”預設”會產生來自RuntimeError這個類別的exception實體。</p>
<p>既然是預設，代表我們一定可以自己寫raise method後會產生哪個類別的實體。</p>
<h4 id="預設：RuntimeError"><a href="#預設：RuntimeError" class="headerlink" title="預設：RuntimeError"></a>預設：RuntimeError</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span>  </span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之前'</span>  </span><br><span class="line">  raise <span class="string">'發生錯誤！'</span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之後'</span>  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">raise_exception</span><br></pre></td></tr></table></figure>
<p>印出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">這邊是執行到raise之前</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">	1: from test.rb:18:in `&lt;main&gt;&apos;</span><br><span class="line">test.rb:15:in `raise_exception&apos;: 發生錯誤！ (RuntimeError)</span><br><span class="line">                                           #預設類別</span><br></pre></td></tr></table></figure>
<h4 id="指定其他類別-以ArgumentError為例"><a href="#指定其他類別-以ArgumentError為例" class="headerlink" title="指定其他類別(以ArgumentError為例)"></a>指定其他類別(以ArgumentError為例)</h4><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span>  </span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之前'</span>  </span><br><span class="line">  raise ArgumentError, <span class="string">'發生錯誤！'</span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之後'</span>  </span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">raise_exception</span><br></pre></td></tr></table></figure>
<p>印出</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">這邊是執行到raise之前</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">	1: from test.rb:18:in `&lt;main&gt;&apos;</span><br><span class="line">test.rb:15:in `raise_exception&apos;: 發生錯誤！ (ArgumentError)</span><br><span class="line">                                           #被指定類別</span><br></pre></td></tr></table></figure>
<h2 id="begin…rescue…end"><a href="#begin…rescue…end" class="headerlink" title="begin…rescue…end"></a>begin…rescue…end</h2><h4 id="預設Exception"><a href="#預設Exception" class="headerlink" title="預設Exception"></a>預設Exception</h4><p>程式執行時先印出”發生例外之前”，之後遇到<code>raise</code>發生例外，故去找<code>rescue</code>底下的程式碼並執行，印出”已處理例外”。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span>  </span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span>  </span><br><span class="line">    raise <span class="string">'發生例外！'</span>     <span class="comment">#沒指定Error類別，預設為RuntimeError</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span>                 <span class="comment">#預設RuntimeError，所有錯誤都會到這執行</span></span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">raise_exception </span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    已處理例外</span></span><br></pre></td></tr></table></figure>

<h4 id="指定錯誤類別"><a href="#指定錯誤類別" class="headerlink" title="指定錯誤類別"></a>指定錯誤類別</h4><p>程式執行時先印出”發生例外之前”，之後遇到<code>raise</code>LoadError類別發生例外，因為已被指定是遇到LoadError產生的實體，rescue後並無指定要救援哪個類別，故印出”發生例外！ (LoadError)”。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span>  </span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span>  </span><br><span class="line">    raise LoadError, <span class="string">'發生例外！'</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span></span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">raise_exception  </span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    發生例外！ (LoadError)</span></span><br></pre></td></tr></table></figure>

<p>若要修正，只要將rescue後加入該發生例外訊息時的類別就可以了。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span>  </span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span>  </span><br><span class="line">    raise LoadError, <span class="string">'發生例外！'</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span> LoadError</span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">raise_exception </span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    已處理例外</span></span><br></pre></td></tr></table></figure>

<p><strong>其實以上範例的<code>begin</code>跟<code>end</code>，可以被同時省略，只要留下<code>rescue</code>就可以正常執行，讓程式碼看起來更精簡，但對於金魚腦的我來說，為了方便未來能夠容易閱(理)讀(解)，還是不會把它們省略。</strong></p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span>  </span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span>  </span><br><span class="line">    raise LoadError, <span class="string">'發生例外！'</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span> LoadError</span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line"><span class="keyword">end</span>  </span><br><span class="line">raise_exception </span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    已處理例外</span></span><br></pre></td></tr></table></figure>



<h2 id="總結："><a href="#總結：" class="headerlink" title="總結："></a>總結：</h2><p>其實這個主題可以寫出非常多東西，目前只針對自己可能會用到的部分做說明，如果有興趣的朋友可以到參考資料看更多關於Exceptions的介紹。</p>
<ol>
<li><code>begin...rescue...end</code>用來解決非預期的結果。<ul>
<li>begin…rescue: 可能發生例外的程式碼</li>
<li>rescue…end: 發生錯誤時執行的程式碼</li>
</ul>
</li>
<li>可針對丟出的例外訊息，去處理該訊息的例外處理。</li>
<li><code>begin</code> <code>end</code>可省略</li>
</ol>
<p>參考資料：<br><a href="https://ruby-doc.org/core-2.2.3/Kernel.html#method-i-raise" target="_blank" rel="noopener">Ruby Kernel</a><br><a href="http://rubylearning.com/satishtalim/ruby_exceptions.html" target="_blank" rel="noopener">Ruby Exceptions</a><br><a href="https://mgleon08.github.io/blog/2016/02/04/rescue-exception/" target="_blank" rel="noopener">例外處理 Rescue Exception, Error Handling, Custom Error Pages</a><br><a href="https://pjchender.github.io/2018/06/05/ruby-error-handling%EF%BC%88%E9%8C%AF%E8%AA%A4%E8%99%95%E7%90%86%EF%BC%89/" target="_blank" rel="noopener">[Ruby] Error Handling（錯誤處理)</a><br><a href="https://medium.com/@eggyy1224/ruby-%E7%9A%84%E4%BE%8B%E5%A4%96%E8%99%95%E7%90%86%E6%A9%9F%E5%88%B6-106f829f280b" target="_blank" rel="noopener">Ruby 的例外處理機制</a><br><a href="https://medium.com/@pk60905/rails%E7%9A%84%E9%8C%AF%E8%AA%A4%E8%99%95%E7%90%86%E6%A9%9F%E5%88%B6begin-rescue%E5%92%8Cexception-ab71156a24a2" target="_blank" rel="noopener">Rails的錯誤處理機制begin、rescue和Exception</a></p>
<blockquote>
<p>“The meaning of life is to find your gift. The purpose &gt;of life is to give it away.”</p>
<p>– Pablo Picasso, Artist</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2019/09/24/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2011/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/uploads/img.jpg">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Louis">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2019/09/24/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2011/" itemprop="url">Day11: Ruby中的Getter及Setter?</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">Posted on</span>
              
              <time title="Post created" itemprop="dateCreated datePublished" datetime="2019-09-24T12:10:40+08:00">
                2019-09-24
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>在最近的練習中，只有印象自己大量的在用<code>attr_reader :somthing</code>，在完成這篇文章前，我完全不知道其實它就是getter method…</p>
<p>關於setter就真的更陌生了，也有在專案或練習的時候有用到，但也一樣完全不知道其實在用的就是setter method，所以決定寫個一篇文章來釐清一下觀念。</p>
<h2 id="Ruby沒有「屬性-property-attribute-」"><a href="#Ruby沒有「屬性-property-attribute-」" class="headerlink" title="Ruby沒有「屬性(property/attribute)」"></a>Ruby沒有「屬性(property/attribute)」</h2><p>Ruby沒有屬性這件事，跟其他程式語言不一樣，下面的例子：</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">my.event</span><br><span class="line"><span class="comment">#其實原型是</span></span><br><span class="line">my.event()</span><br><span class="line"></span><br><span class="line">my.event = <span class="string">"something"</span></span><br><span class="line"><span class="comment">#其實原型是</span></span><br><span class="line">my.event=(<span class="string">"something"</span>)</span><br></pre></td></tr></table></figure>

<p>my.event看起來像是在my上讀取event的屬性，但它實際是執行了my.event()方法，只是括號可以適時省略，相同的my.event=(“something”)也是同樣道理。</p>
<h2 id="什麼是getter-method"><a href="#什麼是getter-method" class="headerlink" title="什麼是getter method?"></a>什麼是getter method?</h2><p>就英文直翻getter method是「取得(get)的方法」的意思，在Ruby裡指的就是取出實體變數(instance variable)的方法。</p>
<p>如果class裡沒有getter method，就無法取出在class內實體變數的值。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event</span><br></pre></td></tr></table></figure>
<p>會印出錯誤訊息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">undefined local variable or method `badminton&apos; for main:Object (NameError)</span><br></pre></td></tr></table></figure>

<p>可以看得出來，my這個實體拿不到class裡的實體變數@event，如果要拿到@event的話，必須給它一個getter method。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">event</span>    <span class="comment">#getter method</span></span></span><br><span class="line">    @event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)   </span><br><span class="line">puts my.event  <span class="comment"># =&gt; Badminton</span></span><br></pre></td></tr></table></figure>

<p>龍哥說，工程師都很懶惰，如果每次要取實體變數的值都要寫一次getter method不是很麻煩嗎？</p>
<h3 id="attr-reader"><a href="#attr-reader" class="headerlink" title="attr_reader"></a>attr_reader</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event     #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new <span class="string">'Badminton'</span></span><br><span class="line">puts my.event</span><br></pre></td></tr></table></figure>

<p>在class內加入<code>attr_reader :event</code>就自動幫你產生寫了第8~10行。</p>
<h2 id="什麼是setter-method"><a href="#什麼是setter-method" class="headerlink" title="什麼是setter method?"></a>什麼是setter method?</h2><p>就英文直翻setter method是「指派(assign)的方法」的意思，在Ruby裡指的就是指派實體變數(instance variable)的方法。</p>
<p>如果class裡沒有setter method，就無法派在class內實體變數的值。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event     #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)   </span><br><span class="line">puts my.event  <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event = <span class="string">"Pasta"</span></span><br></pre></td></tr></table></figure>

<p>會印出錯誤訊息</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">undefined local variable or method `badminton&apos; for main:Object (NameError)</span><br></pre></td></tr></table></figure>

<p>可以看得出來，my這個實體做event方法時，如果要直接指派event方法內部的實體變數@event為”Pasta”，必須給它一個setter method。</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event        #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">event=</span> <span class="title">food</span>    <span class="comment">#setter method</span></span></span><br><span class="line">    @event = food</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)   </span><br><span class="line">puts my.event           <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event=(<span class="string">"Pasta"</span>) <span class="comment"># =&gt; Pasta</span></span><br></pre></td></tr></table></figure>

<p>等等….為什麼方法名稱有個等於又帶括號？</p>
<h3 id="Ruby魔法糖-括號可適時的省略"><a href="#Ruby魔法糖-括號可適時的省略" class="headerlink" title="Ruby魔法糖? - 括號可適時的省略"></a>Ruby魔法糖? - 括號可適時的省略</h3><p>Rub6定義方法時，等號跟其他字元都可以當作是名字的一部分，只是規定上必須放在最後面。</p>
<p>所以可以將<code>event=(food)</code>解讀一下：event= 是方法名稱，帶有參數food</p>
<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">event=(food)  </span><br><span class="line"></span><br><span class="line"><span class="comment">#括號可適時的省略</span></span><br><span class="line">event=food</span><br><span class="line"></span><br><span class="line"><span class="comment">#可適時加入空白字元</span></span><br><span class="line">event = food</span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event     #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">event=</span> <span class="title">food</span> <span class="comment">#括號可適時的省略   #setter method</span></span></span><br><span class="line">    @event = food</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)   </span><br><span class="line">puts my.event           <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event = <span class="string">"Pasta"</span> <span class="comment"># =&gt; Pasta      #括號可適時的省略並加入空白字元</span></span><br></pre></td></tr></table></figure>

<p>還好工程師都很懶惰再一次，這裏也可以寫成attr的方式。</p>
<h3 id="attr-writer"><a href="#attr-writer" class="headerlink" title="attr_writer"></a>attr_writer</h3><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line">  <span class="keyword">attr_writer</span> <span class="symbol">:event</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event         #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event= food   #setter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span> = food</span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)   </span><br><span class="line">puts my.event           <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event = <span class="string">"Pasta"</span> <span class="comment"># =&gt; Pasta</span></span><br></pre></td></tr></table></figure>

<p>在class內加入<code>attr_writer :event</code>就自動幫你產生寫了第13~15行。</p>
<p>還好偉大的<del>懶惰</del>工程師們，覺得如果要再多個實體變數的話，就得要再寫<code>attr_reader</code>跟<code>attr_writer</code>的方式來取得跟指派，實在太麻煩了…</p>
<h2 id="attr-accessor"><a href="#attr-accessor" class="headerlink" title="attr_accessor"></a>attr_accessor</h2><figure class="highlight ruby"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="comment"># attr_reader :event</span></span><br><span class="line">  <span class="comment"># attr_writer :event</span></span><br><span class="line">  <span class="comment"># attr_reader :price</span></span><br><span class="line">  <span class="comment"># attr_writer :price</span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:event</span>, <span class="symbol">:price</span></span><br><span class="line">  </span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event, price)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">    @price = price</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event         #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event= food   #setter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span> = food</span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>, <span class="string">"$200"</span>)  </span><br><span class="line">my.event = <span class="string">"Volleyball"</span></span><br><span class="line">my.price = <span class="string">"$300"</span></span><br><span class="line">puts my.event           <span class="comment"># =&gt; Volleyball</span></span><br><span class="line">puts my.price           <span class="comment"># =&gt; $300</span></span><br></pre></td></tr></table></figure>

<p>在class內加入<code>attr_accessor :event, :price</code>就自動幫你產生寫了第2~5行。</p>
<p>這也是為何我們在rails專案裡，可以用<strong>點</strong>的方式取值的概念，例如：第5~10行，在rails裡的Active Record(MVC的M (Model))，會自動建立<code>attr_accessor :foods</code>。</p>
<figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> @<span class="attr">foods.each</span> <span class="attr">do</span> |<span class="attr">food</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      名稱：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.title</span>%&gt;</span></span><br><span class="line">      數量：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.quantity</span>%&gt;</span></span><br><span class="line">      可領取時間：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.pickup_time</span>%&gt;</span></span><br><span class="line">      原價：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.origin_price</span>%&gt;</span></span><br><span class="line">      救援價：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.discount_price</span>%&gt;</span></span><br><span class="line">      描述：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.description</span>%&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%end%</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><ol>
<li>getter method: <strong>取出</strong>實體變數(instance variable)的方法。</li>
<li>setter method: <strong>指派</strong>實體變數(instance variable)的方法。</li>
<li><code>attr_reader</code> + <code>attr_writer</code> = <code>attr_accessor</code></li>
</ol>
<p>參考資料：<br><a href="https://medium.com/@rondwalker22/how-getter-setter-methods-work-in-ruby-c5f5da07f99" target="_blank" rel="noopener">How getter/setter methods work in Ruby</a><br><a href="https://dev.to/k_penguin_sato/ruby-getters-and-setters-1p30#what-is-a-getter-method" target="_blank" rel="noopener">Ruby Getters and Setters</a><br><a href="https://kaochenlong.com/2015/03/21/attr_accessor/" target="_blank" rel="noopener">Ruby 語法放大鏡之「attr_accessor 是幹嘛的?</a></p>
<blockquote>
<p>“The conditions of conquest are always easy. We have but to toil awhile, endure awhile, believe always, and never turn back.”</p>
<p>— Lucius Annaeus Seneca, Philosopher</p>
</blockquote>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/">&lt;i class=&quot;fa fa-angle-left&quot;&gt;&lt;&#x2F;i&gt;</a><a class="page-number" href="/">1</a><span class="page-number current">2</span><a class="page-number" href="/page/3/">3</a><a class="page-number" href="/page/4/">4</a><a class="extend next" rel="next" href="/page/3/">&lt;i class=&quot;fa fa-angle-right&quot;&gt;&lt;&#x2F;i&gt;</a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="/uploads/img.jpg"
                alt="John Doe" />
            
              <p class="site-author-name" itemprop="name">John Doe</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">32</span>
                  <span class="site-state-item-name">posts</span>
                </a>
              </div>
            

            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">tags</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2019</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>

  
</div>


  <div class="powered-by">Powered by <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a></div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">Theme &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Pisces</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  


  <script type="text/javascript" src="/js/src/affix.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/schemes/pisces.js?v=5.1.4"></script>



  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
