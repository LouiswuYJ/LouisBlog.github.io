<?xml version="1.0" encoding="utf-8"?>
<search>
  <entry>
    <title>如何把 iterm2 oh-my-zsh 的路徑變短</title>
    <url>/LouiswuYJ.github.io/2019/%E5%A6%82%E4%BD%95%E6%8A%8A%20iterm2%20oh-my-zsh%20%E7%9A%84%E8%B7%AF%E5%BE%91%E8%AE%8A%E7%9F%AD/</url>
    <content><![CDATA[<p>若擔心改壞的話，建議可以先備份原始的 agnoster.zsh-theme 檔後再進行編輯。</p>
<p>查了很多方法都不可行，後來發現只要按照以下步驟的話，就可以順利把路徑縮短。</p>
<h3 id="步驟1-找到-oh-my-zsh-themes-資料夾"><a href="#步驟1-找到-oh-my-zsh-themes-資料夾" class="headerlink" title="步驟1. 找到 .oh-my-zsh/themes 資料夾"></a>步驟1. 找到 .oh-my-zsh/themes 資料夾</h3><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">open ~/.oh-my-zsh/themes</span><br></pre></td></tr></table></figure>

<h3 id="步驟2-打開-themes-資料夾底下的-agnoster-zsh-theme-文件檔"><a href="#步驟2-打開-themes-資料夾底下的-agnoster-zsh-theme-文件檔" class="headerlink" title="步驟2. 打開 themes 資料夾底下的 agnoster.zsh-theme (文件檔)"></a>步驟2. 打開 themes 資料夾底下的 agnoster.zsh-theme (文件檔)</h3><p>看個人習慣要用vim開還是一般的文字編輯器都可以:</p>
<h3 id="步驟3-找到-prompt-dir-並加入數字"><a href="#步驟3-找到-prompt-dir-並加入數字" class="headerlink" title="步驟3. 找到 prompt_dir() 並加入數字"></a>步驟3. 找到 prompt_dir() 並加入數字</h3><p>原始:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dir: current working directory</span></span><br><span class="line"><span class="function"><span class="title">prompt_dir</span></span>() &#123;</span><br><span class="line">  prompt_segment blue <span class="variable">$CURRENT_FG</span> <span class="string">'%~'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h4 id="數字1-代表顯示1層"><a href="#數字1-代表顯示1層" class="headerlink" title="數字1: 代表顯示1層"></a>數字1: 代表顯示1層</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dir: current working directory</span></span><br><span class="line"><span class="function"><span class="title">prompt_dir</span></span>() &#123;</span><br><span class="line"><span class="comment"># prompt_segment blue $CURRENT_FG '%~'</span></span><br><span class="line">  prompt_segment blue <span class="variable">$CURRENT_FG</span> <span class="string">'%1~'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/4PaQBqx.png" alt=""></p>
<h4 id="數字2-代表顯示2層"><a href="#數字2-代表顯示2層" class="headerlink" title="數字2: 代表顯示2層"></a>數字2: 代表顯示2層</h4><figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment"># Dir: current working directory</span></span><br><span class="line"><span class="function"><span class="title">prompt_dir</span></span>() &#123;</span><br><span class="line"><span class="comment"># prompt_segment blue $CURRENT_FG '%~'</span></span><br><span class="line">  prompt_segment blue <span class="variable">$CURRENT_FG</span> <span class="string">'%2~'</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/cPwh3Sr.png" alt=""></p>
<p>以此類推</p>
<p>參考資料：<br><a href="https://medium.com/@shandou/how-to-shorten-zsh-prompt-oh-my-zsh-14185f3e7ab7" target="_blank" rel="noopener">How to shorten zsh prompt (oh my zsh)</a></p>
]]></content>
      <categories>
        <category>開發相關</category>
      </categories>
      <tags>
        <tag>iterm2</tag>
      </tags>
  </entry>
  <entry>
    <title>Day30: 我竟然完賽了？</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2030/</url>
    <content><![CDATA[<p>在這裡，我要感謝我的父母#%#$@!@^&amp;（誤</p>
<p>看第1天的“參賽起始文”，還清楚記得發文當下的感覺：</p>
<h3 id="“我自己真的能做到嗎？”"><a href="#“我自己真的能做到嗎？”" class="headerlink" title="“我自己真的能做到嗎？”"></a>“我自己真的能做到嗎？”</h3><p>寫到了第30天，真的不敢相信自己竟然真的完賽了!? 過程中真的頗痛苦，但好像已經默默的養成每天早上起來看文件的習慣，說進步嗎..?</p>
<p>或許有、或許沒有，至少證實了一句話：</p>
<blockquote>
<p>「時間就像擠乳溝，硬擠一下就有了。」</p>
</blockquote>
<p>這30篇文章有很多可以改進跟修正的地方(尤其廢文)，還好這次是報名自我挑戰組，心態上也比較不一樣，也許明年挑戰Mordern Web組的時候又是另一個挑戰跟態度了吧！(什麼..你竟然還想再挑戰？)</p>
<p>這次雖然有完賽，其實不能說都是靠自己的力量，回頭想想，如果沒有身邊夥伴的互相鼓勵跟支持，我覺得只靠我自己是不可能完賽的，很感謝他們。</p>
<p>說到夥伴們就覺得感慨，在五倍這邊也只剩下不到一週的時間就要結束了，雖然這裡是鐵人賽，但就像第1天說的，就當是寫給自己看的。</p>
<p>如果沒有“某菜”每天的嘴砲注入點活力，也許我不會走到現在。<br>如果沒有“某叔”在CRUD時耐心教我，我想我應該早就放棄了。<br>如果沒有“某聰”對於程式的求知慾，我想我對於寫程式應該不會感到有興趣。<br>如果沒有“某凡”逆流而上的態度，我應該早就被壓力擊垮了。<br>如果沒有“某尼”的強大，我就不會意識到自己離車尾燈還有多麼遙遠。</p>
<p><strong>(夥伴、饅頭真的真的在這行很重要啊!!!)</strong></p>
<p>五倍Astrocamp跟鐵人賽的結束，只是一個「進入新手村」開始，我才剛創建好角色準備踏入而已，期許自己幾年後回頭看看現在的自己會忍不住大噴一番XD</p>
<p>鐵人賽，我們明年見！</p>
<blockquote>
<p>“Would you like me to give you a formula for success? It’s quite simple, really. Double your rate of failure. You’re thinking of failure as the enemy of success. But it isn’t at all… You can be discouraged by failure – or you can learn from it. So go ahead and make mistakes. Make all you can. Because, remember that’s where you’ll find success. On the far side.”</p>
<p>– Thomas J. Watson, Founder of IBM</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day29: Rails - Active Storage</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2029/</url>
    <content><![CDATA[<p>最近做專案遇到了上傳檔案的問題，想針對這個主題簡單的做個介紹。</p>
<h2 id="Active-Storage"><a href="#Active-Storage" class="headerlink" title="Active Storage"></a>Active Storage</h2><blockquote>
<p>Active Storage可以將文件上傳到Amazon S3，Google Cloud Storage或Microsoft Azure Storage等雲存儲服務，並將這些文件附加到Active Record。</p>
<p>它是一個可以用於開發或測試的服務，並可將文件進行備份和遷移。</p>
<p>其中，使用Active Storage，可以使用ImageMagick轉換圖像上傳，上傳非圖像或圖像（如PDF或影片）的檔案，並可任意從文件中存取。</p>
<p>by Rails Guide-Active Storage Overview</p>
</blockquote>
<p>據 Rails 官方文件說明，Active Storage 是在 Rails 5.2版後才推出的功能，在它之前似乎多數人都使用 Paperclip 及 CarrierWave，這次將會已上傳圖片為例來做說明。</p>
<p>在開始之前，得先在終端機執行以下指令：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rails active_storage:install</span><br><span class="line">rails db:migrate</span><br></pre></td></tr></table></figure>

<p>第一行會產生兩個table的migration：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment"># This migration comes from active_storage (originally 20170806125915)</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CreateActiveStorageTables</span> &lt; ActiveRecord::Migration[5.2]</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">change</span></span></span><br><span class="line">    create_table <span class="symbol">:active_storage_blobs</span> <span class="keyword">do</span> <span class="params">|t|</span></span><br><span class="line">      t.string   <span class="symbol">:key</span>,        <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line">      t.string   <span class="symbol">:filename</span>,   <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line">      t.string   <span class="symbol">:content_type</span></span><br><span class="line">      t.text     <span class="symbol">:metadata</span></span><br><span class="line">      t.bigint   <span class="symbol">:byte_size</span>,  <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line">      t.string   <span class="symbol">:checksum</span>,   <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line">      t.datetime <span class="symbol">:created_at</span>, <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      t.index [ <span class="symbol">:key</span> ], <span class="symbol">unique:</span> <span class="literal">true</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">    create_table <span class="symbol">:active_storage_attachments</span> <span class="keyword">do</span> <span class="params">|t|</span></span><br><span class="line">      t.string     <span class="symbol">:name</span>,     <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line">      t.references <span class="symbol">:record</span>,   <span class="symbol">null:</span> <span class="literal">false</span>, <span class="symbol">polymorphic:</span> <span class="literal">true</span>, <span class="symbol">index:</span> <span class="literal">false</span></span><br><span class="line">      t.references <span class="symbol">:blob</span>,     <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      t.datetime <span class="symbol">:created_at</span>, <span class="symbol">null:</span> <span class="literal">false</span></span><br><span class="line"></span><br><span class="line">      t.index [ <span class="symbol">:record_type</span>, <span class="symbol">:record_id</span>, <span class="symbol">:name</span>, <span class="symbol">:blob_id</span> ], <span class="symbol">name:</span> <span class="string">"index_active_storage_attachments_uniqueness"</span>, <span class="symbol">unique:</span> <span class="literal">true</span></span><br><span class="line">      t.foreign_key <span class="symbol">:active_storage_blobs</span>, <span class="symbol">column:</span> <span class="symbol">:blob_id</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>db:migrate之後，就可以看到 schema.rb 已新增兩個 table：</p>
<p><code>active_storage_blobs</code>: 存放附檔資訊<br><code>active_storage_attachments</code>: 存放附檔和 model 的關聯</p>
<p>其中附加檔案的方式有分成一個 model 一個檔案或甚至多個檔案，我們先已有個food model舉例：</p>
<h2 id="一個食物一個檔案"><a href="#一個食物一個檔案" class="headerlink" title="一個食物一個檔案"></a>一個食物一個檔案</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#food.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> &lt; ApplicationRecord</span></span><br><span class="line">  has_one_attached <span class="symbol">:avatar</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>其實在schema裡是看不到avatar這個欄位，可以想成是“虛擬欄位的概念”。</p>
<p><img src="https://i.imgur.com/0NelClW.png" alt=""></p>
<p>如果要做個可以上傳的表單的話，可以利用 form_for來實現：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#<span class="doctag">@foods</span> = Food.all</span></span><br><span class="line">&lt;%= form_for(@foods) <span class="keyword">do</span> <span class="params">|form|</span> %&gt;</span><br><span class="line"></span><br><span class="line">  &lt;%= form.label <span class="symbol">:avatar</span>, <span class="string">'檔案上傳'</span>,</span><br><span class="line">  &lt;%= form.file_field <span class="symbol">:avatar%&gt;</span></span><br><span class="line"><span class="comment">#下略</span></span><br><span class="line">&lt;% <span class="keyword">end</span> %&gt;</span><br></pre></td></tr></table></figure>
<h4 id="Strong-parameter"><a href="#Strong-parameter" class="headerlink" title="Strong parameter"></a>Strong parameter</h4><p>只要是丟資料到網站上，都需要permit才可以，故要在params的地方也要記得要加上:avatar去permit。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clean_params</span></span></span><br><span class="line">  params.<span class="keyword">require</span>(<span class="symbol">:food</span>).permit(<span class="symbol">:title</span>, <span class="symbol">:address</span>, <span class="symbol">:phone</span>, <span class="symbol">:quantity</span>, <span class="symbol">:origin_price</span>, <span class="symbol">:discount_price</span>, <span class="symbol">:pickup_time</span>, <span class="symbol">:picture</span>, <span class="symbol">:description</span>, <span class="symbol">:endup_time</span>, <span class="symbol">:avatar</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>要新增檔案可以用：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">food.avatar.attach(params[<span class="symbol">:avatar</span>])</span><br></pre></td></tr></table></figure>

<p>若要確定是否有附加檔案的話，可以用：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">food.avatar.attached?</span><br><span class="line"></span><br><span class="line"><span class="comment"># 回傳boolean值</span></span><br></pre></td></tr></table></figure>

<h2 id="一個食物多個檔案"><a href="#一個食物多個檔案" class="headerlink" title="一個食物多個檔案"></a>一個食物多個檔案</h2><p>差異其實只有兩個：</p>
<p>改成has_many_attached</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#food.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> &lt; ApplicationRecord</span></span><br><span class="line"> <span class="comment">#has_one_attached :avatar</span></span><br><span class="line">  has_many_attached <span class="symbol">:avatars</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>改成陣列型式avatars:[]</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clean_params</span></span></span><br><span class="line">  params.<span class="keyword">require</span>(<span class="symbol">:food</span>).permit(<span class="symbol">:title</span>, <span class="symbol">:address</span>, <span class="symbol">:phone</span>, <span class="symbol">:quantity</span>, <span class="symbol">:origin_price</span>, <span class="symbol">:discount_price</span>, <span class="symbol">:pickup_time</span>, <span class="symbol">:picture</span>, <span class="symbol">:description</span>, <span class="symbol">:endup_time</span>, <span class="symbol">avatars:</span>[])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>關於“新增檔案”及“確定是否有附加檔案”的方式是一樣的，只是記得avatar要用複數形式(avatars)</p>
<p>附加完檔案了，如果是照片的話要如何顯示呢？</p>
<h2 id="mini-magick"><a href="#mini-magick" class="headerlink" title="mini_magick"></a>mini_magick</h2><p>在Rails的 Gemfile 其實有內建一個套件 mini_magick，若要做圖片顯示的效果，可以把註解拿掉 bundle 後就可以用了。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#Gemfile</span><br><span class="line"># Use ActiveStorage variant</span><br><span class="line">gem &apos;mini_magick&apos;, &apos;~&gt; 4.8&apos;</span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">&lt;%= image_tag food.avatar.variant(<span class="symbol">resize:</span> <span class="string">'300x300'</span>), <span class="keyword">if</span> food.avatar.attached?%&gt;</span><br></pre></td></tr></table></figure>

<p><code>variant</code>方法是用來改變上傳的圖片尺寸<br><code>if food.avatar.attached?</code> 有附加檔案的話就印出圖片。</p>
<p>如果沒有加上這個判斷的話，今天頁面的某個檔案若剛好沒有附加檔案，就會噴錯，原因是“<code>food.avatar</code>是<code>nil</code>，不能對<code>nil</code>做<code>variant</code>方法”。</p>
<p>參考資料：</p>
<p><a href="https://guides.rubyonrails.org/active_storage_overview.html#attaching-files-to-records" target="_blank" rel="noopener">Rails Guides - Active Storage Overview</a><br><a href="https://5xruby.tw/posts/active-storage-review/" target="_blank" rel="noopener">Active Storage 開箱文</a><br><a href="https://pjchender.github.io/2018/05/25/rails-active-storage-overview/" target="_blank" rel="noopener">[Rails] Active Storage Overview</a></p>
<blockquote>
<p>“Don’t worry about failure; you only have to be right once.”</p>
<p>— Drew Houston, Entrepreneur</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day28: 用個Github來版本控制吧 </title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2028/</url>
    <content><![CDATA[<p>之前都在寫Rails相關的內容，其實版本控制也是重要的一環，就來換個口味寫個GitHub吧～</p>
<p>登入GitHub後第一步</p>
<p><img src="https://i.imgur.com/ftmo3TA.png" alt=""></p>
<p>加號點開後，請點選紅框 <code>New repository</code> 新增專案</p>
<p><img src="https://i.imgur.com/d1apkB8.png" alt=""></p>
<p>輸入自訂的檔名，依照你想要公開(Public)或私人(Private)去選擇後，按下方 <code>Create repository</code></p>
<p><img src="https://i.imgur.com/SC05mA2.png" alt=""></p>
<p>選擇透過 HTTPS / SSH 的方式來上傳檔案</p>
<blockquote>
<p>HTTPS是加密網站，使用上囉嗦(每次都要輸入帳密)但設定上簡單。<br>SSH則是公鑰跟私鑰，但這設定上要key一些指令，這不是此次討論的範圍，有興趣請點<a href="https://git-scm.com/book/zh-tw/v1/%E4%BC%BA%E6%9C%8D%E5%99%A8%E4%B8%8A%E7%9A%84-Git-%E7%94%9F%E6%88%90-SSH-%E5%85%AC%E9%96%8B%E9%87%91%E9%91%B0" target="_blank" rel="noopener">這裡</a>設定。</p>
</blockquote>
<p>Create a new repository 顧名思義就是直接產生一個新的專案，而 Push an exisiting repository 意思是與直接本地端的專案做版控，此次我們選擇後者。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/LouiswuYJ/testing.git</span><br><span class="line">     遠端   新增 代名詞                   位置</span><br><span class="line">-&gt; 將本地端的git版本整包與GitHub上連結</span><br><span class="line"></span><br><span class="line">git push -u origin master</span><br><span class="line">             代名詞  分支</span><br><span class="line">-&gt; 新增一個代名詞節點，這裡的-u 代表設定上線(upstream)，把自己本地端的分支(master)推到網站上，且u設定一次之後，orign 就已經變成預設值，所以以後只要git push 即可。</span><br><span class="line"></span><br><span class="line">git remote -v</span><br><span class="line">-&gt;查看remote狀況</span><br></pre></td></tr></table></figure>

<p>再開始之前，先隨便找一個有git版控的檔案，若沒有的話再建一個就好。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">開終端機到指定資料夾後:</span><br><span class="line">git init    -&gt; 初始化</span><br><span class="line">touch 檔案  -&gt;新增檔案</span><br><span class="line">git add .  -&gt;將全部檔案 add</span><br><span class="line">git commit -m &quot;自訂&quot; -&gt;commit後產生第一個分支</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/5Ryj38E.png" alt=""></p>
<p>本地端我先設2個(commit)節點後，下上述兩個指令後就會與GitHub上做連結。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git remote add origin https://github.com/LouiswuYJ/testing.git</span><br><span class="line">$ git push -u origin master</span><br><span class="line">Enumerating objects: 5, done.</span><br><span class="line">Counting objects: 100% (5/5), done.</span><br><span class="line">Delta compression using up to 4 threads</span><br><span class="line">Compressing objects: 100% (3/3), done.</span><br><span class="line">Writing objects: 100% (5/5), 407 bytes | 135.00 KiB/s, done.</span><br><span class="line">Total 5 (delta 0), reused 0 (delta 0)</span><br><span class="line">To https://github.com/LouiswuYJ/testing.git</span><br><span class="line">* [new branch]      master -&gt; master</span><br><span class="line">Branch &apos;master&apos; set up to track remote branch &apos;master&apos; from &apos;origin&apos;.</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/3v9qw0k.png" alt=""></p>
<h2 id="git-push-從本地推上遠端"><a href="#git-push-從本地推上遠端" class="headerlink" title="git push (從本地推上遠端)"></a>git push (從本地推上遠端)</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git push origin master</span><br><span class="line">git push -f</span><br><span class="line">直接檔案蓋掉全部，建議要用之前最好先告知你的其他團隊成員，不然就...</span><br></pre></td></tr></table></figure>

<p>新增了檔案03.html並commit後push到Github，本地端的 master 分支，推上GitHub origin 這個遠端節點，並且在遠端形成一個 master 分支，原本GitHub上的2個commit就變3個了。</p>
<p><img src="https://i.imgur.com/mVaySeB.png" alt=""></p>
<p><img src="https://i.imgur.com/CwI0e7O.png" alt=""></p>
<h2 id="git-fetch-從遠端抓下來"><a href="#git-fetch-從遠端抓下來" class="headerlink" title="git fetch (從遠端抓下來)"></a>git fetch (從遠端抓下來)</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git fetch origin master</span><br></pre></td></tr></table></figure>

<p>去 origin 這個遠端節點，抓上面 master 分支的內容，並且在我的電腦上建立一個 origin/master 分支，但並不會merge。<br>(白話文:把檔案抓過來，但不會主動合併)<br>情境1: 新增一個檔案後儲存commit變4個，此時用 fetch 後本地就會如下圖所示。</p>
<p><img src="https://i.imgur.com/GqT3TDL.png" alt=""></p>
<p>情境2:<br>這邊看到一個origin/master的節點(fetch抓下來)</p>
<p><img src="https://i.imgur.com/yxvAI9g.png" alt=""></p>
<p>這時候去merge，就會變這樣</p>
<p><img src="https://i.imgur.com/7HMQusr.png" alt=""></p>
<h2 id="git-pull-git-fetch-git-merge"><a href="#git-pull-git-fetch-git-merge" class="headerlink" title="git pull = git fetch + git merge"></a>git pull = git fetch + git merge</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git pull origin master</span><br></pre></td></tr></table></figure>

<p>去 origin 這個遠端節點，去抓上面 master 分支的內容，並且在電腦上建立一個 origin/master 分支，同時與我本機的 master 分支進行合併<br>白話文: git pull 就是 fetch後再merge的結果。</p>
<h2 id="git-clone-Git網址"><a href="#git-clone-Git網址" class="headerlink" title="git clone + Git網址"></a>git clone + Git網址</h2><p>把某個 Git 專案，整包檔案完整複製到自己電腦。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git clone 網址</span><br></pre></td></tr></table></figure>

<h2 id="共同合作"><a href="#共同合作" class="headerlink" title="共同合作"></a>共同合作</h2><p>在團隊分工若遇到不能push的時候，可能你團隊的某個人已經先commit過後push上去了，此時可以先pull到自己的檔案後再push上去就可以解決，但如果每次都要先拉再推，會不會顯得有點麻煩?</p>
<h2 id="PR-Pull-Request"><a href="#PR-Pull-Request" class="headerlink" title="PR = Pull Request"></a>PR = Pull Request</h2><p>如果想幫忙做別人的專案時，=&gt;fork先複製一份到自己的帳號，改好了之後，再發送pull請求給原作者，這個簡易的過程就是大家耳熟能詳的”發PR”。</p>
<blockquote>
<p>“If I fail, I try again, and again, and again. If you fail, are you going to try again? The human spirit can handle much worse than we realize. It matters how you are going to finish.”</p>
<p>— Nick Vujicic, Motivational Speaker</p>
</blockquote>
]]></content>
      <categories>
        <category>Git</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Git</tag>
        <tag>GitHub</tag>
      </tags>
  </entry>
  <entry>
    <title>Day27: Rails關心你的胖Model - concern</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2027/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/2zmCaE9.png" alt=""></p>
<p>在controller寫方法時，若常常需要用到某個方法，我們會將方法直接寫在Model或上層的<code>application_controller.rb</code>來取用。</p>
<p>已正在進行的專案為例，每個User有一台購物車，除了devise給我們現有的<code>current_user</code>之外，我想在寫個<code>current_cart</code>給每個controller用，此時就可以把定義<code>current_cart</code>的方法寫在<code>application_controller.rb</code>。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">ApplicationController</span> &lt; ActionController::Base</span></span><br><span class="line"></span><br><span class="line">  private</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current_cart</span></span></span><br><span class="line">    @current_cart <span class="params">||</span>= Cart.find_or_create_by(<span class="symbol">user:</span> current_user)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>但有時候並不是每個controller或Model都需要用到這個方法，尤其是把所有要用的方法寫在該類別的Model，會導致Model越來越肥，controller越來越瘦。</p>
<h2 id="有需要的時候再拿進來"><a href="#有需要的時候再拿進來" class="headerlink" title="有需要的時候再拿進來"></a>有需要的時候再拿進來</h2><p>為了解決這個問題，rails在models下有個資料夾名稱<code>concerns</code>，把定義方法寫在這，在該controller有需要的時候再引入使用就好。</p>
<p>新增一個檔案 usercart.rb</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Usercart</span></span></span><br><span class="line">  extend ActiveSupport::Concern</span><br><span class="line"></span><br><span class="line">  included <span class="keyword">do</span></span><br><span class="line">    has_one <span class="symbol">:cart</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">module</span> <span class="title">ClassMethods</span></span></span><br><span class="line">    <span class="function"><span class="keyword">def</span> <span class="title">search</span><span class="params">(search)</span></span></span><br><span class="line">      <span class="keyword">if</span> search</span><br><span class="line">        where([<span class="string">'title || description || address LIKE ?'</span>, <span class="string">"%<span class="subst">#&#123;search&#125;</span>%"</span>])</span><br><span class="line">      <span class="keyword">else</span></span><br><span class="line">        all</span><br><span class="line">      <span class="keyword">end</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  private</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current_cart</span></span></span><br><span class="line">    @current_cart <span class="params">||</span>= Cart.find_or_create_by(<span class="symbol">user:</span> current_user)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p><code>included do ...end</code> 當這個module被include到Model時會做的事：(一對一)有一台購物車<br><code>ClassMethod</code> 在這裡定義的方法被include時會變成類別方法：可以直接針對該Model做搜尋的方法。<br><code>current_cart</code> 被include之後會變成該類別的實體方法：如果有找到車就用這台，沒有車就生一台給user。</p>
<p>此時在User的Model加入：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line">    <span class="keyword">include</span> Usercart</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>就可以擁有在concern資料夾下內 usercart.rb 裡的方法可以用了，相對的如果你在其他的Model也想要用的話，再直接include進該Model就好。</p>
<p>參考資料：<br><a href="https://stackoverflow.com/questions/14541823/how-to-use-concerns-in-rails-4" target="_blank" rel="noopener">How to use concerns in Rails 4</a><br><a href="https://railsbook.tw/chapters/25-organize-your-code.html" target="_blank" rel="noopener">Rails 程式碼整理術（入門）</a></p>
<blockquote>
<p>“Live today. Not yesterday. Not tomorrow. Inhabit your moments. Don’t rent them out to tomorrow.”</p>
<p>– Jerry Spinelli, Writer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day26: Rails中的view_helper</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2026/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/xvFLI1W.png" alt=""></p>
<p>在寫view時，常常會因為過多的邏輯判斷，導致整個view的程式碼非常冗長且難以維護，其實view只是將處理好的資料呈現出來而已，不應該把複雜的邏輯寫在view裡面，此時我們就可以用到helper來解決。</p>
<h2 id="View拿不到controller裡的方法"><a href="#View拿不到controller裡的方法" class="headerlink" title="View拿不到controller裡的方法"></a>View拿不到controller裡的方法</h2><p>一般在rails裡，view拿不到controller裡的方法，只能拿到對應的action的實體變數，這時候我們就需要用到helper來將方法寫給view使用。</p>
<p>helper的目的是要寫一段ruby code 協助整理資訊，並且可以做兩件事：</p>
<ol>
<li>在view頁面使用時就可直接使用</li>
<li>也可 include 至 controller使用</li>
</ol>
<blockquote>
<p>簡單來說，只要寫在helper裡的方法，view與comtroller都可以取用。</p>
</blockquote>
<p>最近寫專案有寫到購物車，每一個使用者擁有一台車，如果在每次想要撈使用者購物車的資料都要 <code>current_user.cart</code> 的方法去找感覺很麻煩，何不就自己寫個 <code>current_cart</code> 呢？</p>
<p>解決方式有兩個：</p>
<ol>
<li>直接寫在helper</li>
<li>方法寫在controller輸出給helper</li>
</ol>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#_navbar.html.erb</span><br><span class="line">#加入</span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> "購物車(#&#123;<span class="attr">current_cart.items.count</span>&#125;)", "#" %&gt;</span></span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/1ONJ9F8.png" alt=""></p>
<p>噴出找不到方法 <code>current_cart</code>，因為還沒寫嘛！</p>
<h2 id="直接寫在helper"><a href="#直接寫在helper" class="headerlink" title="直接寫在helper"></a>直接寫在helper</h2><h3 id="讓view取得helper方法"><a href="#讓view取得helper方法" class="headerlink" title="讓view取得helper方法"></a>讓view取得helper方法</h3><p>在寫helper之前，要先注意命名的對應，檔名如果是products_helper.rb，則檔案內的 module 後就得寫 ProductsHelper，跟 controller 的命名對應規則是一樣的。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#app/helpers/products_helper.rb</span></span><br><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">ProductsHelper</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current_cart</span></span></span><br><span class="line">    @cart = @cart <span class="params">||</span> Cart.from_hash(session[<span class="symbol">:cart123</span>])</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>如果有車就用這台車，如果沒車就給他一台名叫 <code>cart123</code>的車並存在session，此時的 <code>product.html.erb</code> 就可以使用 <code>current_cart</code> 了。</p>
<p>如果也想讓controller用</p>
<h3 id="讓controller取得helper方法"><a href="#讓controller取得helper方法" class="headerlink" title="讓controller取得helper方法"></a>讓controller取得helper方法</h3><p>畢竟剛剛寫的helper是個模組，直接 include 進來就好了。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#products_controller.rb</span></span><br><span class="line"><span class="keyword">include</span> ProductsHelper</span><br></pre></td></tr></table></figure>

<h2 id="方法寫在controller輸出給helper"><a href="#方法寫在controller輸出給helper" class="headerlink" title="方法寫在controller輸出給helper"></a>方法寫在controller輸出給helper</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#products_controller.rb</span></span><br><span class="line">helper_method <span class="symbol">:current_cart</span></span><br><span class="line"><span class="comment">#方法寫在這</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current_cart</span></span></span><br><span class="line">    @cart = @cart <span class="params">||</span> Cart.from_hash(session[<span class="symbol">:cart123</span>])</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>在controller加入 <code>helper_method :current_cart</code> 就可以使helper擁有這個方法，當然view也可以一起使用了。</p>
<p>但如果將方法寫在controller，只有在特定 controller 可以用，如果要全部的controller都可用的話，可貼在最上層的controller：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#application_controller.rb</span></span><br><span class="line">helper_method <span class="symbol">:current_cart</span></span><br><span class="line"><span class="comment">#方法寫在這</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">current_cart</span></span></span><br><span class="line">    @cart = @cart <span class="params">||</span> Cart.from_hash(session[<span class="symbol">:cart123</span>])</span><br><span class="line">  <span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<h2 id="那我該用哪個方式？"><a href="#那我該用哪個方式？" class="headerlink" title="那我該用哪個方式？"></a>那我該用哪個方式？</h2><p>這兩種方式都是在讓views拿到controller裡面的方法，至於要選擇哪種方法的判斷標準：<br><strong>Contorller 用得多就寫在 Contorller，view 用得多就寫在 view</strong>。</p>
<p>參考資料：<br><a href="https://railsbook.tw/chapters/15-layout-render-and-view-helper.html" target="_blank" rel="noopener">Layout, Render 與 View Helper</a></p>
<blockquote>
<p>“When you find your path, you must not be afraid. You need to have sufficient courage to make mistakes.”</p>
<p>– Paulo Coelho, Novelist</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day25: Rails中的一球冰淇淋 scope</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2025/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/wjqS1Dq.png" alt=""></p>
<p>這個標題、這個圖片，難道是要講什麼吃冰淇淋的感言分享嗎？</p>
<p>但這真的是我第一次接觸這個名詞腦袋中第一個浮現的畫面XD<br>可能字真的太像了吧(還是只有我這樣覺得？)</p>
<p><img src="https://i.imgur.com/xctRRHl.png" alt=""></p>
<p>看來對我來說，不止中文字有這個問題，好像連英文單字都是…</p>
<p>scope, scoop傻傻分不清楚(誤)</p>
<h1 id="Scope"><a href="#Scope" class="headerlink" title="Scope"></a>Scope</h1><p>最近做專案常常發現，在撈資料的時候，常常一直點find點where一直點下去，但有發現有時候在同一個controller時，都在對特定Model做同一件事情，在Rails常常可以看到一個字<strong>DRY</strong>:</p>
<blockquote>
<p>Don’t Repeat Yourself</p>
</blockquote>
<p>為了能夠讓程式碼變得乾淨易讀且方便使用，我們就可以在該controller的Model寫<code>scope</code>。</p>
<p>也許你會說，可一個一個寫也沒什麼不好啊？</p>
<p>但如果今天需求變更(例如：原本出全部的資料改為撈價格小於100的資料)，那不就全站都需要跟著修改？非常不方便，所以這時候我們就需要用到<code>scope</code>。</p>
<p>先來看個簡單的例子：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#foods_controller.rb</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  @foods = Food.order(<span class="symbol">create_at:</span> <span class="symbol">:desc</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>撈出所有Food Model的物件並依照建立時間排序，這時候如果要寫成scope來使用，就可以在Model寫：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#food.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> &lt; ApplicationRecord</span></span><br><span class="line">  scope <span class="symbol">:show_all</span>, -&gt; &#123; order(<span class="symbol">create_at:</span> <span class="symbol">:desc</span>) &#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>這時候的controller就可以這要取用：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#foods_controller.rb</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  @foods = Food.show_all</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>如果後面的其他action也要做一樣的事情，就只要在Model名稱(此例為Food)後面加你寫 scope 的方法名稱就可以了。</p>
<h3 id="小補充："><a href="#小補充：" class="headerlink" title="小補充："></a>小補充：</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#food.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> &lt; ApplicationRecord</span></span><br><span class="line">  <span class="comment">#寫法一</span></span><br><span class="line">  scope <span class="symbol">:show_all</span>, -&gt; &#123; order(<span class="symbol">create_at:</span> <span class="symbol">:desc</span>) &#125;</span><br><span class="line"></span><br><span class="line">  <span class="comment">#寫法二</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">show_all</span></span></span><br><span class="line">    order(<span class="symbol">create_at:</span> <span class="symbol">:desc</span>)</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>寫法一與寫法二的效果是相同的，至於何時該用哪個，其實就是看個人偏好了，我自己的感覺，如果是條件簡單的話就用scope寫，如果是條件較複雜的話就用類別方法寫。</p>
<h2 id="如果想帶參數"><a href="#如果想帶參數" class="headerlink" title="如果想帶參數"></a>如果想帶參數</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#food.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> &lt; ApplicationRecord</span></span><br><span class="line">  scope <span class="symbol">:cheap_price</span>, -&gt;(price) &#123; where(<span class="string">"price &lt; ?"</span>, price)&#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>這時候controller就可以拿來用：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#foods_controller.rb</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  @foods = Food.cheap_price(price)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="scope本身可以帶入scope-串接"><a href="#scope本身可以帶入scope-串接" class="headerlink" title="scope本身可以帶入scope(串接)"></a>scope本身可以帶入scope(串接)</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#food.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Food</span> &lt; ApplicationRecord</span></span><br><span class="line">  scope <span class="symbol">:show_all</span>, -&gt; &#123; order(<span class="symbol">create_at:</span> <span class="symbol">:desc</span>).cheap_price(<span class="number">100</span>) &#125;</span><br><span class="line">  scope <span class="symbol">:cheap_price</span>, -&gt;(price) &#123; where(<span class="string">"price &lt; ?"</span>, price)&#125;</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#foods_controller.rb</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  @foods = Food.show_price(price)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>這樣的寫法就可以撈出價格小於 price 且按照建立時間排序了。</p>
<p>參考資料：<br><a href="https://rails.ruby.tw/active_record_querying.html#%E4%BD%9C%E7%94%A8%E5%9F%9F" target="_blank" rel="noopener">Rails Guide</a><br><a href="https://mgleon08.github.io/blog/2015/12/20/ruby-on-rails-scopes/" target="_blank" rel="noopener">Ruby on Rails - Scopes</a><br><a href="https://railsbook.tw/chapters/16-model-basic.html#scope-and-class-method" target="_blank" rel="noopener">為你自己學Ruby on Rails</a></p>
<blockquote>
<p>“Every challenge, every adversity, contains within it the seeds of opportunity and growth.”</p>
<p>– Roy Bennett, Politician</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day24: Rails中的find? find_by? where?</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2024/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/ZInCbYJ.png" alt=""></p>
<p>在rails中有多種方法可以去查詢我們要的record，今天就來分別探討最常見的三種方法。</p>
<h2 id="find"><a href="#find" class="headerlink" title="find"></a>find</h2><p>找出單一筆資料，且只能透過id去搜尋。</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line"><span class="comment">#找出id為1的購物車</span></span><br><span class="line">Cart.find(1)</span><br></pre></td></tr></table></figure>
<p>對應的SQL:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Cart Load (0.4ms)  SELECT  <span class="string">"carts"</span>.* FROM <span class="string">"carts"</span> WHERE <span class="string">"carts"</span>.<span class="string">"id"</span> = <span class="variable">$1</span> LIMIT <span class="variable">$2</span>  [[<span class="string">"id"</span>, 1], [<span class="string">"LIMIT"</span>, 1]]</span><br></pre></td></tr></table></figure>

<p>如果查詢不到該筆資料，就會回傳一個<code>ActiveRecord::RecordNotFound</code>的例外訊息，還記得之前的文章有提過例外處理的方法嗎？</p>
<p>這時候就可以用<code>begin..rescue</code>來捕捉：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">find_cart</span></span></span><br><span class="line">   <span class="keyword">begin</span></span><br><span class="line">     @cart = Cart.find(params[<span class="symbol">:id</span>])</span><br><span class="line">   <span class="keyword">rescue</span></span><br><span class="line">     redirect_to carts_path, <span class="symbol">notice:</span> <span class="string">"沒有這台購物車喔"</span></span><br><span class="line">   <span class="keyword">end</span></span><br><span class="line"> <span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>如果找不到cart的話，就會直接執行rescue下的程式碼。</p>
<p>若要找多筆資料又堅持用find，find()裡面還可以塞陣列：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">products = Product.find([2, 5])      <span class="comment"># 等同於 Client.find(2, 5)</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#找id是2跟id是5的product</span></span><br></pre></td></tr></table></figure>
<h2 id="find-by"><a href="#find-by" class="headerlink" title="find_by"></a>find_by</h2><p>找出單一筆資料，且可以透過自訂條件去搜尋。</p>
<p><img src="https://i.imgur.com/1KOYaOX.png" alt=""></p>
<p>找出id為5的食物:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Food.find_by(id: 5)</span><br><span class="line"></span><br><span class="line"><span class="comment">#等同於Food.find(5)</span></span><br></pre></td></tr></table></figure>
<p>對應的SQL:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Food Load (0.4ms)  SELECT  <span class="string">"foods"</span>.* FROM <span class="string">"foods"</span> WHERE <span class="string">"foods"</span>.<span class="string">"id"</span> = <span class="variable">$1</span> LIMIT <span class="variable">$2</span>  [[<span class="string">"id"</span>, 5], [<span class="string">"LIMIT"</span>, 1]]</span><br></pre></td></tr></table></figure>


<p>找id是2的使用者擁有的食物：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Food.find_by(user_id: 2)</span><br></pre></td></tr></table></figure>
<p>對應的SQL:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Food Load (0.2ms)  SELECT  <span class="string">"foods"</span>.* FROM <span class="string">"foods"</span> WHERE <span class="string">"foods"</span>.<span class="string">"user_id"</span> = <span class="variable">$1</span> LIMIT <span class="variable">$2</span>  [[<span class="string">"user_id"</span>, 2], [<span class="string">"LIMIT"</span>, 1]]</span><br></pre></td></tr></table></figure>

<p>這裡可以注意的是，如果找不到該筆資料的話，<code>find_by</code>方法會回傳的值是<code>nil</code>而不是例外訊息。</p>
<p><img src="https://i.imgur.com/190Aeer.png" alt=""></p>
<p>若使用find_by方法撈資料但還是想要有回傳<code>ActiveRecord::RecordNotFound</code>，可以在find_by後面加個驚嘆號<code>!</code></p>
<p><img src="https://i.imgur.com/jDBnzwK.png" alt=""></p>
<p>就可以看到回傳的值不是<code>nil</code>而是可以捕捉的例外訊息了。</p>
<h2 id="where"><a href="#where" class="headerlink" title="where"></a>where</h2><p>找出多筆資料，且可以透過自訂條件去搜尋，即代表了 SQL 語法 WHERE 的部分。</p>
<p>條件可以是<strong>字串</strong>、<strong>陣列</strong>、或是 <strong>Hash</strong>。</p>
<h3 id="陣列"><a href="#陣列" class="headerlink" title="陣列"></a>陣列</h3><p>如果我們要找的 orders_count 不是固定的值，則帶入變數<code>params[:orders]</code>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Client.where(<span class="string">"orders_count = ?"</span>, params[:orders])</span><br></pre></td></tr></table></figure>

<p>根據Rails API文件：</p>
<blockquote>
<p>直接將變數插入條件字串裡，不論變數是什麼，都會直接存到資料庫裡。這表示從惡意使用者傳來的變數，會直接存到資料庫。這麼做是把資料庫放在風險裡不管啊！一旦有人知道，可以隨意將任何字串插入資料庫裡，就可以做任何想做的事。</p>
</blockquote>
<h3 id="絕對不要直接將變數插入條件字串裡。"><a href="#絕對不要直接將變數插入條件字串裡。" class="headerlink" title="絕對不要直接將變數插入條件字串裡。"></a>絕對不要直接將變數插入條件字串裡。</h3><h3 id="Hash"><a href="#Hash" class="headerlink" title="Hash"></a>Hash</h3><p>找id是2的使用者全部擁有的食物：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Food.where(user_id: 10)</span><br></pre></td></tr></table></figure>

<p>對應的SQL:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">Food Load (0.4ms)  SELECT <span class="string">"foods"</span>.* FROM <span class="string">"foods"</span> WHERE <span class="string">"foods"</span>.<span class="string">"user_id"</span> = <span class="variable">$1</span>  [[<span class="string">"user_id"</span>, 10]]</span><br></pre></td></tr></table></figure>

<p>若找不到該筆資料，則會回傳<code>#&lt;ActiveRecord::Relation []&gt;</code>。</p>
<p>參考資料：<br><a href="http://justineyeah-blog.logdown.com/posts/1814190-jd-store-find-find-by-where-in-rails" target="_blank" rel="noopener">JD store find/find_by/where in Rails</a><br><a href="https://rails.ruby.tw/active_record_querying.html" target="_blank" rel="noopener">Active Record 查詢</a><br><a href="https://pjchender.github.io/2018/02/25/rails-active-record-query%EF%BC%88model-%E8%B3%87%E6%96%99%E6%9F%A5%E8%A9%A2%EF%BC%89/" target="_blank" rel="noopener">[Rails] Active Record Query（SQL Query）</a><br><a href="https://railsbook.tw/chapters/16-model-basic.html" target="_blank" rel="noopener">Model 基本操作</a></p>
<blockquote>
<p>“Most of our obstacles would melt away if instead of cowering before them we should make up our minds to walk boldly through them.”</p>
<p>— Orison Marden, Writer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day23: Rails中的N+1問題</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2023/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/x2SP56l.png" alt=""></p>
<p>Rails要建立關聯非常簡單(one-to-one, one-to-many)，但也是這個原因，造成在資料庫查詢的時候浪費許多記憶體，大部分的 ORM 預設使用 lazy-loading，一筆資料的查詢就會產生一筆 query，拖累了資料庫的效能。因此將預設的 lazy-loading 改成 Eager-loading 就可以解決N+1問題。</p>
<p>其中 Eager-loading在 rails 提供了4種方式：</p>
<ul>
<li>preload</li>
<li>eagerload</li>
<li>includes</li>
<li>joins</li>
</ul>
<p>這篇就拿最常見的inclundes及joins來討論。</p>
<p>我們先建立兩個Model分別為<code>user.rb</code>及<code>product.rb</code>且為一對多關係：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#user.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">User</span> &lt; ApplicationRecord</span></span><br><span class="line">  has_many <span class="symbol">:products</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#product.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> &lt; ApplicationRecord</span></span><br><span class="line">  belongs_to <span class="symbol">:user</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>controller先將所有的Pdoduct撈出：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#products_controller.rb</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  @products = Product.all</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>再一筆一筆印出來：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="comment">&lt;!-- index.erb.html --&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> @<span class="attr">products.each</span> <span class="attr">do</span> |<span class="attr">product</span>| %&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%=</span> <span class="attr">product.user.name</span>%&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%=</span> <span class="attr">product.title</span>%&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">%=</span> <span class="attr">product.price</span>%&gt;</span></span><br><span class="line">    ....</span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>
<p>乍看之下好像很合理，如果說只有一筆product要查這樣寫沒問題，但一個網站怎麼可能只有一筆資料？</p>
<p>若今天要找出product的擁有者、名字及價錢有10筆。在迭代每筆資料時，一邊呼叫 query 來從 Prdoduct 資料表中取資料，就會產生 10 + 1 次 query，其中後面的 1 指的是 User資料數量。</p>
<p>資料的存取是rails的弱項，所以在設計時能夠避免 N+1問題就避免，將資料存取相關的事交給擅長的資料庫就好。</p>
<h2 id="includes"><a href="#includes" class="headerlink" title="includes"></a>includes</h2><p>拿上面例子來看，會產生 10+1筆的資料存取，我們可以用includes的方式將所有資料在資料第一次存取時就“一次查完“因此在controller的部份我們可以這樣寫：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#products_controller.rb</span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  @products = Product.includes(<span class="symbol">:user</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>再 query 的部分就只會查詢2筆了。</p>
<h2 id="joins與includes的差別"><a href="#joins與includes的差別" class="headerlink" title="joins與includes的差別"></a>joins與includes的差別</h2><p>:joins 使用 SQL 的 INNER JOIN 方法，不會真的把關聯的資料取出來。如果只是想要篩選結果，或是觀察關聯物件的某些屬性質，那麼使用 :joins 是最有效率的。不過有一點要注意，如果你想要做的事是存取關聯物件本身，那麼 :joins 還是會造成 N+1 問題。</p>
<p>主要差別在於：</p>
<ol>
<li>join主要用於過濾model之間的關係，但對查詢筆數來說並無太大幫助</li>
<li>include主要用於將大量資料在同一筆查詢內一次查好</li>
</ol>
<p>參考資料：</p>
<p>部分內容擷取自以下連結<br><a href="https://blog.bigbinary.com/2013/07/01/preload-vs-eager-load-vs-joins-vs-includes.html" target="_blank" rel="noopener">Preload, Eagerload, Includes and Joins</a><br><a href="https://ithelp.ithome.com.tw/articles/10161667" target="_blank" rel="noopener">Rails使用include和join避免 N+1 queries</a><br><a href="https://medium.com/@jinghua.shih/rails-activerecord-%E6%95%88%E8%83%BD%E5%84%AA%E5%8C%96-%E4%B8%8A-%E9%97%9C%E8%81%AF%E6%9F%A5%E8%A9%A2-75ca79f510b3" target="_blank" rel="noopener">[Rails] N+1 Queries Problem</a><br><a href="https://rails.ruby.tw/active_record_querying.html" target="_blank" rel="noopener">Rails API</a></p>
<blockquote>
<p>“Tests are a gift. And great tests are a great gift. To fail the test is a misfortune. But to refuse the test is to refuse the gift, and something worse, more &gt;irrevocable, than misfortune.”</p>
<p>– Lois McMaster Bujold, writer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day22: 簡易Rails實作(下)</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2022/</url>
    <content><![CDATA[<p>上次講到了Strong Parameters，今天我們就從Flash開始吧！</p>
<h2 id="快閃訊息flash"><a href="#快閃訊息flash" class="headerlink" title="快閃訊息flash"></a>快閃訊息flash</h2><p><img src="https://i.imgur.com/tjW0Pjy.png" alt=""></p>
<p>在按下按鈕後，應該要有個訊息出現告知使用者是否有成功或失敗，並且只出現一次，這就是快閃訊息做的事。<br>在這個專案，我們希望如果 create 成功，會將網頁導向 首頁 並印出 “新增候選人成功!!”，反之若失敗，則印出”新增候選人失敗!!” (一樣false還沒寫入)</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#上略</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create</span></span></span><br><span class="line">    clean_params = params.<span class="keyword">require</span>(<span class="symbol">:candidate</span>).permit(<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:policy</span>, <span class="symbol">:party</span>)</span><br><span class="line">    @candidate = Candidate.new(clean_params)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> @candidate.save</span><br><span class="line">      flash[<span class="symbol">:notice</span>] = <span class="string">"新增候選人成功!!"</span>         <span class="comment">#第7~8行可直接寫成 redirect_to root_path, notice: "新增候選人成功!!"</span></span><br><span class="line">      redirect_to root_path</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      flash[<span class="symbol">:notice</span>] = <span class="string">"新增候選人失敗!!"</span>         <span class="comment">#第10~11行可直接寫成 redirect_to root_path, notice: "新增候選人失敗!!"</span></span><br><span class="line">      redirect_to root_path</span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#並在index.html.erb檔加入</span></span><br><span class="line"></span><br><span class="line">&lt;%= flash[<span class="symbol">:notice</span>] %&gt;   印出<span class="string">"新增候選人成功!"</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/59ON3bS.png" alt=""></p>
<h2 id="首頁印出候選人列表"><a href="#首頁印出候選人列表" class="headerlink" title="首頁印出候選人列表"></a>首頁印出候選人列表</h2><p>想要在首頁做事情，那當然是去 <code>index</code> 做事，首先針對 candidate_controller.rb 裡的 index method寫入:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">@candidates = Candidate.all</span><br><span class="line"></span><br><span class="line">注意<span class="symbol">:</span>這裡的實體變數故意列為<span class="string">"複數"</span>，因為是撈出全部候選人的資料</span><br></pre></td></tr></table></figure>

<p>去抓所有使用者輸入的資料。<br>再來到 <code>index.html.erb</code> 利用each迴圈印出所有候選人的”姓名”。</p>
<p><img src="https://i.imgur.com/dzMqxuK.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">flash</span>[<span class="attr">:notice</span>] %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>首頁:候選人列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"># <span class="tag">&lt;<span class="name">%%</span>&gt;</span>不顯示在頁面</span><br><span class="line">#<span class="tag">&lt;<span class="name">=%%</span>&gt;</span>要顯示在頁面上</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> @<span class="attr">candidates.each</span> <span class="attr">do</span> |<span class="attr">candidate</span>| %&gt;</span>     #注意是@candidate"s"</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">candidate.name</span> %&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> '新增候選人', <span class="attr">new_candidate_path</span>, <span class="attr">class:</span> '<span class="attr">btn</span> <span class="attr">btn-danger</span> <span class="attr">btn-lg</span>' %&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="驗證資料"><a href="#驗證資料" class="headerlink" title="驗證資料"></a>驗證資料</h2><p>人打字總偶爾有肥手指、眼睛業障或看錯欄位的狀況發生，所以每個輸入的資料都需要做進一步的認證才能進入資料庫。</p>
<p>(總不可能候選人只有3歲吧!!!?)</p>
<p>還記得剛剛寫的 <code>if else</code> 判斷總是忽略 <code>false</code> 的話怎麼辦對吧? 如果不寫入以下程式碼的話，永遠不會進入到 <code>else</code> 的判斷，到 candidate.rb 裡新增:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Candidate</span> &lt; ApplicationRecord</span></span><br><span class="line">  validates <span class="symbol">:name</span>, <span class="symbol">presence:</span> <span class="literal">true</span></span><br><span class="line">  <span class="comment">#腦補眼鏡</span></span><br><span class="line">  <span class="comment">#validates (:name, &#123;presence: true&#125;)</span></span><br><span class="line"></span><br><span class="line">  validates <span class="symbol">:age</span>, <span class="symbol">numericality:</span> &#123; <span class="symbol">greater_than_or_equal_to:</span> <span class="number">40</span> &#125;</span><br><span class="line">  <span class="comment">#腦補眼鏡</span></span><br><span class="line">  <span class="comment">#validates (:age, &#123;numericality: &#123; &#123;greater_than_or_equal_to: 40&#125; &#125;&#125;)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>姓名欄位: 有資料才會會回傳true ; 年紀欄位: 必須大於或等於40歲<br>其實我們再 <code>create</code> 中的 <code>if else</code> 判斷式寫的較不人性化，若今天使用者打錯某字跳出”新增候選人失敗!!”，回到新增頁面後竟然還要重新打字，是不是太麻煩了? 所以我們要修正<code>else</code>後的輸出方式:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandidatesController</span> &lt; ApplicationController</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">    @candidate = Candidate.all</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new</span></span></span><br><span class="line">    @candidate = Candidate.new</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create</span></span></span><br><span class="line">    clean_params = params.<span class="keyword">require</span>(<span class="symbol">:candidate</span>).permit(<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:policy</span>, <span class="symbol">:party</span>)</span><br><span class="line">    @candidate = Candidate.new(clean_params)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> @candidate.save</span><br><span class="line">      flash[<span class="symbol">:notice</span>] = <span class="string">"新增候選人成功!"</span></span><br><span class="line">      redirect_to root_path</span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="comment">#原來寫法:flash[:notice] = "新增候選人失敗!"</span></span><br><span class="line">      <span class="comment">#原來寫法:redirect_to root_path</span></span><br><span class="line">      render <span class="symbol">:new</span>  <span class="comment"># 借new.html.erb這個檔案，並不是上方的new方法!!!</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>就解決了如果打錯字回到頁面後文字被洗掉的問題。</p>
<h2 id="哪裡輸入錯誤"><a href="#哪裡輸入錯誤" class="headerlink" title="哪裡輸入錯誤?"></a>哪裡輸入錯誤?</h2><p>若輸入錯誤的話，總要告訴使用者是哪裡輸入錯誤吧?<br>new.html.erb內新增判斷式，就會印出Rails內建的<code>full_messages</code>資料庫訊息:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>新增候選人<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> @<span class="attr">candidate.errors.any</span>? %&gt;</span>   #.errors.any? =&gt;有錯誤嗎?</span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> @<span class="attr">candidate.errors.full_messages.each</span> <span class="attr">do</span> |<span class="attr">message</span>| %&gt;</span> # .full_messages =&gt; Rails內建的錯誤訊息資料庫</span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">message</span> %&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span>(@<span class="attr">candidate</span>) <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">#下略....</span><br></pre></td></tr></table></figure>

<h2 id="查看候選人詳細資料"><a href="#查看候選人詳細資料" class="headerlink" title="查看候選人詳細資料"></a>查看候選人詳細資料</h2><p>當然在看候選人的時候不可能只看名字吧?所以我們要做一個只要點選候選人姓名，就轉至候選人資料的頁面。<br>index.html.erb頁面:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#index.html.erb</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">flash</span>[<span class="attr">:notice</span>] %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>首頁:候選人列表<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="comment">&lt;!--</span></span><br><span class="line"><span class="comment">&lt;ul&gt;</span></span><br><span class="line"><span class="comment">  &lt;% @candidate.each do |candidate| %&gt;</span></span><br><span class="line"><span class="comment">    &lt;li&gt;&lt;%= candidate.name %&gt;&lt;/li&gt;</span></span><br><span class="line"><span class="comment">  &lt;% end %&gt;</span></span><br><span class="line"><span class="comment">&lt;/ul&gt; --&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> @<span class="attr">candidate.each</span> <span class="attr">do</span> |<span class="attr">candidate</span>| %&gt;</span></span><br><span class="line">    <span class="comment">&lt;!--路徑需查 rails routes --&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> <span class="attr">candidate.name</span>, <span class="attr">candidate_path</span>(<span class="attr">candidate.id</span>) %&gt;</span><span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> '新增候選人', <span class="attr">new_candidate_path</span>, <span class="attr">class:</span> '<span class="attr">btn</span> <span class="attr">btn-danger</span> <span class="attr">btn-lg</span>' %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/RzaZytg.png" alt=""></p>
<p>就會是可以點選的狀態了，能夠預期若按下候選人姓名會發生什麼事嗎?</p>
<p><img src="https://i.imgur.com/ca6Ldn5.png" alt=""></p>
<p>因為我們還沒有建立在 show 方法:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">show</span></span></span><br><span class="line">    @candidate = Candidate.find_by(<span class="symbol">id:</span> params[<span class="symbol">:id</span>])</span><br><span class="line">    <span class="comment">#Candidate.find_by =&gt; Rails內建尋找相對應資料的方法</span></span><br><span class="line">    <span class="comment">#腦補眼鏡(&#123;id: params[:id]&#125;)</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>({id: params[:id]}) :取<code>params</code>內key是<code>:id</code>的value當作外面<code>id:</code>的value<br>聽起來很像繞口令，讓我們一步一步拆開來看。</p>
<p>params本身是Hash的資料型態，也就是上面有敘述過的一大串資料:</p>
<blockquote>
<p>{“utf8”=&gt;”✓”, “authenticity_token”=&gt;”0OHbZ7WkDs8NsrNHK2s7Dd9BxkITn/qegeFtUcMmE5ANKKiaxmRCOiPuChEAoKh4ho/taDYBB7GvIhTG0a1IHw==”, “candidate”=&gt;{“name”=&gt;”Louis”, “party”=&gt;”none”, “age”=&gt;”20”, “policy”=&gt;”Rails is Good”}, “commit”=&gt;”Create Candidate”, “controller”=&gt;”candidates”, “action”=&gt;”create”}</p>
</blockquote>
<p>上面有講過個例子，若我要拿到Louis，我需要寫<code>params[&#39;candidate&#39;][&#39;name&#39;]</code> 才能拿到對吧?</p>
<blockquote>
<p>params[‘candidate’][‘name’]<br>            ↓　　　　　↓<br>      ({   id:     　params[:id]})</p>
</blockquote>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">假設 params = &#123; <span class="symbol">id:</span> <span class="number">5</span>, <span class="symbol">email:</span> <span class="string">'kk@5xruby.tw'</span>, <span class="symbol">name:</span> <span class="string">'Louis'</span> &#125;</span><br><span class="line">find_by(<span class="symbol">id:</span> params[<span class="symbol">:id</span>], <span class="symbol">email:</span> params[<span class="symbol">:email</span>], <span class="symbol">name:</span> params[<span class="symbol">:name</span>])</span><br><span class="line">find_by(        <span class="number">5</span>      ,      kk@5xruby.tw    ,     Louis          )</span><br><span class="line"></span><br><span class="line">這樣可以找到在候選人表格裡「id 是 <span class="number">5</span>，而且 email 是 kk@5xruby.tw，而且 name 是 Louis」的候選人</span><br></pre></td></tr></table></figure>

<p>這樣對應著看，應該有比較容易理解吧!!</p>
<p>但還是會出現錯誤(笑</p>
<p><img src="https://i.imgur.com/JVlrNje.png" alt=""></p>
<p>記得也要在views建立 show.html.erb</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">if</span> @<span class="attr">candidate</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span><span class="tag">&lt;<span class="name">%=</span> @<span class="attr">candidate.name</span> %&gt;</span><span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>黨派: <span class="tag">&lt;<span class="name">%=</span> @<span class="attr">candidate.party</span>%&gt;</span> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>年紀: <span class="tag">&lt;<span class="name">%=</span> @<span class="attr">candidate.age</span>%&gt;</span> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span>政見: <span class="tag">&lt;<span class="name">%=</span> @<span class="attr">candidate.policy</span>%&gt;</span> <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">else</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">h1</span>&gt;</span>沒有這個人<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/Tlc2w1n.png" alt=""></p>
<p>就終於完成了簡易CRUD中的C跟R…</p>
<h5 id="腦細胞少10-，皺褶增加0-001"><a href="#腦細胞少10-，皺褶增加0-001" class="headerlink" title="腦細胞少10%，皺褶增加0.001%"></a>腦細胞少10%，皺褶增加0.001%</h5><p>參考資料：</p>
<p><a href="https://railsbook.tw/chapters/13-crud-part-1.html" target="_blank" rel="noopener">為你自己學Ruby on Rails</a></p>
<blockquote>
<p>“The difference in winning and losing is most often…not quitting.”</p>
<p>— Walt Disney, Producer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day21: 簡易Rails實作(中)</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2021/</url>
    <content><![CDATA[<p>上次透過簡單首頁、分頁製作了第一個rails專案，了解到其中MVC的運作原理及routes與controller之間的關聯性，這次我們將延續上次的內容添加一些功能，並透過CRUD 中（Create、 Read、 Update、 Delete）C跟R的流程來建立專案，U和D的部分就暫時有機會的時候再說明了，現在就來做做看吧！</p>
<h2 id="新增候選人至表單"><a href="#新增候選人至表單" class="headerlink" title="新增候選人至表單"></a>新增候選人至表單</h2><p>在new.html.erb檔案中，我們需要一個表單讓使用者輸入，輸入後把資料丟到我們想要去的地方，先來建立表單吧!</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>新增候選人<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/candidates"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> '回首頁', <span class="attr">candidates_path</span>, <span class="attr">class:</span> '<span class="attr">btn</span> <span class="attr">btn-primary</span> <span class="attr">btn-lg</span>'%&gt;</span></span><br></pre></td></tr></table></figure>

<p>其中我們可以看到第3行的action指的是我們要將資料丟去哪裡，method則是丟出去的方法。</p>
<p>(在終端機執行rails routes)</p>
<p><img src="https://i.imgur.com/MKCMMBr.png" alt=""></p>
<p>使用者填完表單並按送出後，會將資料丟去</p>
<p><code>candidates POST / candidates(.:format) candidates#create</code>:<br>對<code>candidates(.:format)</code> 這個地方丟資料去<code>candidates#create</code>的時候，需要用 <code>post</code> 方法。<br>此例我們要丟去的位置是<code>create</code>，且要用<code>post</code>的方式丟出，所以可以看到第3行 <code>action=&quot;/candidate&quot; method=&quot;post&quot;</code> 的部分才要用<code>post</code>而不是<code>get</code>。</p>
<p>此時的畫面長這樣:</p>
<p><img src="https://i.imgur.com/i42vAtb.png" alt=""></p>
<p>這時候如果我們隨便輸入東西並按下提交，會出現下圖:</p>
<p><img src="https://i.imgur.com/O13Fhec.png" alt=""></p>
<p>還記得上次的步驟嗎?<br>我們在controller根本還沒有給他方法，那它缺什麼，我們就給他什麼吧，回到 <code>candidates_controller.rb</code></p>
<p><img src="https://i.imgur.com/xIFti8G.png" alt=""></p>
<p>接下來應該大功告成了吧~至少應該可以按下提交後不會跳出錯誤了(灑花</p>
<h3 id="BUT"><a href="#BUT" class="headerlink" title="BUT!!!!"></a>BUT!!!!</h3><p>人生就是有無限的BUT….</p>
<h2 id="Rails-的預設防護"><a href="#Rails-的預設防護" class="headerlink" title="Rails 的預設防護"></a>Rails 的預設防護</h2><p><img src="https://i.imgur.com/zWZTyXs.png" alt=""></p>
<p>照上次的經驗來看，應該是只要新增方法就至少不會跳出錯誤了，但這裡為何會出錯呢?</p>
<p>原來是在rails裡面為了保護資料庫的安全，有個預設防護的機至給擋下來了。</p>
<blockquote>
<p>什麼是<a href="https://codertw.com/%E7%A8%8B%E5%BC%8F%E8%AA%9E%E8%A8%80/586268/" target="_blank" rel="noopener">Token?</a></p>
<p>生活情境:</p>
<p>小菜走在士林夜市，買了一杯位在”門口”的60嵐的珍奶並拿了20號號碼牌，想說要等，就先進去走走晃晃，看到前方剛好有一家位在”轉角”的60嵐!!!天真的小菜異想天開，想說反正都是60嵐直接拿號碼牌去領也可以吧!? 好懶得走回去喔…</p>
<p>跳到20號了!!!</p>
<p>店員: 呃(os:又來個知日 阝章)….你這個號碼牌不是我們店的喔，所以不能給你珍奶。</p>
<p>小菜難過的走在路上….<a href="https://www.google.com/search?rlz=1C1CHWL_zh-TWAU820AU820&biw=1280&bih=578&ei=JT1hXYrBGMLUsAfw0rnoAg&q=%E5%BE%9E%E5%89%8D%E6%9C%89%E4%B8%80%E5%80%8B%E4%BA%BA%E5%8F%AB%E5%B0%8F%E8%8F%9C%E4%BB%96%E8%B5%B0%E5%9C%A8%E8%B7%AF%E4%B8%8A+%E5%B0%B1%E8%A2%AB%E7%AB%AF%E8%B5%B0%E4%BA%86+&oq=%E5%BE%9E%E5%89%8D%E6%9C%89%E4%B8%80%E5%80%8B%E4%BA%BA%E5%8F%AB%E5%B0%8F%E8%8F%9C%E4%BB%96%E8%B5%B0%E5%9C%A8%E8%B7%AF%E4%B8%8A+%E5%B0%B1%E8%A2%AB%E7%AB%AF%E8%B5%B0%E4%BA%86+&gs_l=psy-ab.3...8402.8520..8793...0.0..0.316.316.3-1......0....1..gws-wiz.8xP0THHsmEY&ved=0ahUKEwjK54_6z5vkAhVCKuwKHXBpDi0Q4dUDCAo&uact=5" target="_blank" rel="noopener">就被端走了</a></p>
</blockquote>
<p>token有點像在做這件事，你手上的號碼牌顯示的店面，必須要跟領取的店面相同，才能夠拿到珍奶(我們要的結果)。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>新增候選人<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/candidates"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"username"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"&lt;%= form_authenticity_token %&gt;"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> '回首頁', <span class="attr">candidates_path</span>, <span class="attr">class:</span> '<span class="attr">btn</span> <span class="attr">btn-primary</span> <span class="attr">btn-lg</span>'%&gt;</span></span><br></pre></td></tr></table></figure>

<p>我們在 <code>new.html.erb</code> 檔案新增第5行，到開發者工具來檢視一下token:</p>
<p><img src="https://i.imgur.com/rewhljc.png" alt=""></p>
<p>紅色框線value的部分就是token的值，且每次重新整理都會更新一次。</p>
<p>這樣一來，按下提交後就不會噴錯誤訊息囉，可是不覺得每次要做個送出資料的欄位就要打這一串很麻煩嗎?</p>
<p>可以用上次介紹的 <code>form_for</code> 就可以省略複雜的那一行了，且rails會根據你在views的哪個檔案，自動幫你在button( <code>&lt;%= form.submit %&gt;</code>)中加入文字。(ex: Updated Candidate, Edit Candidate…)</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span>(物件) <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line"></span><br><span class="line">   資料打在這裡</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<h1 id="在Model建立表單"><a href="#在Model建立表單" class="headerlink" title="在Model建立表單"></a>在Model建立表單</h1><p>Rails有個方式可以使 <code>form_for</code> 表單綁在Model上，在終端機輸入:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rails generate model Candidate name:string party:string age:<span class="built_in">integer</span> policy:text</span><br><span class="line"></span><br><span class="line">or 簡單一點的寫法 (預設就是string)</span><br><span class="line"></span><br><span class="line">rails g model Candidate name party age:<span class="built_in">integer</span> policy:text</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/QA21ghY.png" alt=""></p>
<p><img src="https://i.imgur.com/4QUmpeQ.png" alt=""></p>
<p><img src="https://i.imgur.com/woHTHG0.png" alt=""></p>
<p>新增了兩個檔案:</p>
<p>models下的<code>candidates.rb</code> 及 db&gt;migrate&gt;<code>*********_create_candidates.rb</code></p>
<p>其中在<code>*********_create_candidates.rb</code>會建立name(型態:string)、party(型態:string)、age(型態:integer)、policy(型態:text)，後面的timestamp(created_at, updated_at)其實是內建的，用來紀錄提交時的時間點。</p>
<p>(備註: Rails在資料庫建立資料表的時候，會帶一個預設的隱藏ID的欄位，且在上面不會顯示，如果不想要ID欄位的話可以再下指令去除。)</p>
<p>到了這個步驟，其實並不是真正的建立表單了，我們只是告訴它，我有這個要建立表單的”計畫”，所以還需要在終端機輸入:</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rails db:migrate</span><br></pre></td></tr></table></figure>

<p>才是告知”請按照這個計畫執行”。</p>
<p>如果此時再 rails db:migrate一次，並不會發生任何事，因為已經建立好了就辦法再更改，如果要更改已建立的檔案只有兩種方式:</p>
<p>建立一個新的表單並”存檔”後，再rails db:migrate一次。<br>rails db:rollback， 但請盡量少用，除非非常確定，否則用了rollback後沒辦法再回復。</p>
<p>之後再開schema.rb就可以確認是否是你要的結果了。</p>
<p><img src="https://i.imgur.com/BN2jfxg.png" alt=""></p>
<h1 id="完成表單"><a href="#完成表單" class="headerlink" title="完成表單"></a>完成表單</h1><p>接著在 new.html.erb 透過 form_for將表單完成後如下:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">h1</span>&gt;</span>新增候選人<span class="tag">&lt;/<span class="name">h1</span>&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span>(<span class="attr">Candidate.new</span>) <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"box"</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"candidate_field"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.label</span> <span class="attr">:name</span>, '姓名' %&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:name</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"candidate_field"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.label</span> <span class="attr">:party</span>, '黨派' %&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:party</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"candidate_field"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.label</span> <span class="attr">:age</span>, '年紀' %&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:age</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">div</span> <span class="attr">class</span>=<span class="string">"candidate_field"</span>&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.label</span> <span class="attr">:policy</span>, '政策' %&gt;</span></span><br><span class="line">      <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_area</span> <span class="attr">:policy</span> %&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"></span><br><span class="line">    <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">div</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">link_to</span> '回首頁', <span class="attr">candidates_path</span>, <span class="attr">class:</span> '<span class="attr">btn</span> <span class="attr">btn-primary</span> <span class="attr">btn-lg</span>'%&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/cLLYl0L.png" alt=""></p>
<p>其中的 <code>Candidate.new</code> 是從Models裡的 <code>candidate.rb</code> 來的，但html.erb檔盡量用來做”印出內容”的事情就好，故我們不會希望在這裡用<code>Candidate.new</code> 來產生方法。</p>
<p><img src="https://i.imgur.com/VozvSvB.png" alt=""></p>
<p>在 <code>candidates_controller.rb</code> 裡的new method建立一個實體變數 <code>@candidate</code> ，接著寫入至 <code>new.html.erb</code> 裡面取代原來的<code>Candidate.new</code> 。</p>
<h2 id="新增候選人資料"><a href="#新增候選人資料" class="headerlink" title="新增候選人資料"></a>新增候選人資料</h2><p>此時按下create並不會產生任何事情，因為在controller裡的create method沒有寫任何東西，寫入下列程式至<code>create</code>:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandidatesController</span> &lt; ApplicationController</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new</span></span></span><br><span class="line">    @candidate = Candidate.new</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create</span></span></span><br><span class="line">    render <span class="symbol">html:</span> params</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>來看看 <code>html: params</code> 印出的內容</p>
<blockquote>
<p>{“utf8”=&gt;”✓”, “authenticity_token”=&gt;”0OHbZ7WkDs8NsrNHK2s7Dd9BxkITn/qegeFtUcMmE5ANKKiaxmRCOiPuChEAoKh4ho/taDYBB7GvIhTG0a1IHw==”, “candidate”=&gt;{“name”=&gt;”Louis”, “party”=&gt;”none”, “age”=&gt;”20”, “policy”=&gt;”Rails is Good”}, “commit”=&gt;”Create Candidate”, “controller”=&gt;”candidates”, “action”=&gt;”create”}</p>
</blockquote>
<p>剛剛輸入的資料就這樣全部已hash的方式印出來了，假設我們今天要取”name”裡面的value，我們可以這樣做:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">render <span class="symbol">html:</span>params[<span class="string">"candidate"</span>]</span><br><span class="line">印出 &#123;<span class="string">"name"</span>=&gt;<span class="string">"Louis"</span>, <span class="string">"party"</span>=&gt;<span class="string">""</span>, <span class="string">"age"</span>=&gt;<span class="string">""</span>, <span class="string">"policy"</span>=&gt;<span class="string">""</span>&#125;</span><br><span class="line"></span><br><span class="line">render <span class="symbol">html:</span>params[<span class="string">"candidate"</span>][<span class="string">"name"</span>]</span><br><span class="line">印出 Louis</span><br></pre></td></tr></table></figure>

<h2 id="寫入資料庫"><a href="#寫入資料庫" class="headerlink" title="寫入資料庫"></a>寫入資料庫</h2><p><code>create</code> 的方法中可以用@candidate.save 來儲存使用者輸入的資料。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandidatesController</span> &lt; ApplicationController</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new</span></span></span><br><span class="line">    @candidate = Candidate.new</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create</span></span></span><br><span class="line">    <span class="comment">#params["candidate"]印出的是&#123;"name"=&gt;"Louis", "party"=&gt;"", "age"=&gt;"", "policy"=&gt;""&#125;</span></span><br><span class="line">    @candidate = Candidate.new(params[<span class="string">"candidate"</span>])</span><br><span class="line">    <span class="keyword">if</span> @candidate.save</span><br><span class="line">      render <span class="symbol">html:</span> <span class="string">'ok'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      <span class="comment">#render html: 'error'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>如果儲存成功，印出ok，因為還沒寫入false的條件，故先暫時不管。</p>
<p>輸入資料按下create之後，就出現錯誤了…..</p>
<p><img src="https://i.imgur.com/WShpXd6.png" alt=""></p>
<h2 id="Rails的另一個預設防護-Strong-Parameters"><a href="#Rails的另一個預設防護-Strong-Parameters" class="headerlink" title="Rails的另一個預設防護: Strong Parameters"></a>Rails的另一個預設防護: Strong Parameters</h2><p>為了避免有心人士在填資料時，偷塞參數或惡搞資料庫，造成安全問題，所以在使用者輸入資料要進資料庫的同時，利用permit來過濾並設定那些資料是可以進資料庫哪些不行。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">CandidatesController</span> &lt; ApplicationController</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">index</span></span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">new</span></span></span><br><span class="line">    @candidate = Candidate.new</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">create</span></span></span><br><span class="line">    clean_params = params.<span class="keyword">require</span>(<span class="symbol">:candidate</span>).permit(<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:policy</span>, <span class="symbol">:party</span>)</span><br><span class="line">    @candidate = Candidate.new(clean_params)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">if</span> @candidate.save</span><br><span class="line">      render <span class="symbol">html:</span> <span class="string">'ok'</span></span><br><span class="line">    <span class="keyword">else</span></span><br><span class="line">      render <span class="symbol">html:</span> <span class="string">'error'</span></span><br><span class="line">    <span class="keyword">end</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">clean_params = params.<span class="keyword">require</span>(<span class="symbol">:candidate</span>).permit(<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:policy</span>, <span class="symbol">:party</span>)</span><br><span class="line"></span><br><span class="line">params.<span class="keyword">require</span>(<span class="symbol">:candidate</span>) =&gt; 就是找到<span class="string">"candidate"</span>=&gt;&#123;<span class="string">"name"</span>=&gt;<span class="string">"Louis"</span>, <span class="string">"party"</span>=&gt;<span class="string">"none"</span>, <span class="string">"age"</span>=&gt;<span class="string">"20"</span>, <span class="string">"policy"</span>=&gt;<span class="string">"Rails is Good"</span>&#125;, <span class="string">"commit"</span>=&gt;<span class="string">"Create Candidate"</span>, <span class="string">"controller"</span>=&gt;<span class="string">"candidates"</span>, <span class="string">"action"</span>=&gt;<span class="string">"create"</span>&#125;</span><br><span class="line"></span><br><span class="line">.permit(<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:policy</span>, <span class="symbol">:party</span>) =&gt; 允許<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:policy</span>, <span class="symbol">:party</span> 輸入的參數可以進入資料庫</span><br></pre></td></tr></table></figure>

<p>就可以正常執行了。(印出ok)</p>
<hr>
<p>礙於篇幅….好像只能先講到這，我們明天再繼續了。</p>
<p>參考資料：</p>
<p><a href="https://railsbook.tw/chapters/12-controllers.html" target="_blank" rel="noopener">為你自己學Ruby on Rails</a></p>
<blockquote>
<p>“Flaming enthusiasm, backed up by horse sense and persistence, is the quality that most frequently makes for success.”</p>
<p>— Dale Carnegie, Motivational Expert</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day20: 簡易Rails實作(上)</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2020/</url>
    <content><![CDATA[<p>在開始之前，要先知道用Rails的慣例，並且盡量遵守才不會造成後面要接手的人的困擾。尤其是以下說明需特別注意：</p>
<blockquote>
<p>在檔案區命名：snakecase     ex: candidate_controller<br>在檔案內命名：camelcase     ex: CandidateController<br>且“檔案名稱”與“類別名稱”必須相同，才不會在執行的時候出現error</p>
</blockquote>
<h2 id="什麼是MVC-Model、View、Controller"><a href="#什麼是MVC-Model、View、Controller" class="headerlink" title="什麼是MVC(Model、View、Controller)?"></a>什麼是MVC(Model、View、Controller)?</h2><p>在開始建立Rails之前，我們需要先了解<a href="https://railsbook.tw/chapters/10-mvc.html" target="_blank" rel="noopener">什麼是MVC</a></p>
<p>MVC架構：由Route開始，到Controller結束。</p>
<ol>
<li>瀏覽器依據資源(resources)的設定，經由Route去找到Controller中，對應的action(method)。</li>
<li>視需要透過Model向資料庫取得資料後，處理完再與對應的View(.html.erb)做結合。</li>
<li>View處理完後再回傳給Controller，Controller再將結果轉交給瀏覽器。</li>
</ol>
<h2 id="建立Rails專案"><a href="#建立Rails專案" class="headerlink" title="建立Rails專案"></a>建立Rails專案</h2><p>在Terminal輸入，就會自動產生rails專案。（前提是要先安裝好Rails）</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rails new 專案名稱</span><br></pre></td></tr></table></figure>
<p>在這次的例子，我們試著產生一個名叫myvote的Rails檔案。</p>
<h3 id="routes-rb"><a href="#routes-rb" class="headerlink" title="routes.rb"></a>routes.rb</h3><p>在Vscode開啟資料夾，用command+P尋找檔案“routes.rb”，並寫入：</p>
<ol>
<li>Rails 提供的 resources</li>
<li>根目錄(首頁) candidates，且裡面有個方法index</li>
</ol>
<p><img src="https://i.imgur.com/Pmy0rCh.png" alt=""></p>
<p>第2行：產生8種條路徑</p>
<p><img src="https://i.imgur.com/xuSCyik.png" alt=""></p>
<p>第3行：根目錄裡有個方法index</p>
<p>備註：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">root <span class="string">'candidates#index'</span></span><br><span class="line">get <span class="string">'/'</span>, to <span class="string">'candidates#index'</span></span><br><span class="line"><span class="comment">#因為是根目錄，以上兩種寫法都可以接受。</span></span><br></pre></td></tr></table></figure>

<p>在此時在Terminal執行Rails：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rails server 或 rails s</span><br></pre></td></tr></table></figure>

<p>至網址輸入localhost:3000(Terminal會寫3000)出現以下畫面:</p>
<p><img src="https://i.imgur.com/qqJ4rG8.png" alt=""></p>
<p>找不到method，故要建立一個給它。</p>
<h2 id="建立Method"><a href="#建立Method" class="headerlink" title="建立Method"></a>建立Method</h2><p>在app &gt; controllers中新增檔案 “檔名_controller.rb” (此例檔名為candidates，需與你要連結的檔案名稱一樣)，並建立class 、繼承最原始的檔案“ApplicationController”：（其實此例的def index暫時不寫也沒關係）</p>
<p><img src="https://i.imgur.com/W6ty2NU.png" alt=""></p>
<p>但這樣還不夠，因為Rails的遊戲規則是要從views裡面找檔案，所以必須還要再 views 資料夾新增一個candidates資料夾，並建立 index.html.erb：</p>
<p><img src="https://i.imgur.com/vev7ekj.png" alt=""></p>
<p>才能印出：</p>
<p><img src="https://i.imgur.com/0rQWk3A.png" alt=""></p>
<p>基本上這樣就完成最最最基礎的第一步了(此例index裡沒寫東西只是因為要當範例而已，請原諒我沒放東西(跪)）</p>
<h2 id="讓他稍微可以動"><a href="#讓他稍微可以動" class="headerlink" title="讓他稍微可以動"></a>讓他稍微可以動</h2><p>在index.html.erb加點東西：</p>
<p><img src="https://i.imgur.com/4wcbTUc.png" alt=""></p>
<blockquote>
<p>Prefix :new_cadidates</p>
</blockquote>
<p>還記得剛剛的rails routes嗎？其中的new功能Rails已經有幫我們定義好的Prefix名字了</p>
<p><img src="https://i.imgur.com/0tz8JhD.png" alt=""></p>
<p>_path:產生相對應的路徑網址（站內路徑）-&gt; ／candidates</p>
<p>*另一種方式：</p>
<p>＿url:產生完整網址 -&gt; <a href="https://www.xxxx.com/candidates，在寄發mail的時候較常使用" target="_blank" rel="noopener">https://www.xxxx.com/candidates，在寄發mail的時候較常使用</a>)</p>
<p>套用Bootstrap，套用方式可見<a href="https://medium.com/@louiswu0327/%E5%9C%A8rails%E8%A3%9Dboostrap%E5%A5%97%E4%BB%B6-fcb742a10376" target="_blank" rel="noopener">這篇</a>。</p>
<h2 id="等等！！！views裡沒有new這個檔案啊！！？"><a href="#等等！！！views裡沒有new這個檔案啊！！？" class="headerlink" title="等等！！！views裡沒有new這個檔案啊！！？"></a>等等！！！views裡沒有new這個檔案啊！！？</h2><p>所以要記得在views &gt; candidates 裡再新增一個new.html.erb檔</p>
<p><img src="https://i.imgur.com/tFtIi8s.png" alt=""></p>
<p>這樣一來就可以有作用囉!!</p>
<p><img src="https://i.imgur.com/qhJJPAH.png" alt=""></p>
<p><img src="https://i.imgur.com/jmE6M2W.png" alt=""></p>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><p>Rails這只是第一步而已，雖然現在有很多指令可以快速產出以上步驟做出的東西(scaffold)，但畢竟在使用套件之前，能夠先了解如何手刻及其背後觀念跟原理是非常重要的。</p>
<p>也許文章內容寫的不正確也缺乏系統，也或許幾年後回來看自己寫的這篇文章會覺得”WTF這什麼鬼!!?”</p>
<p>參考資料：<br><a href="https://railsbook.tw/chapters/11-routes.html#restful-routes" target="_blank" rel="noopener">為你自己學 Ruby on Rails</a></p>
<blockquote>
<p>“The pro is the person who has all the hassles, obstacles, and disappointing frustrations that everyone else has, yet continues to persist, does the job, and makes it look easy.”</p>
<p>— David Cooper, Sales Trainer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day19: Rails中神奇的spring stop</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2019/</url>
    <content><![CDATA[<h4 id="您有遇過rails-g-migration時卡住嗎？"><a href="#您有遇過rails-g-migration時卡住嗎？" class="headerlink" title="您有遇過rails g migration時卡住嗎？"></a>您有遇過rails g migration時卡住嗎？</h4><h4 id="您有rails-sever打不開的問題嗎？"><a href="#您有rails-sever打不開的問題嗎？" class="headerlink" title="您有rails sever打不開的問題嗎？"></a>您有rails sever打不開的問題嗎？</h4><p><del>trivago</del></p>
<p>意外的查到的資料不多，所以這篇僅擷取Rails <a href="https://github.com/rails/spring/blob/master/README.md" target="_blank" rel="noopener">REARDME.md</a>來簡單翻譯一下。</p>
<h2 id="spring-stop"><a href="#spring-stop" class="headerlink" title="spring stop"></a>spring stop</h2><p>常常在跑rail時，都會遇到一些很奇怪的狀況導致migration, rails sever, rails db:seed等跑不出來這狀況，但只要下了<code>spring stop</code>通常就解了？</p>
<p>Rails在4.1版本後新增了<code>srping stop</code>功能，來看看rails guide寫什麼：</p>
<blockquote>
<p>Spring 會預加載你的 Rails 應用程式。保持應用程式在背景執行，如此一來在執行 Rails 命令時：如跑測試、rake、migrate 時，不用每次都重啟 Rails 應用程式，加速你的開發流程。</p>
</blockquote>
<p>簡單來說就是應用程式預加載器，就像加速器一樣的概念。</p>
<h2 id="spring-stop的特性"><a href="#spring-stop的特性" class="headerlink" title="spring stop的特性"></a>spring stop的特性</h2><ol>
<li>在背景自動執行，只開啟終端機並進入rails資料夾就會自動執行</li>
<li>每次執行時重新載入你的rails專案中的code</li>
<li>當config、initializer、gem dependencies有更新時重新啟動</li>
</ol>
<h2 id="spring-stop的運行"><a href="#spring-stop的運行" class="headerlink" title="spring stop的運行"></a>spring stop的運行</h2><p>建立一個新的Rails專案並執行<code>rails generate scaffold post name:string</code></p>
<p>打開終端機測試一下</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ time bin/rake <span class="built_in">test</span> <span class="built_in">test</span>/controllers/posts_controller_test.rb</span><br><span class="line">Running via Spring preloader <span class="keyword">in</span> process 2734</span><br><span class="line">Run options:</span><br><span class="line"></span><br><span class="line"><span class="comment"># Running tests:</span></span><br><span class="line"></span><br><span class="line">.......</span><br><span class="line"></span><br><span class="line">Finished tests <span class="keyword">in</span> 0.127245s, 55.0121 tests/s, 78.5887 assertions/s.</span><br><span class="line"></span><br><span class="line">7 tests, 10 assertions, 0 failures, 0 errors, 0 skips</span><br><span class="line"></span><br><span class="line">real    0m2.165s</span><br><span class="line">user    0m0.281s</span><br><span class="line">sys     0m0.066s</span><br></pre></td></tr></table></figure>

<p>跑的速度不算特別快，因為是第一次執行這個專案，所以花的時間會比較長</p>
<p>來看一下spring的狀態：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ bin/spring status</span><br><span class="line">Spring is running:</span><br><span class="line"></span><br><span class="line">26150 spring server | spring-demo-app | started 3 secs ago</span><br><span class="line">26155 spring app    | spring-demo-app | started 3 secs ago | <span class="built_in">test</span> mode</span><br></pre></td></tr></table></figure>

<p>再跑一次就可以發現速度快很多：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ time bin/rake <span class="built_in">test</span> <span class="built_in">test</span>/controllers/posts_controller_test.rb</span><br><span class="line">Running via Spring preloader <span class="keyword">in</span> process 8352</span><br><span class="line">Run options:</span><br><span class="line"></span><br><span class="line"><span class="comment"># Running tests:</span></span><br><span class="line"></span><br><span class="line">.......</span><br><span class="line"></span><br><span class="line">Finished tests <span class="keyword">in</span> 0.176896s, 39.5714 tests/s, 56.5305 assertions/s.</span><br><span class="line"></span><br><span class="line">7 tests, 10 assertions, 0 failures, 0 errors, 0 skips</span><br><span class="line"></span><br><span class="line">real    0m0.610s</span><br><span class="line">user    0m0.276s</span><br><span class="line">sys     0m0.059s</span><br></pre></td></tr></table></figure>

<p>在coding時做的變更，會根據你在更新哪個檔案去判別是否要重新啟動後台。</p>
<p>舉例來說當我們修改application file或是test file時，相關的變更會再下一次執行時變更，你只需要重新刷瀏覽器，但後台系統不必重新啟動。</p>
<p>但當如果我們修改啟動應用程式所需的檔案，例如：configs, initializers, gemfile時，則後台需要重新啟動應用程式，而且會自動執行。</p>
<p>例如編輯<code>config/application.rb</code>：</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">$ touch config/application.rb</span><br><span class="line">$ bin/spring status</span><br><span class="line">Spring is running:</span><br><span class="line"></span><br><span class="line">26150 spring server | spring-demo-app | started 36 secs ago</span><br><span class="line">26556 spring app    | spring-demo-app | started 1 sec ago | <span class="built_in">test</span> mode</span><br></pre></td></tr></table></figure>

<p>spring會偵測到config底下有檔案被更新後，就會自動啟動。</p>
<hr>
<p>也許是spring的關係，所以常常會將我們不需要的東西先預載入到後台，導致我們在執行migration, rails s等會發生問題，所以才會需要下<code>spring stop</code>來終止預先載入的行為。</p>
<p>這只是我的推測…如果有錯的話歡迎指正。</p>
<p>參考資料：</p>
<p><a href="https://github.com/rails/spring/blob/master/README.md" target="_blank" rel="noopener">Rails/spring/REARDME.md</a><br><a href="https://rails.ruby.tw/4_1_release_notes.html#%E6%87%89%E7%94%A8%E7%A8%8B%E5%BC%8F%E9%A0%90%E5%8A%A0%E8%BC%89%E5%99%A8%EF%BC%9Aspring" target="_blank" rel="noopener">Ruby on Rails 4.1 發佈記</a></p>
<blockquote>
<p>“If you really want something, you have to be prepared to work very hard, take advantage of opportunity, and above all never give up.”</p>
<p>— Jane Goodall, Ethologist</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day18: 淺談Rails的表單: form_with</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2018/</url>
    <content><![CDATA[<blockquote>
<p>form內 <strong>有</strong> model實體時，用<code>form_for</code>，主要用於新增或修改。</p>
<p>form內 <strong>無</strong> model實體時，用<code>form_tag</code>，主要用於登入一筆資料。</p>
<p>Rails 5.1後，將兩者結合為<code>form_with</code></p>
</blockquote>
<p>上次提到了<code>form_tag</code>及<code>form_for</code>，在Rails 5.1之後結合為<code>form_with</code>，代表<code>form_with</code>結合了兩種form的特性，不論有無Model都可以使用。</p>
<h2 id="使用form-with製作表格"><a href="#使用form-with製作表格" class="headerlink" title="使用form_with製作表格"></a>使用form_with製作表格</h2><h3 id="製作對象有Model時："><a href="#製作對象有Model時：" class="headerlink" title="製作對象有Model時："></a>製作對象有Model時：</h3><p><img src="https://i.imgur.com/HtUBFGQ.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">model:</span> @<span class="attr">product</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p>產出的html:</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">data-remote</span>=<span class="string">"true"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"zzGYG0KNdBU0pPfzO7QDBAWUkDcPE9czey2zv21TwaXXf5T01neGV4Hp2YwZJRUJ2doDyOrnm9ZH74Ql6Ky9Mg=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"product[title]"</span> <span class="attr">id</span>=<span class="string">"product_title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Create Product"</span> <span class="attr">data-disable-with</span>=<span class="string">"Create Product"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h3 id="製作對象沒有Model時："><a href="#製作對象沒有Model時：" class="headerlink" title="製作對象沒有Model時："></a>製作對象沒有Model時：</h3><p><img src="https://i.imgur.com/hxLiPHw.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">url:</span> <span class="attr">new_product_path</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p>產出的html</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"> <span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products/new"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">data-remote</span>=<span class="string">"true"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"ZlLlHMOezGqsuZrFgovtKbph3uYPFcZuZbHyi1V6YEJ+HOnzV2Q+KBn0tLqgGvskZi9NGerhiotZc8UR0IUc1Q=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"title"</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Save "</span> <span class="attr">data-disable-with</span>=<span class="string">"Save "</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>兩種方式產出的東西幾乎是相同的，因此可以得知我們只要根據專案的情況(有無Model)去設計<code>form_with</code>表單就好。</p>
<h2 id="data-remote-”true”"><a href="#data-remote-”true”" class="headerlink" title="data-remote=”true”"></a>data-remote=”true”</h2><figure class="highlight"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products/new"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">data-remote</span>=<span class="string">"true"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line"><span class="tag"><span class="attr">....</span></span></span><br><span class="line"><span class="tag"></span></span><br><span class="line">&lt;/form&gt;</span><br></pre></td></tr></table></figure>

<p>上面兩個例子產出的html中，有一段<code>data-remote=&quot;true&quot;</code>是在<code>form_tag</code>及<code>form_for</code>沒有的。</p>
<p>有了這個屬性之後，表單會透過 Ajax 的方式提交，而不是瀏覽器平常的提交機制，若要設定不讓Ajax的方式提交，則要另訂 local: true。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">model:</span> @<span class="attr">product</span>, <span class="attr">local:</span> <span class="attr">true</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="form-with就算沒有Model的屬性也使用"><a href="#form-with就算沒有Model的屬性也使用" class="headerlink" title="form_with就算沒有Model的屬性也使用"></a>form_with就算沒有Model的屬性也使用</h2><h4 id="form-for"><a href="#form-for" class="headerlink" title="form_for"></a>form_for</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.check_box</span> <span class="attr">:is_avalble</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/v3ceHy3.png" alt=""></p>
<h4 id="form-with"><a href="#form-with" class="headerlink" title="form_with"></a>form_with</h4><figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_with</span> <span class="attr">model:</span> @<span class="attr">product</span>, <span class="attr">local:</span> <span class="attr">true</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.check_box</span> <span class="attr">:is_avalble</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p>產出的html:</p>
<p><img src="https://i.imgur.com/tYimKH2.png" alt=""></p>
<p>可以看得出來，就算Product這個Model裡沒有<code>is_avaliable</code>的屬性，還是可以用<code>form_with</code>寫出統一性的指令，而這個資料可用prodcut[is_avalible]收集。</p>
<h2 id="form-with在設定html時不用花括號"><a href="#form-with在設定html時不用花括號" class="headerlink" title="form_with在設定html時不用花括號{}"></a>form_with在設定html時不用花括號{}</h2><p><code>form_for</code>或<code>for_tag</code>若要設定html屬性，：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span>, <span class="attr">html:</span> &#123; <span class="attr">id:</span> “<span class="attr">product-id</span>”, <span class="attr">class:</span> “<span class="attr">product-type</span> &#125; <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br></pre></td></tr></table></figure>

<p><code>form_with</code>則不需要再寫花括號：</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span>, <span class="attr">id:</span> “<span class="attr">product-id</span>”, <span class="attr">class:</span> “<span class="attr">product-type</span>  <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br></pre></td></tr></table></figure>
<hr>
<p>以上大概就是淺談<code>form_with</code>，其實<code>form_with</code>有很多的細節可以討論，請原諒小弟我僅提出最基本部分來討論…</p>
<p>參考資料：</p>
<p><a href="https://medium.com/@tinchorb/form-with-building-html-forms-in-rails-5-1-f30bd60ef52d" target="_blank" rel="noopener">form_with — Building HTML forms in Rails 5.1</a><br><a href="https://api.rubyonrails.org/classes/ActionView/Helpers/FormHelper.html#method-i-hidden_field" target="_blank" rel="noopener">ActionView::Helpers::FormHelper</a></p>
<blockquote>
<p>“There’s no great loss without some small gain.”</p>
<p>– Laura Ingalls Wilder, Novelist</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day17:  淺談Rails的表單: form_for? form_tag? </title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2017/</url>
    <content><![CDATA[<p>在Rails中，常常會用到表單(form)將資料傳入資料庫，其中在Rails 5.1版本之前，常用的就是<code>form_tag</code>與<code>form_for</code>，我們來看看他們的分別該在何時使用：</p>
<p>先說結論：</p>
<blockquote>
<p>form內 <strong>有</strong> model實體時，用<code>form_for</code>，主要用於新增或修改。</p>
<p>form內 <strong>無</strong> model實體時，用<code>form_tag</code>，主要用於登入一筆資料。</p>
<p>Rails 5.1後，將兩者結合為<code>form_with</code></p>
</blockquote>
<p>關於<code>form_with</code>，有機會我再來對它做補充，這次先針對<code>form_for</code>及<code>form_tag</code>。</p>
<h2 id="form-for"><a href="#form-for" class="headerlink" title="form_for"></a>form_for</h2><p>form內<strong>有</strong>model實體時，用<code>form_for</code>，Rails會根據Model的屬性，自動判斷按下submit後，是要新增還是更新Model裡的資料。</p>
<p>翻譯蒟蒻：有媽豆的實體就用form_for</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line">#products_controller.rb</span><br><span class="line">#@product = Product.new</span><br><span class="line"></span><br><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_for</span> @<span class="attr">product</span> <span class="attr">do</span> |<span class="attr">form</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.text_field</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">form.submit</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/b9HI20l.png" alt=""></p>
<p>html會幫你產生</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">class</span>=<span class="string">"new_product"</span> <span class="attr">id</span>=<span class="string">"new_product"</span> <span class="attr">action</span>=<span class="string">"/products"</span></span></span><br><span class="line"><span class="tag"><span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span> <span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"**utf8**"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"**authenticity_token**"</span> <span class="attr">value</span>=<span class="string">"kxDHc4ID2xFAfBXANcrXBpqtI/</span></span></span><br><span class="line"><span class="tag"><span class="string">6rerAkMBaCh64j+O6LXsucFvkpU/UxO78XW8ELRuOwAU6O/MEM1LUdK9yEeQ=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"product[title]"</span> <span class="attr">id</span>=<span class="string">"product_title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Create Product"</span> <span class="attr">data-disable-with</span>=<span class="string">"Create Product"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>來簡單看看上面程式碼：<br>第一個 name 屬性為 utf8 的 input，強制瀏覽器正確採用表單指定的編碼。<br>第二個 name 屬性為 authenticity_token 的 input，<br>是 Rails 內建用來防止 CSRF (cross-site request forgery protection) 攻擊的安全機制。</p>
<p>為何要有這樣的保護機制: <a href="https://blog.techbridge.cc/2017/02/25/csrf-introduction/" target="_blank" rel="noopener">CSRF跨站請求偽造 Cross-site request forgery</a></p>
<p>這樣設定好整個表格，就是為了將@product這個ActiveRecord資料而設定的，所以表格送出的params會將我們在表格內填的變數，整個包在product物件下面，才會需要使用Strong Parameter那樣的機制將product變數抽出做permit(避免CSRF攻擊)：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">product_params</span></span></span><br><span class="line">  params.<span class="keyword">require</span>(<span class="symbol">:product</span>).permit(<span class="symbol">:title</span>, <span class="symbol">:password</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<h2 id="form-tag"><a href="#form-tag" class="headerlink" title="form_tag"></a>form_tag</h2><p>form內<strong>無</strong>model實體時，用<code>form_tag</code>，得指定要傳入哪個連結的<code>action</code>來進行表單資料的傳送。</p>
<p>翻譯蒟蒻：沒有媽豆的時候就只能用form_tag</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%=</span> <span class="attr">form_tag</span> <span class="attr">url:new_product_path</span> <span class="attr">do</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">text_field_tag</span> <span class="attr">:title</span> %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">%=</span> <span class="attr">submit_tag</span> %&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%</span> <span class="attr">end</span> %&gt;</span></span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/T7EvkLF.png" alt=""></p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">form</span> <span class="attr">action</span>=<span class="string">"/products/new?url=%2Fproducts"</span> <span class="attr">accept-charset</span>=<span class="string">"UTF-8"</span></span></span><br><span class="line"><span class="tag"><span class="attr">method</span>=<span class="string">"post"</span>&gt;</span><span class="tag">&lt;<span class="name">input</span> <span class="attr">name</span>=<span class="string">"utf8"</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">value</span>=<span class="string">"✓"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"hidden"</span> <span class="attr">name</span>=<span class="string">"authenticity_token"</span> <span class="attr">value</span>=<span class="string">"lfORCE9tuYA4Yuda6EziGw</span></span></span><br><span class="line"><span class="tag"><span class="string">KMQk9flV9dkM4ogaEzmUCNvZ3n25dLwo0vySXK3fQW3sLRsLphE7isDB8bJMzl1w=="</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"text"</span> <span class="attr">name</span>=<span class="string">"title"</span> <span class="attr">id</span>=<span class="string">"title"</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">input</span> <span class="attr">type</span>=<span class="string">"submit"</span> <span class="attr">name</span>=<span class="string">"commit"</span> <span class="attr">value</span>=<span class="string">"Save changes"</span> <span class="attr">data-disable-with</span>=<span class="string">"Save changes"</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">form</span>&gt;</span></span><br></pre></td></tr></table></figure>

<p>如果是使用form_tag，變數就不會包在任何東西內，可以直接在controller當中取用：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">search</span></span></span><br><span class="line">  @products = Product.where(<span class="symbol">product:</span> params[<span class="symbol">:search</span>])</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>參考資料：</p>
<p><a href="https://apidock.com/rails/ActionView/Helpers/FormTagHelper/form_tag" target="_blank" rel="noopener">Ruby API: form_tag</a><br><a href="https://ithelp.ithome.com.tw/articles/10221234" target="_blank" rel="noopener">Ruby API: form_for</a><br><a href="https://m.patrikonrails.com/rails-5-1s-form-with-vs-old-form-helpers-3a5f72a8c78a" target="_blank" rel="noopener">Rails 5.1’s form_with vs. form_tag vs. form_for
</a><br><a href="https://motion-express.com/blog/rails-form-tag-form-for" target="_blank" rel="noopener">form_tag 是啥？跟 form_for 有什麼不一樣？</a></p>
<blockquote>
<p>“A man can get discouraged many times, but he is not a failure until he begins to blame somebody else and stops trying.”</p>
<p>— John Burroughs, Writer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day16: 淺談Rails裡的resources</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2016/</url>
    <content><![CDATA[<h2 id="resources"><a href="#resources" class="headerlink" title="resources:"></a>resources:</h2><p>可以一次新8條路徑，7個方法，當然也可以一條一條自己新增(get, post)，但若剛好你要做的專案需要這8條路徑的話，用這種內建方式做可以省去不少時間且也會更有系統。</p>
<p>如果resources後面沒加s，在路徑的部分會有些action就不需要帶id，但會少一個路徑。</p>
<h4 id="resource"><a href="#resource" class="headerlink" title="resource"></a>resource</h4><p><img src="https://i.imgur.com/nPCHhiK.png" alt=""></p>
<h4 id="resources-1"><a href="#resources-1" class="headerlink" title="resources"></a>resources</h4><p><img src="https://i.imgur.com/89Y6Om2.png" alt=""></p>
<h2 id="RESTful-的網址設計："><a href="#RESTful-的網址設計：" class="headerlink" title="RESTful 的網址設計："></a>RESTful 的網址設計：</h2><p>導入 REST 的設計，可讓網址變得更直觀，而且也幫開發人員訂了一套網址設計的慣例。</p>
<p>在Terminal裡輸入：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">rails routes</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/Woqdb5V.png" alt=""></p>
<p>青藍色框：Prefix要的名稱<br>黃色框：網址後會產生的path<br>紅色框：路由</p>
<p>或是可以去網址打localhost:3000/這邊可以亂打</p>
<p>也可以看到路徑(我很懶..幾乎都用這個方式在查)</p>
<p><img src="https://i.imgur.com/QGhedW0.png" alt=""></p>
<p>可以一個指令產生這麼多東西！！！真的很方便，但如果剛好你不需要某些路由想要去除的話，可以用以下方式：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">resources :candidates, only: [:new, :show] -&gt; 只要路由new跟show</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">resources :candidates, except: [:new]      -&gt;8個都要除了路由new</span><br></pre></td></tr></table></figure>

<p>根據你要其中的幾個路由去決定要用only還是expect，若要較少的時候用only較適合，反之要多的路由就用expect。</p>
<p>抱歉這次文章品質實在很差…</p>
<p>我是在跟未來的自己抱歉</p>
<p>反正……</p>
<h1 id="又沒人會看-誤"><a href="#又沒人會看-誤" class="headerlink" title="又沒人會看(誤"></a>又沒人會看(誤</h1><blockquote>
<p>“A hero is an ordinary individual who finds the strength to persevere and endure in spite of overwhelming obstacles.”</p>
<p>— Christopher Reeve, Actor</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day15: Rails中的Gemfile</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2015/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/P3tMB5y.png" alt=""></p>
<p>在Ruby的宇宙裡，有很多用Ruby寫成的套件包或是框架可以使用，包含rails也是(第6行)。</p>
<p>Gemfile是Rails new一個新專案時附加的檔案(如上圖rails 5.2.3)，主要管理此Rails專案該會使用哪些gem檔案及版本號，在跑<code>bundle install</code>時就會安裝到這個專案，所以可以視為紀錄這個專案該使用哪些gem的檔案，讓專案被其他使用者pull下來時，都能根據Gemfile裡的gem去安裝。</p>
<h2 id="裡面怎麼那麼多東西？"><a href="#裡面怎麼那麼多東西？" class="headerlink" title="裡面怎麼那麼多東西？"></a>裡面怎麼那麼多東西？</h2><p>讓我們來稍微檢視一下，預設的Gemfile到底有哪些東西，分別是做什麼用的？(抱歉可能沒辦法一個一個檢視…)</p>
<p>告訴Rails該去哪裡抓Gem下來用，預設為 rubygems.org</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">source &quot;https://rubygems.org”</span><br></pre></td></tr></table></figure>
<p>還會再多設置一個GitHub的URL當做備用來源</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">git_source(:github) &#123; |repo| &quot;https://github.com/#&#123;repo&#125;.git” &#125;</span><br></pre></td></tr></table></figure>



<h3 id="版本號"><a href="#版本號" class="headerlink" title="版本號"></a>版本號</h3><p>在ruby gem常常會看到後面接”數字.數字.數字“，可以解讀為：<br>“#{major}.#{minor}.#{build}”</p>
<blockquote>
<p>主要版號(major)：功能大改，公開的 API 做了不少修正，通常沒辦法向下不相容<br>次要版號(minor)：加了某些新功能，但不影響其它功能，向下相容<br>修訂版號(build)：對現有的功能做了小幅度的修正，可向下相容</p>
<p>by Ruby 語法放大鏡</p>
</blockquote>
<p>像最近rails從5.2.3更新為6.0.0，就是很大改版，就要相對注意相容性的問題。</p>
<h3 id="gem的版本號"><a href="#gem的版本號" class="headerlink" title="gem的版本號"></a>gem的版本號</h3><p>可以看到有些gem的後面有加<code>~&gt;</code> <code>3.2.1</code> <code>&gt;=</code>或沒加等等這幾種：</p>
<ul>
<li><p>gem後沒加：安裝最新的”穩定”版本</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem &apos;kaminari&apos;</span><br></pre></td></tr></table></figure>
</li>
<li><p>‘ ‘：指定版本</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem &quot;rails&quot;, &apos;5.2.3&apos;</span><br></pre></td></tr></table></figure></li>
<li><p>“&gt;=, &lt;：安裝含1.1版本以上 ~ 不包含1.1.4版本。</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem &apos;pg&apos;, &apos;&gt;= 1.1&apos;, &apos;&lt; 1.1.4&apos;</span><br></pre></td></tr></table></figure></li>
<li><p>~&gt;：算是縮寫，使用1.9版本以上，但2.0以下(不包括2.0)的最新版本</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem &apos;omniauth&apos;, &apos;~&gt; 1.9&apos;</span><br><span class="line"></span><br><span class="line">#等同於</span><br><span class="line"></span><br><span class="line">gem &apos;omniauth&apos;, &apos;&gt;= 1.9&apos;, &apos;&lt; 2.0&apos;</span><br></pre></td></tr></table></figure>

</li>
</ul>
<h3 id="Gemfile的Grop"><a href="#Gemfile的Grop" class="headerlink" title="Gemfile的Grop"></a>Gemfile的Grop</h3><p>大約分為三種，Product（上線/發佈）, Development（開發）, Test（測試）。</p>
<p>Product 上線 / 發佈：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">gem &apos;rails&apos;, &apos;~&gt; 5.2.3&apos;</span><br><span class="line"></span><br><span class="line">沒有在grop裡代表上線/發佈時才會使用到</span><br></pre></td></tr></table></figure>
<p>Development（開發）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">group :development do</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">寫在Development，這裡的 gem 會在開發時使用，上線時不會用</span><br></pre></td></tr></table></figure>

<p>Test (測試）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">group :test do</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">寫在Test裡，這裡的 gem 會在開發時使用，上線時不會用</span><br></pre></td></tr></table></figure>

<p>Development, Test（開發,測試）</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">group :development, :test do</span><br><span class="line">end</span><br><span class="line"></span><br><span class="line">寫在Development裡, Test，這裡的 gem 會在開發及測試時使用，上線時不會用</span><br></pre></td></tr></table></figure>

<p>參考資料：<br><a href="https://tosbourn.com/what-is-the-gemfile/" target="_blank" rel="noopener">What is a Gemfile?</a><br><a href="https://kaochenlong.com/2016/05/02/gemfile/" target="_blank" rel="noopener">Ruby 語法放大鏡</a></p>
<blockquote>
<p>“If you’re walking down the right path and you’re willing to keep walking, eventually you’ll make progress.”</p>
<p>— Barack Obama, the 44th U.S. President</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day14: 淺談Model資料表關聯</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2014/</url>
    <content><![CDATA[<p>不管用哪個程式語言或框架寫網站，多數會有資料庫的應用，資料與資料之間一定會有關聯性，那要如何在不同Model設立資料關係，這裏會用很簡單的例子去試著理解什麼是資料表關聯。</p>
<h2 id="Active-Record"><a href="#Active-Record" class="headerlink" title="Active Record"></a>Active Record</h2><p>根據手冊：「Active Record 是 MVC 的 M（Model），表現商業邏輯與資料的層級，負責新增與操作需要持久存在資料庫裡的資料」</p>
<p>看起來有點抽象，在我的理解大概就是這個概念：</p>
<p>Active Record ＝ 把資料做成物件（是一種ORM框架）<br>物件 = 欄位 + 基本操作 + 商業邏輯</p>
<p>這樣寫似乎還是有點抽象，但其實可以想像成：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Model = ActiveRecord.new</span><br></pre></td></tr></table></figure>

<h2 id="用店面舉例"><a href="#用店面舉例" class="headerlink" title="用店面舉例"></a>用店面舉例</h2><p>先預設我們有3個Model:</p>
<ul>
<li>Owner</li>
<li>Stroe</li>
<li>Product</li>
</ul>
<p><img src="https://i.imgur.com/DLbomd0.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">o1 = Owner.create(name: &apos;Louis&apos;)</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/rNoho2g.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">s1 = Store.new(title: &apos;Louis Shop&apos;)</span><br><span class="line">此時s1的owner_id還是空的</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/80ze79M.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">o1.store = s1</span><br><span class="line">把 Store 指定給 Owner</span><br><span class="line">s1的Owner_id就有3了</span><br></pre></td></tr></table></figure>

<h3 id="可用-create-本身包含-save"><a href="#可用-create-本身包含-save" class="headerlink" title="可用 create (本身包含.save)"></a>可用 create (本身包含.save)</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">o1 = Owner.create(name: &apos;Sherly&apos;)</span><br><span class="line">o1.create_store(title: &apos;Ruby Shop&apos;)</span><br></pre></td></tr></table></figure>
<p><img src="https://i.imgur.com/4e05pKT.png" alt=""></p>
<h3 id="用build-本身不包含save"><a href="#用build-本身不包含save" class="headerlink" title="用build(本身不包含save)"></a>用build(本身不包含save)</h3><p>還未.save前，可看到shop的id是空的</p>
<p><img src="https://i.imgur.com/wHv2AtF.png" alt=""></p>
<p>.save後</p>
<p><img src="https://i.imgur.com/owsFscG.png" alt=""><br><img src="https://i.imgur.com/D85OzMh.png" alt=""></p>
<h3 id="用new不會存進資料庫，必須額外-save"><a href="#用new不會存進資料庫，必須額外-save" class="headerlink" title="用new不會存進資料庫，必須額外.save"></a>用new不會存進資料庫，必須額外.save</h3><p><img src="https://i.imgur.com/GDgtmVc.png" alt=""></p>
<h3 id="用另一個角度"><a href="#用另一個角度" class="headerlink" title="用另一個角度"></a>用另一個角度</h3><p>只要有任一方有存入資料庫，就可以設定關聯性，不須雙方都存入資料庫</p>
<p><img src="https://i.imgur.com/cmkkdZf.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">.create_store =&gt; 直接寫入資料庫</span><br><span class="line">.build_store =&gt;  建立，但未寫入資料庫</span><br></pre></td></tr></table></figure>

<h3 id="has-one"><a href="#has-one" class="headerlink" title="has_one"></a>has_one</h3><figure class="highlight plain"><figcaption><span>:store，產生以下四個方法:</span></figcaption><table><tr><td class="code"><pre><span class="line">(類似 Cat = Animail.new的概念)</span><br><span class="line">•store</span><br><span class="line">•store=</span><br><span class="line">•build_store</span><br><span class="line">•create_store</span><br></pre></td></tr></table></figure>
<h3 id="belongs-to"><a href="#belongs-to" class="headerlink" title="belongs_to"></a>belongs_to</h3><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">belongs_to 也是一個類別方法</span><br><span class="line">執行belongs_to :owner，只有產生以下兩個方法:</span><br><span class="line">•owner</span><br><span class="line">•owner=</span><br></pre></td></tr></table></figure>
<h3 id="has-many"><a href="#has-many" class="headerlink" title="has_many"></a>has_many</h3><figure class="highlight plain"><figcaption><span>:products，只有產生以下四個方法:</span></figcaption><table><tr><td class="code"><pre><span class="line">products</span><br><span class="line">products=</span><br><span class="line">build</span><br><span class="line">create</span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">#個別建立物件</span><br><span class="line">s1 = Store.first</span><br><span class="line">p1 = Product.new(name: &apos;iphone&apos;)</span><br><span class="line">p2 = Product.new(name: &apos;ipad&apos;)</span><br><span class="line"></span><br><span class="line">#方法一:可以一次塞入多個到s1</span><br><span class="line">s1.products = [p1, p2]</span><br><span class="line"></span><br><span class="line">#方法二:只能塞一個到s1</span><br><span class="line">s1.products.create(name: &apos;Mac&apos;)</span><br></pre></td></tr></table></figure>

<h3 id="has-many-through-多對多"><a href="#has-many-through-多對多" class="headerlink" title="has_many: through 多對多"></a>has_many: through 多對多</h3><p>跟has_many用起來差不多<br>需要第三方資料表來儲存兩邊資訊<br>第三方資料表通常只存放兩邊id，並且belong_to兩邊的Model</p>
<figure class="highlight bash"><table><tr><td class="code"><pre><span class="line">rails g WareHouse sotre:references product:references</span><br><span class="line"></span><br><span class="line">或</span><br><span class="line"></span><br><span class="line">rails g WareHouse sotre_id:<span class="built_in">integer</span> product_id:<span class="built_in">integer</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"></span><br><span class="line"><span class="comment">#store.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Store</span> &lt; ApplicationRecord</span></span><br><span class="line">  has_many <span class="symbol">:ware_houses</span></span><br><span class="line">  has_many <span class="symbol">:products</span>, <span class="symbol">through:</span> <span class="symbol">:ware_houses</span> <span class="comment">#透過第三方</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#product.rb</span></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Product</span> &lt; ApplicationRecord</span></span><br><span class="line">  <span class="comment"># belongs_to :store</span></span><br><span class="line">  has_many <span class="symbol">:ware_houses</span></span><br><span class="line">  has_many <span class="symbol">:stores</span>, <span class="symbol">through:</span> <span class="symbol">:ware_houses</span> <span class="comment">#透過第三方</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">s1 = Store.first</span><br><span class="line">s2 = Store.second</span><br><span class="line">p1 = Product.first</span><br><span class="line">p2 = Product.second</span><br><span class="line">p3 = Product.third</span><br></pre></td></tr></table></figure>

<p>試著建立這樣的關係：</p>
<p><img src="https://i.imgur.com/fCOx69y.png" alt=""></p>
<p><img src="https://i.imgur.com/Nn24Kip.png" alt=""><br><img src="https://i.imgur.com/mGlKdse.png" alt=""></p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">下圖:</span><br><span class="line">p2.stores -&gt;p2商品再哪間店有貨</span><br><span class="line">s1.owner  -&gt;s1店面的店長是誰</span><br><span class="line">s2.products -&gt; s2店面有哪些商品</span><br></pre></td></tr></table></figure>

<p><img src="https://i.imgur.com/I6R7ybA.png" alt=""></p>
<p>參考資料：<br><a href="https://railsbook.tw/chapters/16-model-basic.html" target="_blank" rel="noopener">Model 基本操作</a></p>
<blockquote>
<p>“I realized early on that success was tied to not giving up. Most people in this business gave up and went on to other things. If you simply didn’t give up, you would outlast the people who came in on the bus with you.”</p>
<p>— Harrison Ford, Actor</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day13: Ruby on Rails 的 .nil? .empty? .blank? .present? </title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2013/</url>
    <content><![CDATA[<p>在Ruby on Rails有很多神奇又好用的黑魔法，但有幾個類似的方法會搞不清楚到底在哪個狀況時要用哪個method…</p>
<p>我在寫rails的時候曾經踩過一個小雷：<br><img src="https://i.imgur.com/TAhp77y.png" alt=""></p>
<p>現在這個使用者的name欄位是空的，所以回傳的是<code>nil</code>，如果此時在<code>current_user.name</code>後接的是<code>.empty?</code>就會噴錯，所以要用<code>.nil?</code></p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">if</span> current_user.name.<span class="literal">nil</span>?   <span class="comment">#原本寫的是.empty?</span></span><br><span class="line">      redirect_to edit_user_registration_path</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line"><span class="comment">#下略</span></span><br></pre></td></tr></table></figure>
<h2 id="Ruby-nil-empty"><a href="#Ruby-nil-empty" class="headerlink" title="Ruby - .nil? .empty?"></a>Ruby - .nil? .empty?</h2><h3 id="nil"><a href="#nil" class="headerlink" title=".nil?"></a>.nil?</h3><p>還記得有句快說到爛的話，「在Ruby幾乎所有東西都是物件，除了block」，所以nil也是物件。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="literal">nil</span>.<span class="keyword">class</span></span><br><span class="line">=&gt; NilClass</span><br><span class="line"></span><br><span class="line"><span class="literal">nil</span>.<span class="literal">nil</span>?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">a = <span class="literal">nil</span></span><br><span class="line">a.<span class="literal">nil</span>? = <span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="string">""</span>.<span class="literal">nil</span>?</span><br><span class="line">=&gt; false</span><br><span class="line"></span><br><span class="line"><span class="literal">false</span>.<span class="literal">nil</span>?</span><br><span class="line">=&gt; false</span><br><span class="line"></span><br><span class="line">[].<span class="literal">nil</span>?</span><br><span class="line">=&gt; false</span><br></pre></td></tr></table></figure>
<p>可以很簡單地看出結果，只要<code>.nil?</code>之前接的物件是<code>nil</code>的話會回傳<code>true</code>，其他則都會回傳<code>flase</code>。</p>
<h3 id="empty"><a href="#empty" class="headerlink" title=".empty?"></a>.empty?</h3><p><code>.empty</code>方法前面是針對<code>string</code> <code>array</code> <code>hash</code>使用，如果這三種物件的長度為0 (legth == 0)的話，就會回傳<code>true</code>否則回傳<code>flase</code>。</p>
<p>另一種情況，如果<code>.empty?</code>前接的不是這三種物件的話，則會噴<code>undefined method empty?。</code></p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="string">""</span>.empty?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">[].empty?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">[ ].empty?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">" "</span>.empty?        <span class="comment">#空白字串也有長度</span></span><br><span class="line">=&gt; false</span><br><span class="line"></span><br><span class="line"><span class="literal">nil</span>.empty?</span><br><span class="line"><span class="symbol">NoMethodError:</span> undefined method <span class="string">`empty?' for nil:NilClass</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">false.empty?</span></span><br><span class="line"><span class="string">NoMethodError: undefined method `</span>empty?<span class="string">' for false:FalseClass</span></span><br></pre></td></tr></table></figure>

<h2 id="Rails-blank-present"><a href="#Rails-blank-present" class="headerlink" title="Rails - .blank? .present?"></a>Rails - .blank? .present?</h2><h3 id="blank"><a href="#blank" class="headerlink" title=".blank?"></a>.blank?</h3><p><code>.blank?</code>是一個<code>ActiveRecord method</code>，針對 <code>nil</code> <code>string</code> <code>array</code> <code>hash</code> 使用，在 <code>false</code> <code>nil</code> <code>empty</code>或<strong>空白</strong>字串(不是length == 0)時會回傳 true，否則回傳<code>false</code>。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="literal">false</span>.blank?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"><span class="literal">nil</span>.blank?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"><span class="string">""</span>.blank?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line"><span class="string">" "</span>.blank?</span><br><span class="line">=&gt; true            <span class="comment">#(跟.empty?不同)</span></span><br><span class="line"></span><br><span class="line">[].blank?</span><br><span class="line">=&gt; true</span><br><span class="line"></span><br><span class="line">&#123;&#125;.blank?</span><br><span class="line">=&gt; true</span><br></pre></td></tr></table></figure>
<h3 id="present"><a href="#present" class="headerlink" title=".present?"></a>.present?</h3><p><code>.present?</code>來自·<code>Active Record</code>，其實就是.blank?的相反用法，換句話說就是：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">!object.blank? == object.present?</span><br></pre></td></tr></table></figure>

<p>參考資料：<br><a href="https://jamestong10.github.io/blog/2016/09/01/rails-i18n-timezone/" target="_blank" rel="noopener">Rails I18n 多語系</a><br><a href="https://medium.com/le-wagon/how-to-use-nil-blank-present-exists-in-rails-5-fe03e78ab979" target="_blank" rel="noopener">How to use .nil? .empty? .blank? .present? in Rails 5</a><br><a href="https://mgleon08.github.io/blog/2015/12/16/ruby-on-rail-nil-empty-blank-present/" target="_blank" rel="noopener">.nil? .empty? .blank? .present? 傻傻分不清楚？</a><br><a href="https://ruby-doc.org/core-2.6.4/Object.html" target="_blank" rel="noopener">Ruby API</a></p>
<blockquote>
<p>“The two most powerful warriors are patience and time.”</p>
<p>— Leo Tolstoy, Novelist</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day12: Ruby的例外處理(Exceptions)：begin...rescue ...end</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2012/</url>
    <content><![CDATA[<p>幾乎每個程式語言都有例外處理的功能，當程式在執行時，不免都會遇到非工程師預期的狀況發生，我們可以針對不同例外訊息設計不同的例外處理。</p>
<p>在Ruby例外處理的基本架構：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment">#程式碼正常執行的地方 (可能出現例外的程式碼)</span></span><br><span class="line"><span class="keyword">rescue</span></span><br><span class="line">  <span class="comment">#發生錯誤時執行的地方</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>當Ruby執行程式發生錯誤時，會丟出一個Error類別產生的例外物件並停止程式，各種錯誤類型用架構的方式歸納：</p>
<p><img src="https://i.imgur.com/AcWTC5W.png" alt=""><br>圖片來源:Programming Ruby book</p>
<p>有這麼多例外訊息的類別，要舉例可能舉不完，不過用起來大概像下面這種感覺：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="keyword">begin</span></span><br><span class="line">  <span class="comment"># 可能出現例外的程式碼</span></span><br><span class="line"><span class="keyword">rescue</span> SyntaxError</span><br><span class="line">  <span class="comment"># 出現SyntaxError時執行此行程式碼</span></span><br><span class="line"><span class="keyword">rescue</span> ArgumentError</span><br><span class="line">  <span class="comment"># 出現ArgumentError時執行此行程式碼</span></span><br><span class="line"><span class="keyword">rescue</span> RuntimeError</span><br><span class="line">  <span class="comment"># 出現RuntimeError時執行此行程式碼</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>

<p>所以可針對丟出的例外訊息，去處理該訊息的例外處理，當然最常見的還是<code>SyntaxError</code>, <code>ArgumentError</code>及<code>RuntimeError</code>。如果沒有在<code>rescue</code>後特別寫哪種類別的話，任何的錯誤類別都會被<code>rescue</code>給抓到。</p>
<p>在舉例之前，我想先說說該如何用raise來產生例外處理。</p>
<h2 id="raise"><a href="#raise" class="headerlink" title="raise"></a>raise</h2><p>一般在簡單的程式碼，比較不會有例外處理的狀況發生，但為了舉例，我們也可以透過手動產生例外處理來觸發我們想要的結果，那我們就可以用raise method來執行。</p>
<h3 id="raise是什麼？"><a href="#raise是什麼？" class="headerlink" title="raise是什麼？"></a>raise是什麼？</h3><blockquote>
<p>The raise method is from the Kernel module. By default, raise creates an exception of the RuntimeError class.</p>
</blockquote>
<p>raise是來自於Kernel這個module的method，”預設”會產生來自RuntimeError這個類別的exception實體。</p>
<p>既然是預設，代表我們一定可以自己寫raise method後會產生哪個類別的實體。</p>
<h4 id="預設：RuntimeError"><a href="#預設：RuntimeError" class="headerlink" title="預設：RuntimeError"></a>預設：RuntimeError</h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span></span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之前'</span></span><br><span class="line">  raise <span class="string">'發生錯誤！'</span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之後'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">raise_exception</span><br></pre></td></tr></table></figure>
<p>印出</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">這邊是執行到raise之前</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">	1: from test.rb:18:in `&lt;main&gt;&apos;</span><br><span class="line">test.rb:15:in `raise_exception&apos;: 發生錯誤！ (RuntimeError)</span><br><span class="line">                                           #預設類別</span><br></pre></td></tr></table></figure>
<h4 id="指定其他類別-以ArgumentError為例"><a href="#指定其他類別-以ArgumentError為例" class="headerlink" title="指定其他類別(以ArgumentError為例)"></a>指定其他類別(以ArgumentError為例)</h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span></span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之前'</span></span><br><span class="line">  raise ArgumentError, <span class="string">'發生錯誤！'</span></span><br><span class="line">  puts <span class="string">'這邊是執行到raise之後'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">raise_exception</span><br></pre></td></tr></table></figure>
<p>印出</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">這邊是執行到raise之前</span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">	1: from test.rb:18:in `&lt;main&gt;&apos;</span><br><span class="line">test.rb:15:in `raise_exception&apos;: 發生錯誤！ (ArgumentError)</span><br><span class="line">                                           #被指定類別</span><br></pre></td></tr></table></figure>
<h2 id="begin…rescue…end"><a href="#begin…rescue…end" class="headerlink" title="begin…rescue…end"></a>begin…rescue…end</h2><h4 id="預設Exception"><a href="#預設Exception" class="headerlink" title="預設Exception"></a>預設Exception</h4><p>程式執行時先印出”發生例外之前”，之後遇到<code>raise</code>發生例外，故去找<code>rescue</code>底下的程式碼並執行，印出”已處理例外”。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span></span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span></span><br><span class="line">    raise <span class="string">'發生例外！'</span>     <span class="comment">#沒指定Error類別，預設為RuntimeError</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span>                 <span class="comment">#預設RuntimeError，所有錯誤都會到這執行</span></span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">raise_exception</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    已處理例外</span></span><br></pre></td></tr></table></figure>

<h4 id="指定錯誤類別"><a href="#指定錯誤類別" class="headerlink" title="指定錯誤類別"></a>指定錯誤類別</h4><p>程式執行時先印出”發生例外之前”，之後遇到<code>raise</code>LoadError類別發生例外，因為已被指定是遇到LoadError產生的實體，rescue後並無指定要救援哪個類別，故印出”發生例外！ (LoadError)”。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span></span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span></span><br><span class="line">    raise LoadError, <span class="string">'發生例外！'</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span></span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">raise_exception</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    發生例外！ (LoadError)</span></span><br></pre></td></tr></table></figure>

<p>若要修正，只要將rescue後加入該發生例外訊息時的類別就可以了。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span></span></span><br><span class="line">  <span class="keyword">begin</span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span></span><br><span class="line">    raise LoadError, <span class="string">'發生例外！'</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span> LoadError</span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">raise_exception</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    已處理例外</span></span><br></pre></td></tr></table></figure>

<p><strong>其實以上範例的<code>begin</code>跟<code>end</code>，可以被同時省略，只要留下<code>rescue</code>就可以正常執行，讓程式碼看起來更精簡，但對於金魚腦的我來說，為了方便未來能夠容易閱(理)讀(解)，還是不會把它們省略。</strong></p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">raise_exception</span></span></span><br><span class="line">    puts <span class="string">'發生例外之前'</span></span><br><span class="line">    raise LoadError, <span class="string">'發生例外！'</span></span><br><span class="line">    puts <span class="string">'發生例外之後'</span></span><br><span class="line">  <span class="keyword">rescue</span> LoadError</span><br><span class="line">    puts <span class="string">'已處理例外'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">raise_exception</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 發生例外之前</span></span><br><span class="line"><span class="comment">#    已處理例外</span></span><br></pre></td></tr></table></figure>



<h2 id="總結："><a href="#總結：" class="headerlink" title="總結："></a>總結：</h2><p>其實這個主題可以寫出非常多東西，目前只針對自己可能會用到的部分做說明，如果有興趣的朋友可以到參考資料看更多關於Exceptions的介紹。</p>
<ol>
<li><code>begin...rescue...end</code>用來解決非預期的結果。<ul>
<li>begin…rescue: 可能發生例外的程式碼</li>
<li>rescue…end: 發生錯誤時執行的程式碼</li>
</ul>
</li>
<li>可針對丟出的例外訊息，去處理該訊息的例外處理。</li>
<li><code>begin</code> <code>end</code>可省略</li>
</ol>
<p>參考資料：<br><a href="https://ruby-doc.org/core-2.2.3/Kernel.html#method-i-raise" target="_blank" rel="noopener">Ruby Kernel</a><br><a href="http://rubylearning.com/satishtalim/ruby_exceptions.html" target="_blank" rel="noopener">Ruby Exceptions</a><br><a href="https://mgleon08.github.io/blog/2016/02/04/rescue-exception/" target="_blank" rel="noopener">例外處理 Rescue Exception, Error Handling, Custom Error Pages</a><br><a href="https://pjchender.github.io/2018/06/05/ruby-error-handling%EF%BC%88%E9%8C%AF%E8%AA%A4%E8%99%95%E7%90%86%EF%BC%89/" target="_blank" rel="noopener">[Ruby] Error Handling（錯誤處理)</a><br><a href="https://medium.com/@eggyy1224/ruby-%E7%9A%84%E4%BE%8B%E5%A4%96%E8%99%95%E7%90%86%E6%A9%9F%E5%88%B6-106f829f280b" target="_blank" rel="noopener">Ruby 的例外處理機制</a><br><a href="https://medium.com/@pk60905/rails%E7%9A%84%E9%8C%AF%E8%AA%A4%E8%99%95%E7%90%86%E6%A9%9F%E5%88%B6begin-rescue%E5%92%8Cexception-ab71156a24a2" target="_blank" rel="noopener">Rails的錯誤處理機制begin、rescue和Exception</a></p>
<blockquote>
<p>“The meaning of life is to find your gift. The purpose &gt;of life is to give it away.”</p>
<p>– Pablo Picasso, Artist</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day11: Ruby中的Getter及Setter?</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2011/</url>
    <content><![CDATA[<p>在最近的練習中，只有印象自己大量的在用<code>attr_reader :somthing</code>，在完成這篇文章前，我完全不知道其實它就是getter method…</p>
<p>關於setter就真的更陌生了，也有在專案或練習的時候有用到，但也一樣完全不知道其實在用的就是setter method，所以決定寫個一篇文章來釐清一下觀念。</p>
<h2 id="Ruby沒有「屬性-property-attribute-」"><a href="#Ruby沒有「屬性-property-attribute-」" class="headerlink" title="Ruby沒有「屬性(property/attribute)」"></a>Ruby沒有「屬性(property/attribute)」</h2><p>Ruby沒有屬性這件事，跟其他程式語言不一樣，下面的例子：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">my.event</span><br><span class="line"><span class="comment">#其實原型是</span></span><br><span class="line">my.event()</span><br><span class="line"></span><br><span class="line">my.event = <span class="string">"something"</span></span><br><span class="line"><span class="comment">#其實原型是</span></span><br><span class="line">my.event=(<span class="string">"something"</span>)</span><br></pre></td></tr></table></figure>

<p>my.event看起來像是在my上讀取event的屬性，但它實際是執行了my.event()方法，只是括號可以適時省略，相同的my.event=(“something”)也是同樣道理。</p>
<h2 id="什麼是getter-method"><a href="#什麼是getter-method" class="headerlink" title="什麼是getter method?"></a>什麼是getter method?</h2><p>就英文直翻getter method是「取得(get)的方法」的意思，在Ruby裡指的就是取出實體變數(instance variable)的方法。</p>
<p>如果class裡沒有getter method，就無法取出在class內實體變數的值。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event</span><br></pre></td></tr></table></figure>
<p>會印出錯誤訊息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">undefined local variable or method `badminton&apos; for main:Object (NameError)</span><br></pre></td></tr></table></figure>

<p>可以看得出來，my這個實體拿不到class裡的實體變數@event，如果要拿到@event的話，必須給它一個getter method。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">event</span>    <span class="comment">#getter method</span></span></span><br><span class="line">    @event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event  <span class="comment"># =&gt; Badminton</span></span><br></pre></td></tr></table></figure>

<p>龍哥說，工程師都很懶惰，如果每次要取實體變數的值都要寫一次getter method不是很麻煩嗎？</p>
<h3 id="attr-reader"><a href="#attr-reader" class="headerlink" title="attr_reader"></a>attr_reader</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event     #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new <span class="string">'Badminton'</span></span><br><span class="line">puts my.event</span><br></pre></td></tr></table></figure>

<p>在class內加入<code>attr_reader :event</code>就自動幫你產生寫了第8~10行。</p>
<h2 id="什麼是setter-method"><a href="#什麼是setter-method" class="headerlink" title="什麼是setter method?"></a>什麼是setter method?</h2><p>就英文直翻setter method是「指派(assign)的方法」的意思，在Ruby裡指的就是指派實體變數(instance variable)的方法。</p>
<p>如果class裡沒有setter method，就無法派在class內實體變數的值。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event     #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event  <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event = <span class="string">"Pasta"</span></span><br></pre></td></tr></table></figure>

<p>會印出錯誤訊息</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line">undefined local variable or method `badminton&apos; for main:Object (NameError)</span><br></pre></td></tr></table></figure>

<p>可以看得出來，my這個實體做event方法時，如果要直接指派event方法內部的實體變數@event為”Pasta”，必須給它一個setter method。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event        #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">event=</span> <span class="title">food</span>    <span class="comment">#setter method</span></span></span><br><span class="line">    @event = food</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event           <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event=(<span class="string">"Pasta"</span>) <span class="comment"># =&gt; Pasta</span></span><br></pre></td></tr></table></figure>

<p>等等….為什麼方法名稱有個等於又帶括號？</p>
<h3 id="Ruby魔法糖-括號可適時的省略"><a href="#Ruby魔法糖-括號可適時的省略" class="headerlink" title="Ruby魔法糖? - 括號可適時的省略"></a>Ruby魔法糖? - 括號可適時的省略</h3><p>Rub6定義方法時，等號跟其他字元都可以當作是名字的一部分，只是規定上必須放在最後面。</p>
<p>所以可以將<code>event=(food)</code>解讀一下：event= 是方法名稱，帶有參數food</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">event=(food)</span><br><span class="line"></span><br><span class="line"><span class="comment">#括號可適時的省略</span></span><br><span class="line">event=food</span><br><span class="line"></span><br><span class="line"><span class="comment">#可適時加入空白字元</span></span><br><span class="line">event = food</span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event     #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">event=</span> <span class="title">food</span> <span class="comment">#括號可適時的省略   #setter method</span></span></span><br><span class="line">    @event = food</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event           <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event = <span class="string">"Pasta"</span> <span class="comment"># =&gt; Pasta      #括號可適時的省略並加入空白字元</span></span><br></pre></td></tr></table></figure>

<p>還好工程師都很懶惰再一次，這裏也可以寫成attr的方式。</p>
<h3 id="attr-writer"><a href="#attr-writer" class="headerlink" title="attr_writer"></a>attr_writer</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="keyword">attr_reader</span> <span class="symbol">:event</span></span><br><span class="line">  <span class="keyword">attr_writer</span> <span class="symbol">:event</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event         #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event= food   #setter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span> = food</span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>)</span><br><span class="line">puts my.event           <span class="comment"># =&gt; Badminton</span></span><br><span class="line">puts my.event = <span class="string">"Pasta"</span> <span class="comment"># =&gt; Pasta</span></span><br></pre></td></tr></table></figure>

<p>在class內加入<code>attr_writer :event</code>就自動幫你產生寫了第13~15行。</p>
<p>還好偉大的<del>懶惰</del>工程師們，覺得如果要再多個實體變數的話，就得要再寫<code>attr_reader</code>跟<code>attr_writer</code>的方式來取得跟指派，實在太麻煩了…</p>
<h2 id="attr-accessor"><a href="#attr-accessor" class="headerlink" title="attr_accessor"></a>attr_accessor</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Favorite</span></span></span><br><span class="line">  <span class="comment"># attr_reader :event</span></span><br><span class="line">  <span class="comment"># attr_writer :event</span></span><br><span class="line">  <span class="comment"># attr_reader :price</span></span><br><span class="line">  <span class="comment"># attr_writer :price</span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:event</span>, <span class="symbol">:price</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(event, price)</span></span></span><br><span class="line">    @event = event</span><br><span class="line">    @price = price</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event         #getter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span></span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"></span><br><span class="line">  <span class="comment"># def event= food   #setter method</span></span><br><span class="line">  <span class="comment">#   <span class="doctag">@event</span> = food</span></span><br><span class="line">  <span class="comment"># end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">my = Favorite.new(<span class="string">'Badminton'</span>, <span class="string">"$200"</span>)</span><br><span class="line">my.event = <span class="string">"Volleyball"</span></span><br><span class="line">my.price = <span class="string">"$300"</span></span><br><span class="line">puts my.event           <span class="comment"># =&gt; Volleyball</span></span><br><span class="line">puts my.price           <span class="comment"># =&gt; $300</span></span><br></pre></td></tr></table></figure>

<p>在class內加入<code>attr_accessor :event, :price</code>就自動幫你產生寫了第2~5行。</p>
<p>這也是為何我們在rails專案裡，可以用<strong>點</strong>的方式取值的概念，例如：第5~10行，在rails裡的Active Record(MVC的M (Model))，會自動建立<code>attr_accessor :foods</code>。</p>
<figure class="highlight html"><table><tr><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">%</span> @<span class="attr">foods.each</span> <span class="attr">do</span> |<span class="attr">food</span>| %&gt;</span></span><br><span class="line">  <span class="tag">&lt;<span class="name">ul</span>&gt;</span></span><br><span class="line">    <span class="tag">&lt;<span class="name">li</span>&gt;</span></span><br><span class="line">      名稱：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.title</span>%&gt;</span></span><br><span class="line">      數量：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.quantity</span>%&gt;</span></span><br><span class="line">      可領取時間：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.pickup_time</span>%&gt;</span></span><br><span class="line">      原價：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.origin_price</span>%&gt;</span></span><br><span class="line">      救援價：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.discount_price</span>%&gt;</span></span><br><span class="line">      描述：<span class="tag">&lt;<span class="name">%=</span> <span class="attr">food.description</span>%&gt;</span></span><br><span class="line">    <span class="tag">&lt;/<span class="name">li</span>&gt;</span></span><br><span class="line">  <span class="tag">&lt;/<span class="name">ul</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;<span class="name">%end%</span>&gt;</span></span><br></pre></td></tr></table></figure>

<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><ol>
<li>getter method: <strong>取出</strong>實體變數(instance variable)的方法。</li>
<li>setter method: <strong>指派</strong>實體變數(instance variable)的方法。</li>
<li><code>attr_reader</code> + <code>attr_writer</code> = <code>attr_accessor</code></li>
</ol>
<p>參考資料：<br><a href="https://medium.com/@rondwalker22/how-getter-setter-methods-work-in-ruby-c5f5da07f99" target="_blank" rel="noopener">How getter/setter methods work in Ruby</a><br><a href="https://dev.to/k_penguin_sato/ruby-getters-and-setters-1p30#what-is-a-getter-method" target="_blank" rel="noopener">Ruby Getters and Setters</a><br><a href="https://kaochenlong.com/2015/03/21/attr_accessor/" target="_blank" rel="noopener">Ruby 語法放大鏡之「attr_accessor 是幹嘛的?</a></p>
<blockquote>
<p>“The conditions of conquest are always easy. We have but to toil awhile, endure awhile, believe always, and never turn back.”</p>
<p>— Lucius Annaeus Seneca, Philosopher</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day10: Ruby中的Conditional Assignment Operator: x ||= y(or-equals)</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%2010/</url>
    <content><![CDATA[<p>最近的rails專案裡，看到了這行：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">@cart = @cart <span class="params">||</span> Cart.from_hash(session[<span class="symbol">:cart9527</span>])</span><br></pre></td></tr></table></figure>

<p>剛開始真的看不懂這段到底在幹嘛，為了想釐清觀念就查了一下資料，結果越查越多….而且方向還越來越偏XD</p>
<p>至於為什麼要特別寫這篇呢？我們已經知道Ruby中的等於是指派(Assign)的意思，那不就跟x += 1 等同於 x = x + 1而已嗎？</p>
<p><img src="https://i.imgur.com/yjGHJqf.png" alt=""><br><a href="https://www.oreilly.com/library/view/the-ruby-programming/9780596516178/ch04s05.html" target="_blank" rel="noopener">圖片來源</a></p>
<h3 id="x-y-不是-x-x-y"><a href="#x-y-不是-x-x-y" class="headerlink" title="x ||= y 不是 x = x || y"></a><code>x ||= y 不是 x = x || y</code></h3><p><del>難道這就是傳說中的Ruby界的WTF moment嗎？</del></p>
<p>那 x ||= y到底是什麼？</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">x <span class="params">||</span>= y</span><br><span class="line"></span><br><span class="line"><span class="comment">#expansion應該長</span></span><br><span class="line">x <span class="params">||</span> x = y</span><br></pre></td></tr></table></figure>

<blockquote>
<p>If <strong>x</strong> is not initialized, false, nil or undefined, then evaluate <strong>y</strong> and set a to the result.</p>
</blockquote>
<p>如果x尚未被初始化、false或nil及undefined，x 等於 y(換句話說:y會指派給x)，其他情況下，x值不變。</p>
<p>所以:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">@cart = @cart <span class="params">||</span> Cart.from_hash(session[<span class="symbol">:cart9527</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment">#跟下面程式碼不相同</span></span><br><span class="line"></span><br><span class="line">@cart <span class="params">||</span>= Cart.from_hash(session[<span class="symbol">:cart9527</span>])</span><br></pre></td></tr></table></figure>
<p>@cart現在是nil，第一圈會找Cart.from_hash(session[:cart9527])指派給@cart，第二圈因為@cart已經有值，故會將值指向自己。</p>
<p>再來看看幾個例子：</p>
<h4 id="x被指派為nil或false"><a href="#x被指派為nil或false" class="headerlink" title="x被指派為nil或false"></a>x被指派為nil或false</h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">x = <span class="literal">nil</span> <span class="comment"># 或 x = false</span></span><br><span class="line">y = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">puts x <span class="params">||</span>= y  <span class="comment"># =&gt; x原本是nil，印出 x = 10</span></span><br></pre></td></tr></table></figure>

<h4 id="x被指派為2"><a href="#x被指派為2" class="headerlink" title="x被指派為2"></a>x被指派為2</h4><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">x = <span class="number">2</span></span><br><span class="line">y = <span class="number">10</span></span><br><span class="line"></span><br><span class="line">puts x <span class="params">||</span>= y     <span class="comment"># =&gt; x原本是2，印出 x = 2</span></span><br><span class="line">puts x <span class="params">||</span> x = y  <span class="comment"># =&gt; 2</span></span><br><span class="line">puts x = x <span class="params">||</span> y  <span class="comment"># =&gt; 2</span></span><br></pre></td></tr></table></figure>

<p>剛剛才說，”x ||= y 不是 x = x || y“，那上面例子的第6行怎麼還會印出2?</p>
<p><img src="https://i.imgur.com/olpNY40.png" alt=""></p>
<h2 id="竟然是曾經的熱門議題？"><a href="#竟然是曾經的熱門議題？" class="headerlink" title="竟然是曾經的熱門議題？"></a>竟然是曾經的熱門議題？</h2><p>這個議題在約10年前討(爭)論(辯)的非常熱烈，可看下圖有人將所有的討論串做整理，最多有500多人在討論，有興趣的朋友可以點進去<a href="(https://www.ruby-forum.com/t/the-definitive-list-of-or-equal-threads-and-pages/136446)">連結</a>看看在吵些什麼XD<br><img src="https://i.imgur.com/azTJnCC.png" alt=""></p>
<p>最噁心的討論就像這樣：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#sample1</span></span><br><span class="line">a <span class="params">||</span>= b</span><br><span class="line"></span><br><span class="line"><span class="comment">#sample2</span></span><br><span class="line">a <span class="params">||</span> a = b</span><br><span class="line"></span><br><span class="line"><span class="comment">#sample3</span></span><br><span class="line">a ? a : a = b</span><br><span class="line"></span><br><span class="line"><span class="comment">#sample4</span></span><br><span class="line"><span class="keyword">if</span> a <span class="keyword">then</span></span><br><span class="line">  a</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  a = b</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#sample5</span></span><br><span class="line">a = a <span class="params">||</span> b</span><br><span class="line"></span><br><span class="line"><span class="comment">#sample6</span></span><br><span class="line">a = a ? a : b</span><br><span class="line"></span><br><span class="line"><span class="comment">#sample7</span></span><br><span class="line"><span class="keyword">if</span> a <span class="keyword">then</span></span><br><span class="line">  a = a</span><br><span class="line"><span class="keyword">else</span></span><br><span class="line">  a = b</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>a || a = b, a ? a : a = b, if a then a else a = b end, and if a then a = a else a = b end will throw an error if a is undefined, whereas a ||= b and a = a || b will not. Also, a || a = b, a ? a : a = b, if a then a else a = b end, a = a ? a : b, and if a then a = a else a = b end evaluate a twice when a is truthy, whereas a ||= b and a = a || b do not.</p>
</blockquote>
<p>看得我頭都暈了…且已經超過我能理解的範圍</p>
<h2 id="總結："><a href="#總結：" class="headerlink" title="總結："></a>總結：</h2><h3 id="x-y"><a href="#x-y" class="headerlink" title="x ||= y"></a>x ||= y</h3><h3 id="If-x-is-not-initialized-or-if-it-is-set-to-nil-or-false-set-it-with-the-value-of-y"><a href="#If-x-is-not-initialized-or-if-it-is-set-to-nil-or-false-set-it-with-the-value-of-y" class="headerlink" title="If x is not initialized (or if it is set to nil or false), set it with the value of y."></a>If x is not initialized (or if it is set to nil or false), set it with the value of y.</h3><p>如果x尚未被初始化、false或nil及undefined，則 x 等於 y (換句話說:y會指派給x)，其他情況下，x值不變。</p>
<p>參考資料：<br><a href="https://medium.com/@josh.pann/conditional-assignment-operator-in-ruby-ac0ebc740ced" target="_blank" rel="noopener">Conditional Assignment Operator in Ruby
</a><a href="https://groups.google.com/forum/#!topic/comp.lang.ruby/y1Maaqk_Q7c" target="_blank" rel="noopener">Please explain nuances of ||=</a><br><a href="https://stackoverflow.com/questions/995593/what-does-or-equals-mean-in-ruby/14697343" target="_blank" rel="noopener">What does ||= (or-equals) mean in Ruby?</a><br><a href="https://www.ruby-forum.com/t/the-definitive-list-of-or-equal-threads-and-pages/136446" target="_blank" rel="noopener">The definitive list of ||= (OR Equal) threads and pages</a><br><a href="https://stackoverflow.com/questions/34736116/difference-between-a-a-b-and-a-b" target="_blank" rel="noopener">Difference between a = a || b and a ||= b</a><br><a href="https://www.oreilly.com/library/view/the-ruby-programming/9780596516178/ch04s05.html" target="_blank" rel="noopener">Assignments</a><br><a href="https://davidablack.net/dablog.html#2008/3/25/a-short-circuit-edge-case" target="_blank" rel="noopener">A short-circuit (||=) edge case</a><br><a href="https://ithelp.ithome.com.tw/articles/10200997" target="_blank" rel="noopener">超級經典面試題: Ruby的 a ||= b (or-equals)是什麼意思呢?</a></p>
<blockquote>
<p>“The man who can drive himself further once the effort gets painful is the man who will win.”</p>
<p>— Roger Bannister, Runner</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day9: Ruby的三種存取控制Public, Private, Protected</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%209/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/qHDe6Du.jpg" alt=""><br><a href="https://www.pinterest.com/pin/35254809565990906" target="_blank" rel="noopener">圖片來源</a></p>
<p>前面有提過，Ruby是一門相當徹底的物件導向語言，幾乎所有的東西都是物件，但block除外。要改變物件的狀態，在ruby最常見的方式就是.method，要拿這個method來用，就要從class內來存取，這個行為就是「存取控制」。</p>
<blockquote>
<p>物件（object） = 狀態（state） + 行為（behavior)</p>
</blockquote>
<p>來看最簡單的例子：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disney</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">feel</span></span></span><br><span class="line">    puts <span class="string">"I feel very happy"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">you = Disney.new</span><br><span class="line">you.feel <span class="comment"># =&gt; I feel very happy</span></span><br></pre></td></tr></table></figure>

<p>you.feel這個東西看起來沒什麼特別，但在Ruby的解讀，會像有一個you物件，對它發送了一個「訊息」（message）feel，而這個you就是訊息的「接收者」（receiver）。</p>
<p>一般來說，<code>public</code>的存取是Ruby已預設好的。就像上面例子，如果在方法上面沒有特別寫是哪種存取方式的話，那就是會是預設的<code>public</code>。</p>
<p>用程式碼來看看三種控制：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disney</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">feel</span></span></span><br><span class="line">    puts <span class="string">"I feel very happy"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  private</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">eat</span></span></span><br><span class="line">    puts <span class="string">"I wanna have some popcorn"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  protected</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">watch</span></span></span><br><span class="line">    puts <span class="string">"I wanna watch the show"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">you = Disney.new</span><br><span class="line">you.feel   <span class="comment"># =&gt; I feel very happy</span></span><br><span class="line">you.eat    <span class="comment"># =&gt; NoMethodError</span></span><br><span class="line">you.watch  <span class="comment"># =&gt; NoMethodError</span></span><br></pre></td></tr></table></figure>
<p>另一種存取控制的寫法，寫在定義之後：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disney</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">feel</span></span></span><br><span class="line">    puts <span class="string">"I feel very happy"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">eat</span></span></span><br><span class="line">    puts <span class="string">"I wanna have some popcorn"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">watch</span></span></span><br><span class="line">    puts <span class="string">"I wanna watch the show"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  protected <span class="symbol">:eat</span></span><br><span class="line">  private <span class="symbol">:watch</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">you = Disney.new</span><br><span class="line">you.feel   <span class="comment"># =&gt; I feel very happy</span></span><br><span class="line">you.eat    <span class="comment"># =&gt; NoMethodError</span></span><br><span class="line">you.watch  <span class="comment"># =&gt; NoMethodError</span></span><br></pre></td></tr></table></figure>

<p>至於兩種寫法其實並沒有差別，我自己是比較偏向第一種方式，因為第二種感覺比較容易跟rails搞混，例如：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">has_many <span class="symbol">:users</span></span><br></pre></td></tr></table></figure>

<h2 id="Private"><a href="#Private" class="headerlink" title="Private"></a>Private</h2><p>在各個程式語言都有存取控制的設計，private在其他語言被定義為「只有在類別內部才能被存取」，但在Ruby這裡的定義有點不太一樣：</p>
<blockquote>
<p>不能在外部呼叫，也不能明確的指出「接收者」（receiver）</p>
</blockquote>
<p>翻譯蒟蒻：若要呼叫private的方法時，前面不可以加小數點。<br>(備註：外部的定義不包含繼承的子類別)</p>
<p>上面例子因為eat方法是private method，所以向you(receiver)發送eat訊息(message)會出現NoMethodError。</p>
<h3 id="但private真的那麼private嗎？"><a href="#但private真的那麼private嗎？" class="headerlink" title="但private真的那麼private嗎？"></a>但private真的那麼private嗎？</h3><p>如果定義上不能在receiver前加小數點，那我改成其他形式總行吧？</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">you = Disney.new</span><br><span class="line">you.feel   <span class="comment"># =&gt; I feel very happy</span></span><br><span class="line">you.send(<span class="symbol">:eat</span>) <span class="comment"># =&gt; I wanna have some popcorn</span></span><br></pre></td></tr></table></figure>

<p>send是Ruby內建的方法，這邊只是把:eat當作參數送給you而已，指出接收者的是send方法而不是private method的eat，並沒有違反”不能明確的指出「接收者」的規定”，所以這也是Ruby跟其他程式語言在private定義不同的地方。</p>
<h2 id="Protected"><a href="#Protected" class="headerlink" title="Protected"></a>Protected</h2><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disney</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">feel</span></span></span><br><span class="line">    puts <span class="string">"I feel very happy"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  private</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">eat</span></span></span><br><span class="line">    puts <span class="string">"I wanna have some popcorn"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  protected</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">watch</span></span></span><br><span class="line">    puts <span class="string">"I wanna watch the show"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Marvel</span> &lt; Disney</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">marvel_watch</span></span></span><br><span class="line">    watch</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">marvel_self_watch</span></span></span><br><span class="line">    <span class="keyword">self</span>.watch</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">iron = Marvel.new</span><br><span class="line">iron.marvel_watch       <span class="comment"># =&gt; I wanna watch the show</span></span><br><span class="line">iron.marvel_self_watch  <span class="comment"># =&gt; I wanna watch the show</span></span><br></pre></td></tr></table></figure>

<p>以繼承的類別Marvel來看，在父類別的protected method，不管用的是<code>watch</code>或<code>self.watch</code>都可以順利印出來。</p>
<blockquote>
<p>不能在外部呼叫，但可以明確的指出「接收者」（receiver）</p>
</blockquote>
<p>那如果改用private method呢？</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Disney</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">feel</span></span></span><br><span class="line">    puts <span class="string">"I feel very happy"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  private</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">eat</span></span></span><br><span class="line">    puts <span class="string">"I wanna have some popcorn"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  protected</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">watch</span></span></span><br><span class="line">    puts <span class="string">"I wanna watch the show"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Marvel</span> &lt; Disney</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">marvel_eat</span></span></span><br><span class="line">    eat</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">marvel_self_eat</span></span></span><br><span class="line">    <span class="keyword">self</span>.eat</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">iron = Marvel.new</span><br><span class="line">iron.marvel_eat       <span class="comment"># =&gt; I wanna have some popcorn</span></span><br><span class="line">iron.marvel_self_eat  <span class="comment"># =&gt; NoMethodError</span></span><br></pre></td></tr></table></figure>

<p>最後一行會印出錯誤，是因為private method不能明確的指出「接收者」。</p>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><ol>
<li>三種方法都可以在類別內部呼叫。</li>
<li>private：不能在外部呼叫，也不能明確的指出「接收者」（receiver）。</li>
<li>protected：不能在外部呼叫，但可以明確的指出「接收者」（receiver）。</li>
</ol>
<p>參考資料：<br><a href="https://medium.com/@tjoye20/ruby-access-control-basics-public-vs-private-vs-protected-methods-7788b26e04a7" target="_blank" rel="noopener">Ruby Access Control Basics: Public vs Private vs Protected methods</a><br><a href="http://rubylearning.com/satishtalim/ruby_access_control.html" target="_blank" rel="noopener">Ruby Access Control</a><br><a href="https://railsbook.tw/chapters/08-ruby-basic-4.html" target="_blank" rel="noopener">類別（Class）與模組（Module）</a><br><a href="https://ithelp.ithome.com.tw/articles/10200397" target="_blank" rel="noopener">Ruby三種存取限制: Public, Protected, Private</a><br><a href="https://medium.com/@eggyy1224/ruby-public-protected-%E8%88%87-private-bd4a5832a0c8" target="_blank" rel="noopener">Ruby: public, protected 與 private</a></p>
<blockquote>
<p>“Success is falling nine times and getting up ten.”</p>
<p>— Jon Bon Jovi, Musician</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day8: Module的引入include和extend</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%208/</url>
    <content><![CDATA[<p>上次提到了類別(class)與模組(module)的差異，今天針對module如何引入進class使用來特別說明。</p>
<table>
<thead>
<tr>
<th>比較</th>
<th>模組(module)</th>
<th>類別(class)</th>
</tr>
</thead>
<tbody><tr>
<td>繼承inheritance</td>
<td>✕</td>
<td>✔</td>
</tr>
<tr>
<td>可實體化instantiation</td>
<td>✕</td>
<td>✔</td>
</tr>
</tbody></table>
<h2 id="include"><a href="#include" class="headerlink" title="include"></a>include</h2><p>  加入模組進入類別使用的時候，一般最常見的就是<code>include</code>，延續之前的例子：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">VolleyTeam</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">set</span></span></span><br><span class="line">    puts <span class="string">'舉球'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasketTeam</span></span></span><br><span class="line">  <span class="keyword">include</span> VolleyTeam  <span class="comment">#將module include到類別裡</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">pass</span></span></span><br><span class="line">    puts <span class="string">'接球後，傳球!'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">sakuragi = BasketTeam.new          <span class="comment">#產生sakaragi實體</span></span><br><span class="line">sakuragi.pass <span class="comment"># =&gt; 接球後，傳球!</span></span><br><span class="line">sakuragi.set  <span class="comment"># =&gt; 舉球!            #module的實體方法</span></span><br></pre></td></tr></table></figure>

<p>當一個 class 使用 <code>include</code> 引入 Module 的時候，會將module內的方法在class內增加一個<strong>實體方法</strong>。</p>
<h2 id="extend"><a href="#extend" class="headerlink" title="extend"></a>extend</h2><p>如果使用extend加入module模組的話：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">VolleyTeam</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">set</span></span></span><br><span class="line">    puts <span class="string">'舉球'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasketTeam</span></span></span><br><span class="line">  extend VolleyTeam</span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">pass</span></span></span><br><span class="line">    puts <span class="string">'接球後，傳球!'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">sakuragi = BasketTeam.new</span><br><span class="line">sakuragi.pass <span class="comment"># =&gt; 接球後，傳球!</span></span><br><span class="line">sakuragi.set  <span class="comment"># =&gt; 舉球!</span></span><br></pre></td></tr></table></figure>
<p>會出現error</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">undefined method <span class="string">`set' for #&lt;BasketTeam:0x00007fc18783eca8&gt;</span></span><br></pre></td></tr></table></figure>
<p>原因是如果用extend的話，會將module內的方法在class增加為<strong>類別方法</strong>，所以用實體後面去接類別方法，就會出現錯誤。</p>
<p>因此直接改為類別直接接類別方法就好：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">sakuragi = BasketTeam.new</span><br><span class="line">sakuragi.pass   <span class="comment"># =&gt; 接球後，傳球!</span></span><br><span class="line">BasketTeam.set  <span class="comment"># =&gt; 舉球!   #module的類別方法，直接接BasketTeam類別</span></span><br></pre></td></tr></table></figure>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><blockquote>
<p>Include is for adding methods to an instance of a class and extend is for adding class methods.</p>
</blockquote>
<p>使用<code>include</code>引入，會將module內的方法在class增加為<strong>實體方法</strong>。<br>使用<code>extend</code> 引入，會將module內的方法在class增加為<strong>類別方法</strong>。</p>
<p>參考資料：<br><a href="https://www.quora.com/What-is-the-different-between-include-and-extends-in-use-case-diagram" target="_blank" rel="noopener">What is the different between &lt;<include>&gt; and &lt;<extends>&gt; in use case diagram?</a><br><a href="https://medium.com/@leo_hetsch/ruby-modules-include-vs-prepend-vs-extend-f09837a5b073" target="_blank" rel="noopener">https://medium.com/@leo_hetsch/ruby-modules-include-vs-prepend-vs-extend-f09837a5b073</a><br><a href="http://www.railstips.org/blog/archives/2009/05/15/include-vs-extend-in-ruby/" target="_blank" rel="noopener">Include vs Extend in Ruby</a><br><a href="https://www.spreered.com/ruby-object-model-include-prepend-extend/" target="_blank" rel="noopener">Ruby 的繼承鍊 (2) - Module 的 include、prepend 和 extend</a></p>
<blockquote>
<p>“Ninety percent of all those who fail are not actually defeated. They simply quit.”</p>
<p>— Paul J. Meyer, Motivational Coach</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day7: Ruby裡的self是什麼？</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%207/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/zCYMgTN.png" alt=""></p>
<p>之前的文章有提過一句話「在Ruby裡，幾乎所有的東西都是物件」，這是否也代表每一行我們所打的code是否都屬於物件呢？</p>
<p><code>self</code>在Ruby是一個非常特別的存在，且永遠指向目前正在執行的物件，換句話說，就是<code>self</code>會根據現在放在哪個context(class、method..)的不同，指的當下就是物件自己。</p>
<p>這樣描述還是很模糊的感覺，下面會用幾個例子去理解<code>self</code>放在不同context的時候，會長什麼樣子。</p>
<h3 id="Top-Level-Context"><a href="#Top-Level-Context" class="headerlink" title="Top Level Context"></a>Top Level Context</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">name = <span class="string">"Louis"</span></span><br><span class="line">puts <span class="string">"Name is: <span class="subst">#&#123;name&#125;</span>"</span></span><br><span class="line">puts <span class="string">"Self is: <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></span><br><span class="line">puts <span class="string">"Self class is: <span class="subst">#&#123;<span class="keyword">self</span>.<span class="keyword">class</span>&#125;</span>"</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt;</span></span><br><span class="line"><span class="comment"># Name is: Louis</span></span><br><span class="line"><span class="comment"># Self is: main</span></span><br><span class="line"><span class="comment"># Self class is: Object</span></span><br></pre></td></tr></table></figure>

<p>這裡可以看到<code>self</code>是個main物件，且main物件是類別Object下的實體，如果用程式碼寫：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Object</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">reflect</span></span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">main = Object.new   <span class="comment">#main大概是這種感覺</span></span><br></pre></td></tr></table></figure>
<h3 id="self在實體方法-instance-method-與類別方法-class-method"><a href="#self在實體方法-instance-method-與類別方法-class-method" class="headerlink" title="self在實體方法(instance method)與類別方法(class method)"></a>self在實體方法(instance method)與類別方法(class method)</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Louis</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">say</span></span></span><br><span class="line">    puts <span class="keyword">self</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">say</span></span></span><br><span class="line">    puts <span class="keyword">self</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#實體方法</span></span><br><span class="line">kk = Louis.new</span><br><span class="line">kk.say    <span class="comment"># =&gt; 此時的self為Louis class所產生的實體 &lt;Louis:0x00007fad048259e8&gt;</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#類別方法</span></span><br><span class="line">Louis.say <span class="comment"># =&gt; 此時的self為Louis class本身</span></span><br></pre></td></tr></table></figure>


<h3 id="類別定義-class-definition"><a href="#類別定義-class-definition" class="headerlink" title="類別定義(class definition)"></a>類別定義(class definition)</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Louis</span></span></span><br><span class="line">    puts <span class="string">"Self is: <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; Self is: Louis</span></span><br></pre></td></tr></table></figure>
<p>此時的self為Louis class本身 =&gt; Louis</p>
<h3 id="模組定義-Module-definition"><a href="#模組定義-Module-definition" class="headerlink" title="模組定義(Module definition)"></a>模組定義(Module definition)</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Group</span></span></span><br><span class="line">  puts <span class="string">"Self inside Group is: <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; Self inside Group is: Group</span></span><br></pre></td></tr></table></figure>

<p>此時的self為module Group本身 =&gt; Group</p>
<h3 id="模組裡包類別-module-including-class"><a href="#模組裡包類別-module-including-class" class="headerlink" title="模組裡包類別(module including class)"></a>模組裡包類別(module including class)</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Group</span></span></span><br><span class="line">  puts <span class="string">"Self inside Group is: <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></span><br><span class="line">  <span class="comment"># =&gt; Self inside Group is: Group</span></span><br><span class="line"></span><br><span class="line">  <span class="class"><span class="keyword">class</span> <span class="title">Louis</span></span></span><br><span class="line">    puts <span class="string">"Self inside Group is: <span class="subst">#&#123;<span class="keyword">self</span>&#125;</span>"</span></span><br><span class="line">    <span class="comment"># =&gt; Self inside Group is: Group::Louis</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>這裡的class是包在module裡面，所以這裡的self是Group::Louis</p>
<h3 id="繼承-inheritance-時的self"><a href="#繼承-inheritance-時的self" class="headerlink" title="繼承(inheritance)時的self"></a>繼承(inheritance)時的self</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lion</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">say</span></span></span><br><span class="line">    puts <span class="keyword">self</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Pig</span> &lt; Lion</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">ponpon = Pig.new</span><br><span class="line">ponpon.say  <span class="comment"># =&gt; #&lt;Pig:0x00007fcb8801ca38&gt;</span></span><br></pre></td></tr></table></figure>
<p>此時的self為Pig class所產生的實體</p>
<h3 id="引入模組-include-module-時的self"><a href="#引入模組-include-module-時的self" class="headerlink" title="引入模組(include module)時的self"></a>引入模組(include module)時的self</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">Pig</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">say</span></span></span><br><span class="line">    puts <span class="keyword">self</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Lion</span></span></span><br><span class="line">  <span class="keyword">include</span> Pig</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">mufasa = Lion.new</span><br><span class="line">mufasa.say  <span class="comment"># =&gt; #&lt;Lion:0x00007fa502824390&gt;</span></span><br></pre></td></tr></table></figure>
<p>此時的self為Lion class所產生的實體</p>
<h2 id="總結"><a href="#總結" class="headerlink" title="總結"></a>總結</h2><ol>
<li>在實體方法、繼承、引入模組都使用了實體方法，所以此時的self都為該類別所產生的實體。</li>
<li>在類別方法、類別定義、模組定義時，self都為該類別、模組本身。</li>
<li>在模組裡包類別時，self為”模組::類別“。</li>
</ol>
<p>參考資料：<br><a href="https://airbrake.io/blog/ruby/self-ruby-overview" target="_blank" rel="noopener">Self in Ruby:A Comprehensive Overview</a><br><a href="https://www.honeybadger.io/blog/ruby-self-cheat-sheet/" target="_blank" rel="noopener">Understanding <code>self</code> in Ruby</a><br><a href="https://medium.com/@sgg2123/vs-self-in-ruby-1d4d88170" target="_blank" rel="noopener">@/@@ vs. self in Ruby</a><br><a href="https://codequizzes.wordpress.com/2014/04/23/rubys-main-object-top-level-context/" target="_blank" rel="noopener">Ruby’s Main Object (Top Level Context)</a><br><a href="http://karoten512.hatenablog.com/entry/2017/10/22/231319" target="_blank" rel="noopener">Rubyのselfが微妙に意味がわからなかったので、様々な文脈（トップレベル、class定義内、method定義内、module定義内）で出力してみた</a><br><a href="https://medium.com/@icelandcheng/ruby-%E4%B8%AD%E7%9A%84self%E8%AE%8A%E6%95%B8%E4%BB%A5%E5%8F%8A%E6%87%89%E7%94%A8-647664af2b6a" target="_blank" rel="noopener">Ruby 中的self變數以及應用</a></p>
<blockquote>
<p>“Our greatest weakness lies in giving up. The most certain way to succeed is always to try just one more time.”</p>
<p>— Thomas Edison, Inventor</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day6: 類別(Class)與模組(Module)的差異</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%206/</url>
    <content><![CDATA[<p>在寫這篇文章前，自認如果今天面試被問到這題，預期腦袋裡會一片空白，只知道這兩個物件都長得非常像但說不出哪裡不同。</p>
<p>google一下，看到最多次的一句話：</p>
<blockquote>
<p>Module is similar to a class but it cannot be “inheritance” and “instantiated”.</p>
</blockquote>
<p>咦？那結論都寫在這了，那是不是不用寫文章了(撒花)？</p>
<p>想了想還是認份的整理一下好了…總要自己驗證一下</p>
<p>開啟irb<br><img src="https://i.imgur.com/K7ofbVL.png" alt=""></p>
<p>可以看到Class背後的老爸竟然就是Module本人啊啊啊啊啊～<br>(腦袋莫名冒出<a href="https://www.google.com/search?q=%E4%BD%A0%E8%80%81%E7%88%B8%E5%9C%A8%E8%83%8C%E5%BE%8C&sxsrf=ACYBGNSzgtPvRBnZE1Qejs9toTS_p-l_RA:1568867518023&source=lnms&tbm=isch&sa=X&ved=0ahUKEwjV5PH4htzkAhWvGaYKHX0HB4sQ_AUIEigB&biw=1440&bih=766" target="_blank" rel="noopener">鍾楚雄</a>…)</p>
<p>那既然類別class是模組Module繼承來的，那代表class有的，Module一定都有，但Module有的，class不一定都有，聽起來很像繞口令，來驗證一下看看哪裡不同。</p>
<h2 id="找出差異"><a href="#找出差異" class="headerlink" title="找出差異"></a>找出差異</h2><p><img src="https://i.imgur.com/OkhifvS.png" alt=""><br>Module與class的關係看起來就像這樣，要找出差異，我想小學數學有教過，一個大圓包含一個小圓，如果要找出他們不同的地方，只要大圓減去小圓即可。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#irb</span></span><br><span class="line"><span class="meta">2.6.3 :012 &gt;</span> Class.methods - Module.methods</span><br><span class="line"> =&gt; []</span><br></pre></td></tr></table></figure>
<p>Module與class的類別方法互相減去，得到的是一個空陣列，代表他們在類別方並沒有差別，再來看實體方法：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#irb</span></span><br><span class="line"><span class="meta">2.6.3 :013 &gt;</span> Class.instance_methods - Module.instance_methods</span><br><span class="line"> =&gt; [<span class="symbol">:allocate</span>, <span class="symbol">:new</span>, <span class="symbol">:superclass</span>]</span><br></pre></td></tr></table></figure>
<p>其中<code>allocate</code>與<code>new</code>是跟產生實體有關係，<code>superclass</code>是與繼承有關係，所以可以看得出來：</p>
<h3 id="模組-Module-比類別-Class-多了「產生實體」與「繼承」的功能"><a href="#模組-Module-比類別-Class-多了「產生實體」與「繼承」的功能" class="headerlink" title="==模組(Module)比類別(Class)多了「產生實體」與「繼承」的功能=="></a>==模組(Module)比類別(Class)多了「產生實體」與「繼承」的功能==</h3><p>備註：關於<code>allocate</code>與<code>new</code></p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span></span></span><br><span class="line">  <span class="keyword">attr_accessor</span> <span class="symbol">:name</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span></span></span><br><span class="line">    @name = <span class="string">"NoName"</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">cat1 = Cat.new</span><br><span class="line">p cat1.name <span class="comment"># =&gt; "NoName"</span></span><br><span class="line"></span><br><span class="line">cat2 = Cat.allocate</span><br><span class="line">p cat2.name <span class="comment"># =&gt; nil</span></span><br></pre></td></tr></table></figure>
<p>allocate和new的差別在於：<br>allocate不會用initialize的方法並回傳實體變數，而new會。</p>
<h2 id="何時會使用到Module"><a href="#何時會使用到Module" class="headerlink" title="何時會使用到Module?"></a>何時會使用到Module?</h2><p>給大家一個例子想像一下：</p>
<p><a href="https://zh.wikipedia.org/wiki/%E7%81%8C%E7%B1%83%E9%AB%98%E6%89%8B%E8%A7%92%E8%89%B2%E5%88%97%E8%A1%A8" target="_blank" rel="noopener">湘北高校</a>籃球社的同學們突然覺得打籃球打贏<a href="https://baike.baidu.com/item/%E5%B1%B1%E7%8E%8B%E5%B7%A5%E4%B8%9A" target="_blank" rel="noopener">山王工業</a>就滿足了，於是就約了<a href="https://zh.wikipedia.org/wiki/%E6%8E%92%E7%90%83%E5%B0%91%E5%B9%B4%EF%BC%81%EF%BC%81" target="_blank" rel="noopener">烏野高校</a>排球社的同學去打排球。</p>
<p>因為櫻木跟大猩猩等人都沒打過排球，所以為了要讓球打得起來，必須把小不點的打排球技能學起來，那我們可以用哪種方式？</p>
<ol>
<li><p>直接寫舉球、托球…等等的技能類別，然後叫湘北類別去繼承他<br>問題：這樣設計就很像「為了想打”一場”排球就轉學去烏野高校」的感覺…幹嘛為了打排球就轉學啊？</p>
</li>
<li><p>直接寫舉球、托球方法到湘北類別裡面<br>問題：這樣寫似乎也沒不行，但如果今天山王工業的人突然也想加入打排球，<br>那不又要再山王工業的類別裡加入舉球、托球方法…</p>
</li>
</ol>
<p>==這時候就是用Module的時機了==</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">module</span> <span class="title">VolleyTeam</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">set</span></span></span><br><span class="line">    puts <span class="string">'舉球'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">toss</span></span></span><br><span class="line">    puts <span class="string">'托球'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">BasketTeam</span></span></span><br><span class="line">  <span class="keyword">include</span> VolleyTeam  <span class="comment">#將module include到類別裡</span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">pass</span></span></span><br><span class="line">    puts <span class="string">'接球後，傳球!'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">shoot</span></span></span><br><span class="line">    puts <span class="string">'接球後，投籃!'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">dribble</span></span></span><br><span class="line">    puts <span class="string">'運球'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">sakuragi = BasketTeam.new</span><br><span class="line">sakuragi.pass <span class="comment"># =&gt; 接球後，傳球!</span></span><br><span class="line">sakuragi.set  <span class="comment"># =&gt; 舉球!</span></span><br><span class="line">sakuragi.toss <span class="comment"># =&gt; 托球!</span></span><br></pre></td></tr></table></figure>
<p>之後如果山王工業真的要加入的話：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">MountainKing</span></span></span><br><span class="line">  <span class="keyword">include</span> VolleyTeam</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>他們就也可以一起加入打排球了</p>
<p><strong>上面例子可以做出一個小總結，如果今天要做的功能(method)在很多類別都會用到的話，就可以都抽出來寫在module裡面，再把它include到類別裡使用，跟Rails裡的Partial render有幾分相似概念。</strong></p>
<h1 id="總結："><a href="#總結：" class="headerlink" title="總結："></a>總結：</h1><p>講了那麼多範(幹)例(話)，其實類別(Class)與模組(Module)的主要差異就一句話：</p>
<p>==模組(Module)不可繼承、不可實體化==</p>
<table>
<thead>
<tr>
<th>比較</th>
<th>模組(module)</th>
<th>類別(class)</th>
</tr>
</thead>
<tbody><tr>
<td>繼承inheritance</td>
<td>✕</td>
<td>✔</td>
</tr>
<tr>
<td>可實體化instantiation</td>
<td>✕</td>
<td>✔</td>
</tr>
</tbody></table>
<p>參考資料：<br><a href="https://www.vikingcodeschool.com/professional-development-with-ruby/classes-vs-modules" target="_blank" rel="noopener">vikingcodeschool</a><br><a href="https://ruby-doc.org/core-2.4.1/Module.html" target="_blank" rel="noopener">ruby-doc.org</a><br><a href="https://medium.com/rubycademy/modules-in-ruby-part-i-a2cdfaccdb6e" target="_blank" rel="noopener">Modules in Ruby: Part I</a><br><a href="https://stackoverflow.com/questions/151505/difference-between-a-class-and-a-module" target="_blank" rel="noopener">Difference between a class and a module</a><br><a href="https://kaochenlong.com/2015/03/24/class-and-module/" target="_blank" rel="noopener">Ruby 語法放大鏡</a><br><a href="https://railsbook.tw/chapters/08-ruby-basic-4.html" target="_blank" rel="noopener">為自己學Ruby on Rails</a></p>
<blockquote>
<p>“Inside of a ring or out, ain’t nothing wrong with going down. It’s staying down that’s wrong.”</p>
<p>— Muhammad Ali, Boxer</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day5: yield在method裡的角色</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%205/</url>
    <content><![CDATA[<p><img src="https://i.imgur.com/zjTTCe0.png" alt=""></p>
<p><a href="https://dictionary.cambridge.org/zht/%E8%A9%9E%E5%85%B8/%E8%8B%B1%E8%AA%9E-%E6%BC%A2%E8%AA%9E-%E7%B9%81%E9%AB%94/yield" target="_blank" rel="noopener">yield</a>的中文翻譯有很多意思，在程式裡可以翻做「讓」的意思。</p>
<p>那在程式裡，到底是「讓」出什麼東西呢？</p>
<p><del>p.s不知道為何打到這裡腦袋突然出現</del><a href="https://www.google.com/search?q=%E6%89%B6%E8%80%81%E5%A4%AA%E5%A4%AA%E9%81%8E%E9%A6%AC%E8%B7%AF&sxsrf=ACYBGNQaWnxnCIPbSQVLLwrT_SkypMzmuA:1568867568426&source=lnms&tbm=isch&sa=X&ved=0ahUKEwiRjPaQh9zkAhVN05QKHQJZA1MQ_AUIEigB&biw=1440&bih=766#imgrc=qBkeOek9U-sN9M:" target="_blank" rel="noopener">扶老太太過馬路</a></p>
<h1 id="yield"><a href="#yield" class="headerlink" title="yield"></a>yield</h1><p>下面例子say_something方法，下方有個掛載的block，yield的作用就是「將控制權暫時讓給Block」之後，再繼續回來執行程式。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">say_something</span></span></span><br><span class="line">  puts <span class="string">'This is start'</span></span><br><span class="line">  <span class="keyword">yield</span></span><br><span class="line">  puts <span class="string">'This is end'</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">say_something &#123; puts <span class="string">'Block aboard!'</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; This is start</span></span><br><span class="line"><span class="comment">#    Block aboard!</span></span><br><span class="line"><span class="comment">#    This is end</span></span><br></pre></td></tr></table></figure>
<p>程式執行的流程：<br>從第2行印出’This is start’，再往下時遇到yield，暫時將控制權移交給第7行印出’Block aboard!’後，又回到第4行印出’This is end’。</p>
<p>下面例子其實跟上面雷同，只是多一個class而已。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hero</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">heart_beating</span></span></span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">king = Hero.new</span><br><span class="line">king.heart_beating &#123; p <span class="string">'帝王引擎'</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt; 帝王引擎</span></span><br></pre></td></tr></table></figure>


<h3 id="yield後面可以帶一個或以上的參數"><a href="#yield後面可以帶一個或以上的參數" class="headerlink" title="yield後面可以帶一個或以上的參數"></a>yield後面可以帶一個或以上的參數</h3><p>在yield的後面可以自帶參數，延續上面的例子</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hero</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">heart_beating</span></span></span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">one_punch</span></span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'反覆橫跳'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">king = Hero.new</span><br><span class="line">king.heart_beating &#123; p <span class="string">'帝王引擎'</span> &#125;</span><br><span class="line"><span class="comment"># =&gt; 帝王引擎</span></span><br><span class="line"></span><br><span class="line">saitama = Hero.new</span><br><span class="line">saitama.one_punch &#123;<span class="params">|skill|</span> p <span class="string">"必殺認真系列..<span class="subst">#&#123;skill&#125;</span>"</span> &#125;</span><br><span class="line"><span class="comment"># =&gt; "必殺認真系列..反覆橫跳"</span></span><br></pre></td></tr></table></figure>


<h3 id="同一個method裡面塞多個yield"><a href="#同一個method裡面塞多個yield" class="headerlink" title="同一個method裡面塞多個yield"></a>同一個method裡面塞多個yield</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Hero</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">heart_beating</span></span></span><br><span class="line">    <span class="keyword">yield</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">one_punch</span></span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'反覆橫跳'</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'連續普通拳'</span></span><br><span class="line">    <span class="keyword">yield</span> <span class="string">'認真拳'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">king = Hero.new</span><br><span class="line">king.heart_beating &#123; p <span class="string">'帝王引擎'</span> &#125;</span><br><span class="line"><span class="comment"># =&gt; 帝王引擎</span></span><br><span class="line"></span><br><span class="line">saitama = Hero.new</span><br><span class="line">saitama.one_punch &#123;<span class="params">|skill|</span> p <span class="string">"必殺認真系列..<span class="subst">#&#123;skill&#125;</span>"</span> &#125;</span><br><span class="line"><span class="comment"># =&gt; "必殺認真系列..反覆橫跳"</span></span><br><span class="line"><span class="comment">#    "必殺認真系列..連續普通拳"</span></span><br><span class="line"><span class="comment">#    "必殺認真系列..認真拳"</span></span><br></pre></td></tr></table></figure>


<h3 id="讓程式判斷何時要yeild"><a href="#讓程式判斷何時要yeild" class="headerlink" title="讓程式判斷何時要yeild"></a>讓程式判斷何時要yeild</h3><p>Ruby有內建一個方法 block_given?</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">optional_block</span></span></span><br><span class="line">  <span class="keyword">yield</span>(<span class="string">'還我漂漂拳'</span>) <span class="keyword">if</span> block_given?</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">p optional_block <span class="comment"># =&gt; nil</span></span><br><span class="line">optional_block &#123;<span class="params">|x|</span> puts <span class="string">"<span class="subst">#&#123;x&#125;</span>"</span> &#125; <span class="comment"># =&gt; 還我漂漂拳</span></span><br></pre></td></tr></table></figure>
<p>如果有給block，就yield控制權出去給block。</p>
<h3 id="yield後面可以帶多個參數"><a href="#yield後面可以帶多個參數" class="headerlink" title="yield後面可以帶多個參數"></a>yield後面可以帶多個參數</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">calculator</span><span class="params">(a, b)</span></span></span><br><span class="line">  <span class="keyword">yield</span>(a, b)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">puts calculator(<span class="number">5</span>, <span class="number">6</span>) &#123; <span class="params">|a, b|</span> a + b &#125; <span class="comment"># =&gt; 11</span></span><br><span class="line">puts calculator(<span class="number">5</span>, <span class="number">6</span>) &#123; <span class="params">|a, b|</span> a - b &#125; <span class="comment"># =&gt; -1</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">yield_with_arguments</span></span></span><br><span class="line">  <span class="keyword">yield</span> <span class="string">"巴達獸進化~~~~~~~"</span></span><br><span class="line"></span><br><span class="line">  last_name = <span class="string">'John'</span></span><br><span class="line">  first_name = <span class="string">'Cena'</span></span><br><span class="line">  <span class="keyword">yield</span>(last_name, first_name)</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">yield_with_arguments &#123; <span class="params">|l, f|</span> puts <span class="string">"<span class="subst">#&#123;l&#125;</span> <span class="subst">#&#123;f&#125;</span>"</span> &#125;</span><br><span class="line"><span class="comment"># =&gt; 巴達獸進化~~~~~~~</span></span><br><span class="line"><span class="comment">#    John Cena</span></span><br></pre></td></tr></table></figure>
<p><a href="https://www.youtube.com/watch?v=kY83Yl0NJhU" target="_blank" rel="noopener">巴達獸進化</a></p>
<h2 id="yield組合技"><a href="#yield組合技" class="headerlink" title="yield組合技"></a>yield組合技</h2><p>範例一：<br>第7行的<code>i</code>被yeild出去找了第11行的i，<code>x</code>則是實體變數<code>@v</code>用each方法印出陣列中的數字。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Map</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span></span></span><br><span class="line">    @v = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">each_print</span></span></span><br><span class="line">    @v.each&#123;<span class="params">|i|</span> puts <span class="keyword">yield</span> i &#125; <span class="keyword">if</span> block_given?</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">i = <span class="string">"I can count number"</span></span><br><span class="line">a_obj = Map.new</span><br><span class="line">a_obj.each_print&#123;<span class="params">|x|</span> <span class="string">"<span class="subst">#&#123;i&#125;</span> <span class="subst">#&#123;x&#125;</span> "</span> &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment"># =&gt;</span></span><br><span class="line"><span class="comment"># I can count number 1</span></span><br><span class="line"><span class="comment"># I can count number 2</span></span><br><span class="line"><span class="comment"># I can count number 3</span></span><br><span class="line"><span class="comment"># I can count number 4</span></span><br></pre></td></tr></table></figure>
<p>範例二：<br>針對第4行中的counter去yield給method外部的block，且first給預設值=1。可以看到給first參數值，在第4行的counter就會走block中的方式，且從給的值開始往下走。<br>(備註：<a href="https://ruby-doc.org/core-2.6.3/Enumerator.html#method-i-next" target="_blank" rel="noopener">next方法</a>可以找下一個數字或字母)</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">list</span><span class="params">(array, first = <span class="number">1</span>)</span></span></span><br><span class="line">  counter = first</span><br><span class="line">  array.each <span class="keyword">do</span> <span class="params">|item|</span></span><br><span class="line">    puts <span class="string">"<span class="subst">#&#123;<span class="keyword">yield</span> counter&#125;</span>. <span class="subst">#&#123;item&#125;</span>"</span></span><br><span class="line">    counter = counter.<span class="keyword">next</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">list([<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>]) &#123; <span class="params">|ary|</span> ary &#125;</span><br><span class="line">list([<span class="string">"a"</span>,<span class="string">"b"</span>,<span class="string">"c"</span>], <span class="number">100</span>) &#123; <span class="params">|ary|</span> ary &#125;</span><br><span class="line">list([<span class="string">"Ruby"</span>, <span class="string">"Is"</span>, <span class="string">"Fun"</span>], <span class="string">"A"</span>) &#123; <span class="params">|ary|</span> ary &#125;</span><br><span class="line"></span><br><span class="line"><span class="comment">#output</span></span><br><span class="line"><span class="comment"># 1. a</span></span><br><span class="line"><span class="comment"># 2. b</span></span><br><span class="line"><span class="comment"># 3. c</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 100. a</span></span><br><span class="line"><span class="comment"># 101. b</span></span><br><span class="line"><span class="comment"># 102. c</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># A. Ruby</span></span><br><span class="line"><span class="comment"># B. Is</span></span><br><span class="line"><span class="comment"># C. Fun</span></span><br></pre></td></tr></table></figure>

<h2 id="總結："><a href="#總結：" class="headerlink" title="總結："></a>總結：</h2><p>yield就是暫時把控制權交棒給method外的 Block，等 Block 執行結束後再把控制權交回來method，並繼續往下走到程式結束。</p>
<p>yield的使用時機，可能因為做的練習跟專案還不夠多，暫時還不確定到底會在哪個情境使用到yield，但可以從上面幾的範例感受到，如果要針對method內某個變數的值去做改變的話，可用yield的方式將控制權讓出給寫在method外的block去做運算。</p>
<p>參考資料：<br><a href="https://www.codecademy.com/forum_questions/51c72e759c4e9d410501df42" target="_blank" rel="noopener">I don’t really understand what is this yield</a><br><a href="https://stackoverflow.com/questions/3066703/blocks-and-yields-in-ruby" target="_blank" rel="noopener">Blocks and yields in Ruby</a><br><a href="https://mixandgo.com/learn/mastering-ruby-blocks-in-less-than-5-minutes" target="_blank" rel="noopener">Mastering Ruby Blocks in Less Than 5 Minutes</a><br><a href="https://www.rubyguides.com/2016/02/ruby-procs-and-lambdas/" target="_blank" rel="noopener">The Ultimate Guide to Blocks, Procs &amp; Lambdas</a><br><a href="https://medium.com/rubycademy/the-yield-keyword-603a850b8921" target="_blank" rel="noopener">The yield Keyword in Ruby</a><br><a href="https://railsbook.tw/chapters/07-ruby-basic-3.html" target="_blank" rel="noopener">為自己學Ruby on Rails</a><br><a href="https://ithelp.ithome.com.tw/articles/10203982" target="_blank" rel="noopener">活用Ruby裡的yield</a></p>
<blockquote>
<p>“Most of the important things in the world have been accomplished by people who have kept on trying when there seemed to be no hope at all.”</p>
<p>– Dale Carnegie, Motivational Expert</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day4: Block程式碼區塊及Proc, Lambda差異</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%204/</url>
    <content><![CDATA[<p><a href="https://en.wikipedia.org/wiki/Block_(basketball)" target="_blank" rel="noopener">Block in Basketball</a><br><img src="https://i.imgur.com/rPG1IaY.png" alt=""></p>
<p>Ruby是一個「物件導向」相當徹底的一門程式語言，幾乎所有的東西都是物件，例如：</p>
<ul>
<li>數字 Integer</li>
<li>符號 Symbol</li>
<li>字串 String</li>
<li>陣列 Array</li>
<li>雜湊 Hash</li>
</ul>
<p>為什麼說”幾乎”呢？</p>
<h1 id="Block-程式碼區塊"><a href="#Block-程式碼區塊" class="headerlink" title="Block(程式碼區塊)"></a>Block(程式碼區塊)</h1><p>在寫各種迴圈的時候，會大量的運用到Block:</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">numbers = [<span class="number">1</span>,<span class="number">2</span>,<span class="number">3</span>,<span class="number">4</span>,<span class="number">5</span>]</span><br><span class="line"></span><br><span class="line">p numbers.map&#123;<span class="params">|num|</span> num * <span class="number">2</span>&#125;                <span class="comment">#印出[2,4,6,8,10]</span></span><br><span class="line">p numbers.select&#123;<span class="params">|num|</span> num.odd?&#125;            <span class="comment">#印出[1,3,5]</span></span><br><span class="line">p numbers.reduce(<span class="number">0</span>)&#123;<span class="params">|accu,num|</span> accu + num &#125; <span class="comment">#印出15</span></span><br><span class="line"><span class="number">5</span>.times &#123; puts <span class="string">"Hello"</span> &#125;                    <span class="comment">#印出5次Hello</span></span><br><span class="line"></span><br><span class="line">numbers.each <span class="keyword">do</span> <span class="params">|num|</span></span><br><span class="line">  num * <span class="number">2</span>                                   <span class="comment">#印出[2,4,6,8,10]</span></span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>在Ruby，{ … }及do end就是Block，且前面要接一個method。</p>
<h3 id="Block並不是物件，本身不能獨立存在。"><a href="#Block並不是物件，本身不能獨立存在。" class="headerlink" title="==Block並不是物件，本身不能獨立存在。=="></a>==Block並不是物件，本身不能獨立存在。==</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">puts &#123;<span class="string">"Hello, World!"</span>&#125;         <span class="comment">#會出現語法錯誤</span></span><br><span class="line">sentences = &#123;<span class="string">"Hello, World!"</span>&#125;  <span class="comment">#會出現語法錯誤</span></span><br></pre></td></tr></table></figure>

<h2 id="讓Block獨立存在的方法-Proc-Lamda"><a href="#讓Block獨立存在的方法-Proc-Lamda" class="headerlink" title="讓Block獨立存在的方法: Proc , Lamda"></a>讓Block獨立存在的方法: Proc , Lamda</h2><p>雖然Block不是物件，但Ruby有內建兩個方法可以使Block物件化。</p>
<h3 id="Proc"><a href="#Proc" class="headerlink" title="Proc"></a>Proc</h3><figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">ninjutsu = Proc.new &#123;puts <span class="string">'らせん(螺旋)がん(丸)'</span>&#125;</span><br><span class="line">ninjutsu.call        <span class="comment">#印出 らせん(螺旋)がん(丸)</span></span><br></pre></td></tr></table></figure>
<p>可以用<code>call</code>的方式呼叫，且可以帶參數</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#call方法呼叫</span></span><br><span class="line">calculator = Proc.new &#123;<span class="params">|num|</span> puts num * <span class="number">2</span>&#125;</span><br><span class="line">calculator.call(<span class="number">5</span>)   <span class="comment">#印出 10</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment">#call()方法且帶參數呼叫</span></span><br><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">sushi_plate</span><span class="params">(price)</span></span></span><br><span class="line">  <span class="keyword">return</span> Proc.new &#123;<span class="params">|num|</span> num * price&#125;</span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">nigili = sushi_plate(<span class="number">50</span>)  <span class="comment">#100</span></span><br><span class="line">avacado = sushi_plate(<span class="number">30</span>) <span class="comment">#150</span></span><br><span class="line"></span><br><span class="line">puts <span class="string">"Nigili is $<span class="subst">#&#123;nigili.call(<span class="number">2</span>)&#125;</span> and avacado is $<span class="subst">#&#123;avacado.call(<span class="number">5</span>)&#125;</span>."</span></span><br><span class="line"><span class="comment">#印出Nigili is $100 and avacado is $150.</span></span><br></pre></td></tr></table></figure>

<p>==注意!!!==</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">Proc.new &#123; <span class="keyword">return</span> ... &#125;</span><br></pre></td></tr></table></figure>
<p>return請不要寫在Proc的Block裡，否則程式碼執行到這段後就會停止(return完後立即停止)，不會繼續往下走。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proc_airline</span></span></span><br><span class="line">  p <span class="string">"strat from TPE"</span></span><br><span class="line">    airline_proc = Proc.new &#123; <span class="keyword">return</span> <span class="string">"Eva airline"</span> &#125;</span><br><span class="line">    airline_proc.call</span><br><span class="line">  p <span class="string">"has arrived NRT"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line">  p proc_airline</span><br><span class="line">    <span class="comment">#印出"strat from TPE"</span></span><br><span class="line">    <span class="comment">#   "Eva airline"</span></span><br><span class="line"></span><br><span class="line">    <span class="comment">#"has arrived NRT"不會印出，因為在第3行就停止了。</span></span><br></pre></td></tr></table></figure>
<h3 id="Lambda"><a href="#Lambda" class="headerlink" title="Lambda"></a>Lambda</h3><p>有點類似匿名函式</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="comment">#方式一：</span></span><br><span class="line">calculator = lambda &#123;<span class="params">|num|</span> puts num * <span class="number">2</span>&#125;</span><br><span class="line">calculator.call(<span class="number">5</span>) <span class="comment">#印出 10</span></span><br><span class="line"></span><br><span class="line"><span class="comment">#方式二：</span></span><br><span class="line">calculator = -&gt; (n) &#123;puts n * <span class="number">2</span>&#125;</span><br><span class="line">calculator.call(<span class="number">5</span>) <span class="comment">#印出 10</span></span><br></pre></td></tr></table></figure>


<h2 id="Proc與Lambda的差異"><a href="#Proc與Lambda的差異" class="headerlink" title="Proc與Lambda的差異"></a>Proc與Lambda的差異</h2><p>這樣比較起來，兩個東西看起來真的非常相似，但他們之間還是有一點點的差異存在，我們來看以下例子：</p>
<h3 id="差異1"><a href="#差異1" class="headerlink" title="差異1."></a>差異1.</h3><p><strong>若block預期有參數要帶入，Lambda的call不給參數會出現錯誤，Proc的call則不會出錯而是會回傳<code>nil</code></strong></p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">lambda = -&gt; (name) &#123; puts <span class="string">"Hello <span class="subst">#&#123;name&#125;</span>"</span> &#125;</span><br><span class="line">lambda.call(<span class="string">"Ruby"</span>)  <span class="comment">#印出 Hello Ruby</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">proc = Proc.new &#123; <span class="params">|name|</span> puts <span class="string">"Hello <span class="subst">#&#123;name&#125;</span>"</span> &#125;</span><br><span class="line">proc.call(<span class="string">"Ruby"</span>)    <span class="comment">#印出 Hello Ruby</span></span><br></pre></td></tr></table></figure>
<p>目前看起來都很正常，但再看下面：</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">lambda.call()</span><br><span class="line"><span class="comment">#出現error:wrong number of arguments (given 0, expected 1) (ArgumentError)</span></span><br><span class="line"></span><br><span class="line">proc.call()     <span class="comment">#印出 Hello</span></span><br></pre></td></tr></table></figure>

<p>Lambda函式若有預期要傳入參數但call卻沒有給的話，會直接跳出錯誤訊息，Proc後的call雖然也沒有給參數，程式還是可以過的，因為Proc會自動給<code>nil</code></p>
<h3 id="差異2"><a href="#差異2" class="headerlink" title="差異2."></a>差異2.</h3><p>Proc的block裡若有return，會直接終止程式不繼續往下走，Lambda則不影響，會完整跑完程式。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">proc_pikachu</span></span></span><br><span class="line">  proc = Proc.new &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  proc.call</span><br><span class="line">  p <span class="string">"使用鋼鐵尾巴！！"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">proc_pikachu     <span class="comment"># 印不出 "使用鋼鐵尾巴！！"</span></span><br></pre></td></tr></table></figure>

<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">lambda_pikachu</span></span></span><br><span class="line">  lam = -&gt; &#123; <span class="keyword">return</span> &#125;</span><br><span class="line">  lam.call</span><br><span class="line">  p <span class="string">"使用鋼鐵尾巴！！"</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">lambda_pikachu   <span class="comment"># 印出"使用鋼鐵尾巴！！"</span></span><br></pre></td></tr></table></figure>
<blockquote>
<p>The difference between procs and lambdas is how they react to a return statement. A lambda will return normally, like a regular method. But a proc will try to return from the current context.The reason is that you can’t return from the top-level context.</p>
<p>from <a href="https://www.rubyguides.com/2016/02/ruby-procs-and-lambdas/" target="_blank" rel="noopener">rubyguides</a></p>
</blockquote>
<h3 id="簡單總結一下："><a href="#簡單總結一下：" class="headerlink" title="簡單總結一下："></a>簡單總結一下：</h3><p><strong>Block</strong>不是物件，不能獨立存在。</p>
<p><strong>Proc</strong>可帶參數，要求有參數，call卻沒給參數時會回傳<code>nil</code>，{return…}會跳出程式。</p>
<p><strong>Lambda</strong>使用起來更像我們一般使用的method，且會嚴格要求參數數目，就算{return…}也會把程式跑完。</p>
<p>參考資料：<br><a href="https://www.rubyguides.com/2016/02/ruby-procs-and-lambdas/" target="_blank" rel="noopener">rubyguides</a><br><a href="https://medium.com/rubycademy/modules-in-ruby-part-ii-41466945e810" target="_blank" rel="noopener">Modules in Ruby: Part II</a><br><a href="https://culttt.com/2015/05/13/what-are-lambdas-in-ruby/" target="_blank" rel="noopener">What are Lambdas in Ruby?</a><br><a href="https://www.honeybadger.io/blog/using-lambdas-in-ruby/" target="_blank" rel="noopener">Using Lambdas in Ruby</a><br><a href="https://railsbook.tw/chapters/07-ruby-basic-3.html" target="_blank" rel="noopener">為你自己學Ruby on Rails</a></p>
<blockquote>
<p>“Perseverance is not a long race; it is many short races one after another.”</p>
<p>– Walter Elliott, Clergyman</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day 3: Ruby世界中的符號(Symbol)是什麼？與字串(String)有什麼差異？</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%203/</url>
    <content><![CDATA[<p>我在剛接觸符號(Symbol)這個名詞的時候，心裡想的是：<br><img src="https://i.imgur.com/aT4BBK6.png" alt=""></p>
<p><img src="https://i.imgur.com/PnKIdW5.png" alt=""></p>
<p>覺得哇～原來寫程式也可以玩<a href="https://zh.wikipedia.org/wiki/%E7%B9%AA%E6%96%87%E5%AD%97" target="_blank" rel="noopener">emoji</a>(被打..)</p>
<p>現在想起來還真的是蠢到不行，我想就算是新手也沒像我這麼單(愚)純(蠢)吧XD</p>
<h1 id="符號-Symbol"><a href="#符號-Symbol" class="headerlink" title="符號(Symbol)"></a>符號(Symbol)</h1><p>在Rails專案裡，我們常常看到冒號加上英文字母的用法，例如<code>:name</code>,<code>age</code>,<code>party</code>,<code>policy</code></p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">clean_params</span></span></span><br><span class="line">    params.<span class="keyword">require</span>(<span class="symbol">:candidate</span>).permit(<span class="symbol">:name</span>, <span class="symbol">:age</span>, <span class="symbol">:party</span>, <span class="symbol">:policy</span>)</span><br><span class="line"><span class="keyword">end</span></span><br></pre></td></tr></table></figure>
<p>或是Hash</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">student = &#123;<span class="symbol">:name</span> =&gt; <span class="string">'Louis'</span>, <span class="symbol">:age</span> =&gt;<span class="string">'18'</span>&#125;</span><br></pre></td></tr></table></figure>
<p>冒號的後面其實也非必要加英文，你要變成<code>:やさしい</code>,<code>:帥哥</code>,<code>:123</code>也是會過的，只是在使用上很不方便且很少見，建議還是用英文字母就好。</p>
<p>其實符號(Symbol)與變數(variable)的命名很像，只是符號前面有加冒號的差別而已。</p>
<h3 id="有些人會認為，阿這東西不就記下來就好？幹嘛還要特別開一篇來寫？"><a href="#有些人會認為，阿這東西不就記下來就好？幹嘛還要特別開一篇來寫？" class="headerlink" title="有些人會認為，阿這東西不就記下來就好？幹嘛還要特別開一篇來寫？"></a>有些人會認為，阿這東西不就記下來就好？幹嘛還要特別開一篇來寫？</h3><p>符號在Ruby裡是很重要的存在，它並不只是像變數命名一樣，只是個’名字’的存在。可以想像成符號就是「有名字的物件」且「無法變更的字串(String)」。</p>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line">x = <span class="number">1</span>      <span class="comment">#數字物件</span></span><br><span class="line"></span><br><span class="line">x = <span class="string">'good'</span> <span class="comment">#字串物件</span></span><br><span class="line"></span><br><span class="line">x = <span class="symbol">:good</span>  <span class="comment">#符號物件</span></span><br></pre></td></tr></table></figure>
<h1 id="字串-String-與符號-Symbol-有什麼不同？"><a href="#字串-String-與符號-Symbol-有什麼不同？" class="headerlink" title="字串(String)與符號(Symbol)有什麼不同？"></a>字串(String)與符號(Symbol)有什麼不同？</h1><h3 id="字串的內容可以被修正，但符號不行。"><a href="#字串的內容可以被修正，但符號不行。" class="headerlink" title="==字串的內容可以被修正，但符號不行。=="></a>==字串的內容可以被修正，但符號不行。==</h3><p>開啟irb來看一下：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 改變字串</span><br><span class="line"></span><br><span class="line">2.6.3 :016 &gt; a = &apos;hello&apos;</span><br><span class="line"> =&gt; &quot;hello&quot;</span><br><span class="line">2.6.3 :017 &gt; a[0]</span><br><span class="line"> =&gt; &quot;h&quot;</span><br><span class="line">2.6.3 :018 &gt; b = :hello</span><br><span class="line"> =&gt; :hello</span><br><span class="line">2.6.3 :019 &gt; b[0]</span><br><span class="line"> =&gt; &quot;h&quot;</span><br><span class="line">2.6.3 :020 &gt; a[0] = &apos;f&apos;</span><br><span class="line"> =&gt; &quot;f&quot;</span><br><span class="line">2.6.3 :021 &gt; a</span><br><span class="line"> =&gt; &quot;fello&quot;         #字串的第一個字母&apos;h&apos;改成&apos;f&apos;</span><br><span class="line">2.6.3 :022 &gt;</span><br></pre></td></tr></table></figure>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 改變符號，出現error</span><br><span class="line"></span><br><span class="line">2.6.3 :022 &gt; b = :hello</span><br><span class="line"> =&gt; :hello</span><br><span class="line">2.6.3 :023 &gt; b[0]</span><br><span class="line"> =&gt; &quot;h&quot;</span><br><span class="line">2.6.3 :024 &gt; b[0] = &apos;f&apos;</span><br><span class="line"></span><br><span class="line">NoMethodError (undefined method `[]=&apos; for :hello:Symbol)</span><br></pre></td></tr></table></figure>


<h3 id="Symbol的效能比字串好"><a href="#Symbol的效能比字串好" class="headerlink" title="Symbol的效能比字串好"></a>Symbol的效能比字串好</h3><p>記憶體的存取方式也不同：</p>
<figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 符號(Symbol)每次印出 :name 時，具有唯一性，佔用記憶體位址相同。</span><br><span class="line">2.6.3 :012 &gt; :name.object_id</span><br><span class="line"> =&gt; 88028</span><br><span class="line">2.6.3 :013 &gt; :name.object_id</span><br><span class="line"> =&gt; 88028</span><br><span class="line"></span><br><span class="line"># 字串(String)每次印出&quot;name&quot;時，他的object_id都會不同，佔用的記憶體位址也不同。</span><br><span class="line">2.6.3 :014 &gt; &apos;name&apos;.object_id</span><br><span class="line"> =&gt; 70183486959360</span><br><span class="line">2.6.3 :015 &gt; &apos;name&apos;.object_id</span><br><span class="line"> =&gt; 70183486974200</span><br></pre></td></tr></table></figure>
<p>每個Symbol產生時，在Ruby裡就會產生一個獨立的object_id，直到程式結束為止，而字串在每次產生的時候，都會產生一個新的object_id，這也是為何「字串的內容可以被修正，但符號不行。」的原因。</p>
<p>也因為每次取用一次String，就得產生一個新的object_id，很佔用記憶體空間，Symbol則是直接取用一開始建立的object_id，所以字串的效能稍微差一點。</p>
<h2 id="String可以轉成Symbol，Symbol也可以轉成String"><a href="#String可以轉成Symbol，Symbol也可以轉成String" class="headerlink" title="String可以轉成Symbol，Symbol也可以轉成String"></a>String可以轉成Symbol，Symbol也可以轉成String</h2><figure class="highlight plain"><table><tr><td class="code"><pre><span class="line"># 字串轉成 Symbol</span><br><span class="line">2.6.3 :025 &gt; &apos;name&apos;.to_sym</span><br><span class="line"> =&gt; :name</span><br><span class="line"></span><br><span class="line"># Symbol 轉成字串</span><br><span class="line">2.6.3 :026 &gt; :name.to_s</span><br><span class="line"> =&gt; &quot;name&quot;</span><br></pre></td></tr></table></figure>


<p>參考資料：<br><a href="https://pjchender.github.io/" target="_blank" rel="noopener">PJChen的私房菜</a><br><a href="https://kaochenlong.com/" target="_blank" rel="noopener">Ruby語法放大鏡</a></p>
<blockquote>
<p>“When there’s that moment of ‘Wow, I’m not really sure I can do this,’ and you push through those moments, that’s when you have a breakthrough.”</p>
<p>— Marissa Mayer, CEO of Yahoo</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>Day 2: 變數(variable)與常數(Constant)</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%202/</url>
    <content><![CDATA[<p>從開班到現在學了兩個月，只知道這兩個東西每天都在用，但要直接解釋出”變數”與”常數”是什麼？還是得稍微轉一下才能夠說明，所以就特別針對這個主題來寫一下吧！</p>
<h2 id="什麼是變數-variable-？"><a href="#什麼是變數-variable-？" class="headerlink" title="什麼是變數(variable)？"></a>什麼是變數(variable)？</h2><p>變數在數學上的定義，被用來表示值的一個’符號’(此指數學符號)，且這個值可以是指定的或是未被指定的。</p>
<p>但程式中的變數呢？</p>
<h4 id="變數：類似代名詞，有點像幫某個東西命名，其實就像標籤。這樣講可能很抽象，但可以試著這樣理解"><a href="#變數：類似代名詞，有點像幫某個東西命名，其實就像標籤。這樣講可能很抽象，但可以試著這樣理解" class="headerlink" title="變數：類似代名詞，有點像幫某個東西命名，其實就像標籤。這樣講可能很抽象，但可以試著這樣理解:"></a>變數：類似代名詞，有點像<strong>幫</strong>某個東西命名，其實就像標籤。這樣講可能很抽象，但可以試著這樣理解:</h4><p>一個籃子裡面裝了一個值是2(指定)，再給籃子一個標籤(變數)命名叫做X, X = 2</p>
<p>當然這個值我們要放什麼型態的資料都可以，這裡只是舉例給它個Integer型態，下篇會來解釋Ruby的型態有哪些。</p>
<p><img src="https://i.imgur.com/YaSjaYg.png" alt=""><br>圖片來源：<a href="https://www.complexsql.com/" target="_blank" rel="noopener">https://www.complexsql.com/</a></p>
<h3 id="變數的種類"><a href="#變數的種類" class="headerlink" title="變數的種類"></a>變數的種類</h3><ul>
<li>區域變數（local Variable)：定義在方法(method)裡面的變數，只能在method裡使用。<br>預設值：沒有<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="function"><span class="keyword">def</span> <span class="title">test</span></span></span><br><span class="line"> x = <span class="number">2</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">p x <span class="comment">#印出2</span></span><br></pre></td></tr></table></figure></li>
<li>實體變數（instance variable):<br>預設值：nil<br>在類別(class)裡通常會有不只一個method，但一般的變數只能在自己的method中取用，故使用實體變數，讓class裡的每個method都可以取用這個變數，且變數的值(value)會根據不同的method儲存不同的value。<ul>
<li>另外，實體變數要在class中互相取值前有個先決條件：必須將物件實體化(initialize)之後才能互相使用。</li>
</ul>
</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Cat</span></span></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">initialize</span><span class="params">(item)</span></span>   <span class="comment">#類似’創角色(item)‘的概念</span></span><br><span class="line">    @item = item</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">calculate</span>          <span class="comment">#實體方法</span></span></span><br><span class="line">    @item * <span class="number">2</span>            <span class="comment">#取用實體變數前面要加'@'</span></span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">kitty = Cat.new(<span class="number">2</span>)</span><br><span class="line">p kitty.calculate        <span class="comment">#印出4</span></span><br></pre></td></tr></table></figure>

<ul>
<li>類別變數（class variable）:<br>預設值：沒有<br>可以在同一個類別(class)或子類別中共用的變數，所以翻譯成白話文，“實體變數”只能遊走在自己class中的method，而“類別變數”除了可以遊走自己的class之外，還可以去其他的子類別被使用。</li>
</ul>
<figure class="highlight ruby"><table><tr><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">Language</span></span></span><br><span class="line">  @@name = <span class="string">'english'</span> <span class="comment">#類別變數前面要加'@@'</span></span><br><span class="line"></span><br><span class="line">  <span class="function"><span class="keyword">def</span> <span class="title">self</span>.<span class="title">speak</span>     <span class="comment">#要做用在類別上，所以要用類別方法</span></span></span><br><span class="line">    puts @@name</span><br><span class="line">  <span class="keyword">end</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">end</span></span><br><span class="line"></span><br><span class="line">Language.speak       <span class="comment">#印出english</span></span><br></pre></td></tr></table></figure>

<ul>
<li>全域變數（global variable）：<br>預設值：nil<br>全域變數以$開頭，可以從程式裡的任何地方開始。也因為可以寫在任何地方的特性，故在使用的時候也相對危險。</li>
</ul>
<h2 id="什麼是常數-Constant"><a href="#什麼是常數-Constant" class="headerlink" title="什麼是常數(Constant)?"></a>什麼是常數(Constant)?</h2><p>一張有寫著名字的標籤，貼在某個東西上面。其中常數本身不帶任何型態，且最重要的一點，在Ruby裡面的常數，第一個英文字母要<strong>大寫</strong>，這也是為何我在標故意把variable跟Constant的第一個字母做大小寫區別的原因。</p>
<p>另外，常數是可以被修改的</p>
<p><img src="https://i.imgur.com/Uj5nH71.png" alt=""></p>
<blockquote>
<p>“The secret of success is constancy to purpose.”</p>
<p>– Benjamin Disraeli, British Prime Minister</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>鐵人賽Day 1: 參賽起始文</title>
    <url>/LouiswuYJ.github.io/2019/%E9%90%B5%E4%BA%BA%E8%B3%BDDay%201/</url>
    <content><![CDATA[<p>其實自認自己是個對文字有恐懼的人，更別說是寫文章了。算是給自己的一次挑戰，並養成將學到的新知識轉換成文字的習慣，除了能幫助自己回頭看學習的歷程當筆記用外，也許也能夠幫助一些人吧（應該吧？</p>
<h2 id="參賽動-衝-機-動"><a href="#參賽動-衝-機-動" class="headerlink" title="參賽動(衝)機(動)"></a>參賽動(衝)機(動)</h2><p>「沒時間啦….我光每天吸收新知識、複習課程內容都應付不來了，還要開始run專案，而且$%#$<em>#)$</em>@…」<br>「寫文章又沒人看，搞不好還給別人見笑咧～」<br>「如果志在參加隨便發文，我不就只是花了30天發了30篇廢文嗎？」<br>「但我只是小嫩嫩阿…寫出來的東西真的能看嗎？」</p>
<p>以上這些都是我報名前的心聲，我想一定有很多人都有跟我一樣的想法，但為何我還是會報名？</p>
<blockquote>
<p>「時間就像擠乳溝，硬擠一下就有了。」</p>
</blockquote>
<p>沒有時間，其實只是給自己偷懶的藉口，當我意識到這件事的時候，身邊的同學各個都已經報名，他們也不是都有時間的人，沒有多想，反正衝就對了。身為新手而且又是報名自我挑戰組，就算失敗了又如何？反正寫了又不見得有人會看，又不是偶像，哪來偶包？</p>
<h2 id="主題發想"><a href="#主題發想" class="headerlink" title="主題發想"></a>主題發想</h2><p>就新手而言，要我寫個「從0到30天學會RoR」，我想寫出來的應該只會是幹話吧XD<br>與其說要想個主題出來，我倒認為不如把我在轉職過程中學到的觀念，把自己相對不熟悉的部分分享出來，也許中間的順序跟過程或沒有連貫，但我就當作是給自己看的東西，隨我發想就好(誤)</p>
<p>既然現在自己比較偏重用RoR寫後端，且也對這部分比較感興趣，那就以它為當為主題吧！</p>
<h2 id="寫文內容"><a href="#寫文內容" class="headerlink" title="寫文內容"></a>寫文內容</h2><p>預計記錄從初學Ruby到應用在Rails中學習到的觀念，以及可能會被問到的面試問題去撰寫。覺得要完成挑戰，實在很需要雞湯文，所以我想在每篇文章的結尾加上一句雞湯句(或幹話？)，以鼓勵自己繼續堅持下去。</p>
<hr>
<p>如果未來寫的文章或是觀念有出入的話，也請各位大大不吝指教了。</p>
<blockquote>
<p>Most of the important things in the world have been accomplished by people who have kept on trying when there seemed to be no hope at all.</p>
<p>– Dale Carnegie</p>
</blockquote>
]]></content>
      <categories>
        <category>Ruby on Rails</category>
      </categories>
      <tags>
        <tag>鐵人賽</tag>
        <tag>Ruby on Rails</tag>
      </tags>
  </entry>
  <entry>
    <title>5xRuby：滿一個月</title>
    <url>/LouiswuYJ.github.io/2019/5xRuby%EF%BC%9A%E6%BB%BF%E4%B8%80%E5%80%8B%E6%9C%88/</url>
    <content><![CDATA[<h1 id="啟程"><a href="#啟程" class="headerlink" title="啟程"></a>啟程</h1><p>還記得07/15開課當天，早上還在東京趕飛機的我，匆匆忙忙在下課前一小時衝進教室，滿頭大汗地隨便抓個位置坐在教室裡，根本不敢相信自己真的正式準備踏入這圈子了，心情既興奮又擔心，但既然都已經下定決心要挑戰，不管最後的結果如何，自己的選擇，就要對自己負責，不畏挫折踏實努力的走完這三個月的精實訓練，看看自己的最大能耐會走到多遠吧！</p>
<h1 id="過程"><a href="#過程" class="headerlink" title="過程"></a>過程</h1><blockquote>
<p>第一週：</p>
</blockquote>
<p>還記得第一週龍哥教的Ruby，以及Amos教的html，除了一開始的Git有遇到一些挫折，其他的部分還算得心應手，畢竟之前算有在AC線上課程自學一個月….</p>
<p>ＢＵＴ！！！</p>
<p>人生就是會有個BUT，沒想到前一個月的自學量，在短短一週的資訊量就被超過的連車尾燈都看不到，果不其然是名副其實的精實營，且作業方面就讓我深刻的體會到，身為工程師的日常生活就是在不停的挫折、不停的戰鬥中，獲得成就感。</p>
<blockquote>
<p>第二週：</p>
</blockquote>
<p>CSS及Ruby的雙重轟炸，我目前最大的挫折大概就是死在這週。CSS選取器選半天選不到、float用半天排不好版，Ruby的實體方法、類別方法的觀念理解、Class繼承等等等….在這週的作業，完全被打的體無完膚，一個Ruby題目像題目像下圖：</p>
<p><img src="https://i.imgur.com/5MxyR5q.png" alt=""></p>
<p>我就跟他耗了將近三小時！！！而且還沒寫出結果，再看CSS題目：</p>
<p><img src="https://i.imgur.com/0RahpPm.png" alt=""></p>
<p>花費時間也超過3小時，現在回頭看當時的自己，真的是很嫩呢XD</p>
<p><img src="https://i.imgur.com/H6R8J1D.jpg" alt=""><br><img src="https://i.imgur.com/TNqKya1.jpg" alt=""></p>
<p>還好有了老爸Matz桑的信心喊話，以前當晚在Pic Collage參加的Ruby Conf-pre party，與來自台灣及各國的大神聊天後，對自己稍微又有了點動力繼續走下去。最後終於憑著強大的心臟(其實是無知!?)到處撞牆，就這樣讓我撞到了第三週。</p>
<blockquote>
<p>第三週</p>
</blockquote>
<p>這週的CSS終於學了display:inline-block的方式切版，終於可以站拋棄float了(撒花)，以及絕對定位、相對定位等，這些雖然是個好用的工具，但其背後的真的很吃觀念，還好老師非常重視“觀念推導”而非只是教我們死記。但寫作業的部分就…才知道上課聽得懂，跟實際拿來用完全是兩馬子事啊…</p>
<p><a href="https://codepen.io/LouisYJ/pen/jONqzmd" target="_blank" rel="noopener">https://codepen.io/LouisYJ/pen/jONqzmd</a></p>
<p>這份作業就花了我近18小時的時間，真的切到很崩潰…花那麼多時間主要是因為第一次是純用float切版，後強迫自己用inline-block再切一次，確認觀念及工具是否真的都會用了。<br>雖然切的很崩潰，但算是第一次寫到有成就的moment。</p>
<p>但……</p>
<p>這週的Ruby又讓我崩潰了……Module、Block、namespace、rake等等等，又一堆的新觀念要導入，作業上再度花了近10小時才產出。而且龍哥從這次的作業繳交方式，從原本只要錄影自己打code的過程就好，還要再加上自己的聲音，一邊寫code一邊講解。</p>
<p>剛開始其實還蠻排斥這種方式，但後來其實很感謝當時的自己還是花時間嘗試去做“講解”這件事，畢竟如果我能夠邊coding邊說明，代表我真的懂觀念且已經可以融會貫通了(吧)。花了很多時間寫作業，但也慢慢找到自己的節奏及成就感。</p>
<blockquote>
<p>第四週</p>
</blockquote>
<p>很快的來到了Amos課的最後一週，終於把大絕招flex交給我們了XD，用起來真的是非常舒服，但只維持了一天的成就感，隔天立馬被RWD打死….</p>
<p>天哪！！！原來我們切版還要顧慮到不同裝置(手機、平板、電腦)的尺寸(直看、橫看)去客制那個裝置的版，我一直以爲那是電腦自動調整的(超天真)…Amos從最傳統的尺寸計算(大崩潰)，到用calc計算(中崩潰)，到最後的用隔線系統(小崩潰)，看都看得懂，實際應用又是另一回事。</p>
<p>為了能夠讓我們熟悉業界常用的方式，Amos一次出了14個切版作業，一直到現在我都還沒寫完，只能維持一日切一版的節奏慢慢前進，但確實在不斷不斷的練習之下，有發現自己的經驗值似乎在不知不覺中已慢慢提升，切版的速度越來越快且選取器及命名也越來越清楚，過程中有挫折，但似乎也漸漸習慣了。</p>
<p>最後一堂的Boostrap，原來有那麼好用的東西!!!!!有點我們之前到底在學什麼的感覺XD，但樣板是樣板，未來的客戶需求不可能都靠樣板去套就解決，故還是要有一定的手刻切版基礎，才能將樣板跟手刻版做好平衡。</p>
<p>Ruby不知道是開竅了還是靈感乍現!?這兩次近30題的作業，不能說是寫得得心應手，但挫折感明顯比前幾週少非常多，且速度也快多了，雖然常常被龍哥說：</p>
<blockquote>
<p>”在Ruby裡還有更簡單的方法“</p>
</blockquote>
<p>但至少我寫出結果來了(誤)</p>
<p>有時候其實會懷疑，過度依賴Ruby的method是不是件好事？所以在每次寫完作業後，有時間我會刻意讓自己去用土炮的方式完成作業，多訓練自己的邏輯思維，讓自己未來若跨到其他語言系，不會因為沒有method可用就躺平在那吃土(笑)<br>(這週五颱風假賺到一天自習，可能這也是壓力比較可以調適的原因!?)</p>
<h1 id="結語"><a href="#結語" class="headerlink" title="結語"></a>結語</h1><p>第一天的自己，經過了這一個月的訓練，明顯感覺得到自己的進步，但其實不能夠因此自滿，班上的強者實在太多了，既然怎麼追都追不上，那就跟自己比較吧～</p>
<p>心態調適真的很重要，未來進這行一定是在無盡的挫折跟成就感間不停徘徊，還好在自己心裡層面很低潮的時候，身邊總是有人願意拉我一把告訴我要堅持下去，我算是幸福的吧！</p>
<p>我不知道後面兩個月過後，是否能夠順利的轉職成功，但至少能夠確認的是：</p>
<h1 id="”我覺得寫程式還蠻有趣的。“"><a href="#”我覺得寫程式還蠻有趣的。“" class="headerlink" title="”我覺得寫程式還蠻有趣的。“"></a>”我覺得寫程式還蠻有趣的。“</h1>]]></content>
      <categories>
        <category>心得相關</category>
      </categories>
      <tags>
        <tag>上課心得</tag>
      </tags>
  </entry>
  <entry>
    <title>寫javascript-資料結構初體驗</title>
    <url>/LouiswuYJ.github.io/2019/%E5%AF%ABjavascript-%E8%B3%87%E6%96%99%E7%B5%90%E6%A7%8B%E5%88%9D%E9%AB%94%E9%A9%97%20copy/</url>
    <content><![CDATA[<p>五倍的課程進行將近一個月，終於有了第一次有小組討論XD<br>從來沒接觸過資料結構的我們，從老師訂的題目”購物車“開始發想：</p>
<h2 id="我們討論經過的步驟："><a href="#我們討論經過的步驟：" class="headerlink" title="我們討論經過的步驟："></a>我們討論經過的步驟：</h2><p>1.列出所有購物車會有的功能<br>2.將同種類的進行分類<br>3.將重複的功能刪除<br>4.列出進入購物車選單後的順序流程<br>5.不會變動的功能與會變動的功能進行分類<br>6.會有value的用Objuect，不用特別輸入value的用Array<br>7.寫成code</p>
<h2 id="所以產出了以下基本結果："><a href="#所以產出了以下基本結果：" class="headerlink" title="所以產出了以下基本結果："></a>所以產出了以下基本結果：</h2><p>購物車：<br>{帳號、密碼}<br>購物車 {商品名稱、金額、特價、數量、尺寸、顏色、折扣{購物金、活動優惠、紅利折抵}、總件數<br>推薦商品、瀏覽紀錄}<br>待買清單<br>追蹤清單<br>商城規範<br>會員資料 {姓名、信箱、電話、地址、會員等級}<br>配送方式 {超商: 運費、宅配: 運費、郵局: 運費、面交: 免運費}<br>付款方式 [ATM、信用卡、貨到付款、第三方支付]<br>發票載具 [二聯、三聯、捐贈、電子發票]<br>訂單編號<br>(123代表型態是number, 0.7代表型態是float)</p>
<h2 id="寫成code後產出以下結果："><a href="#寫成code後產出以下結果：" class="headerlink" title="寫成code後產出以下結果："></a>寫成code後產出以下結果：</h2><p><img src="https://i.imgur.com/uW38JGf.png" alt=""></p>
<h2 id="泰安老師的評語："><a href="#泰安老師的評語：" class="headerlink" title="泰安老師的評語："></a>泰安老師的評語：</h2><p>1.第3行，問題零：<br>Ans: 最外面已經let card了，裡面的key要避免使用同樣名稱的命名。<br>2.第4行～第12行，問題一：<br>問：item這裡只有一個，如果今天有多個item的話，這樣子的資料結構可以寫在哪裡呢？<br>(我在台上空氣凝結…)<br>Ans: 這種寫法基本上可說是設計錯誤，應該會如下圖寫，用Array包住Object才能夠在資料上儲存多筆item。</p>
<p><img src="https://i.imgur.com/CDDuftF.png" alt=""></p>
<p>3.第13行，問題二：<br>問：那個總金額是…?直接輸入字串？<br>Ans:關於要做運算的事情，不需要寫在資料結構裡面，只要再外面用function運算完後再輸入回去就好。</p>
<p><img src="https://i.imgur.com/7C4eIMK.png" alt=""></p>
<p>4.第16行~第17行，問題三：<br>問：商品名稱跟瀏覽紀錄..?一個字串？<br>Ans:同問題一，應有多筆資料的儲存應用Array包住Object。</p>
<p><img src="https://i.imgur.com/KY2qGTe.png" alt=""></p>
<p>5.第20行～第21行，第22行～第27行，問題四：<br>Ans:同問題一，應有多筆資料的儲存應用Array包住Object。</p>
<p><img src="https://i.imgur.com/zVaMpEG.png" alt=""></p>
<p>補充：在item的部分，其實並不是你在Array裡寫幾個Object，就只能在購物車裡放幾個不同item，而是一開始的資料其實是個空陣列，當使用者按下”加入購物車”後，才會傳入一個資料進入Array。</p>
<h1 id="結論："><a href="#結論：" class="headerlink" title="結論："></a>結論：</h1><p>1.若是同樣的東西，卻需要有多筆的時候，使用Array包住裡面的資料。<br>2.若只有單筆需要帶入key跟value的時候，使用Object。(第２９行)<br>3.避免key的命名與外部的變數名稱相同。<br>當然就算這樣設定，這樣的資料結構其實也還算是有問題的，但藉由此例大概可以對第一次寫資料結構的我們，有了一些些感受跟體驗。</p>
]]></content>
      <categories>
        <category>javascript</category>
      </categories>
      <tags>
        <tag>javascript</tag>
      </tags>
  </entry>
</search>
